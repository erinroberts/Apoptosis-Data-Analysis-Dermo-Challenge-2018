---
title: "DAY7_DERMO_CHALLENGE_FLOW_ANALYSIS"
author: "Erin Roberts"
date: "7/27/2018"
output:
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load Packages

```{r packages, echo=FALSE}
library(ggplot2)
library(metafor)
library(dplyr)
library(car)
library(lsmeans)
library(rgr)
```

# VIABILITY ASSAY ANALYSIS 

## Load in data for each plot

```{r load, echo=TRUE}
#Load in the Data for each plot on a separate spreadsheet

VI_PLOT2_hemocytes <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT2.csv", header=TRUE)
VI_PLOT3_P1_GATE <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT3.csv", header=TRUE)
VI_PLOT4_E1_E3_GATE <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT4.csv", header=TRUE)
VI_PLOT5_P1_MINUS_V1R <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT5.csv", header=TRUE)
VI_PLOT9_E1_MINUS_V1R <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT9.csv", header=TRUE)
VI_PLOT10_E3_MINUS_V1R <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT10.csv", header=TRUE)
VI_PLOT12_P1_PerCP <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT12.csv", header=TRUE)
VI_PLOT4_restructured <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT4_RESTRUCTURED.csv", header=TRUE)

# Remove rows with na's with the remove.na function from rgr
VI_PLOT2_hemocytes <- na.omit(VI_PLOT2_hemocytes)
VI_PLOT3_P1_GATE <- na.omit(VI_PLOT3_P1_GATE)
VI_PLOT4_E1_E3_GATE <- na.omit(VI_PLOT4_E1_E3_GATE)
VI_PLOT5_P1_MINUS_V1R <- na.omit(VI_PLOT5_P1_MINUS_V1R)
VI_PLOT9_E1_MINUS_V1R <- na.omit(VI_PLOT9_E1_MINUS_V1R)
VI_PLOT10_E3_MINUS_V1R <- na.omit(VI_PLOT10_E3_MINUS_V1R)
VI_PLOT12_P1_PerCP <- na.omit(VI_PLOT12_P1_PerCP)
VI_PLOT4_restructured <- na.omit(VI_PLOT4_restructured)

## Remove percent symbol from columns 
VI_PLOT2_hemocytes$M4_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT2_hemocytes$M4_PERCENT_OF_THIS_PLOT))
VI_PLOT3_P1_GATE$P1_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT3_P1_GATE$P1_PERCENT_OF_THIS_PLOT))
VI_PLOT4_E1_E3_GATE$E1_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT4_E1_E3_GATE$E1_PERCENT_OF_THIS_PLOT))
VI_PLOT4_E1_E3_GATE$E3_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT4_E1_E3_GATE$E3_PERCENT_OF_THIS_PLOT))
VI_PLOT12_P1_PerCP$V1_L_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT12_P1_PerCP$V1_L_PERCENT_OF_THIS_PLOT))
VI_PLOT12_P1_PerCP$V1_R_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT12_P1_PerCP$V1_R_PERCENT_OF_THIS_PLOT))
VI_PLOT4_restructured$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT4_restructured$PERCENT_OF_THIS_PLOT))

# Load in Data for the samples to remove 
Viability_Samples_Remove <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/VIABILITY_SAMPLES_REMOVE.csv", header=TRUE)

# Data Frame with bad samples removed
VI_PLOT2_hemocytes_BAD_REMOVED <- VI_PLOT2_hemocytes[!VI_PLOT2_hemocytes$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT3_P1_GATE_BAD_REMOVED <- VI_PLOT3_P1_GATE[!VI_PLOT3_P1_GATE$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT4_E1_E3_GATE_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE[!VI_PLOT4_E1_E3_GATE$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT5_P1_MINUS_V1R_BAD_REMOVED <- VI_PLOT5_P1_MINUS_V1R[!VI_PLOT5_P1_MINUS_V1R$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R[!VI_PLOT9_E1_MINUS_V1R$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R[!VI_PLOT10_E3_MINUS_V1R$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT12_P1_PerCP_BAD_REMOVED <- VI_PLOT12_P1_PerCP[!VI_PLOT12_P1_PerCP$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT4_restructured_BAD_REMOVED <- VI_PLOT4_restructured[!VI_PLOT4_restructured$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]

```

## Basic plots showing the data by Family and then across families

## Percent Total Hemocytes out of all events
```{r percent_total_hemocytes, echo=TRUE}
 
VI_Percent_total_hemocytes_BAD_NOT_REMOVED <- ggplot(data= VI_PLOT2_hemocytes, aes(x=FAMILY, y=M4_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Hemocyte Events in Total Sample Events \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
VI_Percent_total_hemocytes_BAD_NOT_REMOVED
VI_Percent_total_hemocytes_BAD_REMOVED <- ggplot(data= VI_PLOT2_hemocytes_BAD_REMOVED, aes(x=FAMILY, y=M4_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Hemocyte Events in Total Sample Events \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
VI_Percent_total_hemocytes_BAD_REMOVED
```

# Arc sine Percentage data

```{r arcsine, echo=TRUE}

# Calculate Percent Live Granulocytes 
  # Take cells here and make a percentage out of GRANULAR hemocyte count from VI_PLOT3_P1_GATE P1_COUNT
VI_PLOT9_E1_MINUS_V1R$COUNT_THIS_PLOT <- as.numeric(VI_PLOT9_E1_MINUS_V1R$COUNT_THIS_PLOT)
VI_PLOT3_P1_GATE$P1_COUNT <- as.numeric(VI_PLOT3_P1_GATE$P1_COUNT)
VI_PLOT4_E1_E3_GATE$E1_COUNT <- as.numeric(VI_PLOT4_E1_E3_GATE$E1_COUNT)
VI_PLOT9_E1_MINUS_V1R$PERCENT_LIVE <- (VI_PLOT9_E1_MINUS_V1R$COUNT_THIS_PLOT / VI_PLOT4_E1_E3_GATE$E1_COUNT)*100

VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT <- as.numeric(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT)
VI_PLOT3_P1_GATE_BAD_REMOVED$P1_COUNT <- as.numeric(VI_PLOT3_P1_GATE_BAD_REMOVED$P1_COUNT)
VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_COUNT <- as.numeric(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_COUNT)
VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE <- (VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT / VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_COUNT)*100 

# Calculate Percent Live Agranulocytes
VI_PLOT10_E3_MINUS_V1R$COUNT_THIS_PLOT <- as.numeric(VI_PLOT10_E3_MINUS_V1R$COUNT_THIS_PLOT)
VI_PLOT4_E1_E3_GATE$E3_COUNT <- as.numeric(VI_PLOT4_E1_E3_GATE$E3_COUNT)
VI_PLOT10_E3_MINUS_V1R$PERCENT_LIVE <- (VI_PLOT10_E3_MINUS_V1R$COUNT_THIS_PLOT / VI_PLOT4_E1_E3_GATE$E3_COUNT)*100

VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT <- as.numeric(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT)
VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_COUNT <- as.numeric(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_COUNT)
VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE <- (VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT / VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_COUNT)*100 

# NOTE: NA's produced whenever the percentages were above 100%
VI_PLOT2_hemocytes$Arcsine <- transf.arcsin(VI_PLOT2_hemocytes$M4_PERCENT_OF_THIS_PLOT*.01)
VI_PLOT4_E1_E3_GATE$E1_Arcsine <- transf.arcsin(VI_PLOT4_E1_E3_GATE$E1_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT4_E1_E3_GATE$E3_Arcsine <- transf.arcsin(VI_PLOT4_E1_E3_GATE$E3_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT4_restructured$Arcsine <- transf.arcsin(VI_PLOT4_restructured$PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT9_E1_MINUS_V1R$Arcsine <- transf.arcsin(VI_PLOT9_E1_MINUS_V1R$PERCENT_LIVE*0.01)
VI_PLOT10_E3_MINUS_V1R$Arcsine <- transf.arcsin(VI_PLOT10_E3_MINUS_V1R$PERCENT_LIVE*0.01)
VI_PLOT12_P1_PerCP$V1_L_Arcsine <- transf.arcsin(VI_PLOT12_P1_PerCP$V1_L_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT12_P1_PerCP$V1_R_Arcsine <- transf.arcsin(VI_PLOT12_P1_PerCP$V1_R_PERCENT_OF_THIS_PLOT*0.01)

# NOTE: NA's produced whenever the percentages were above 100%
VI_PLOT2_hemocytes_BAD_REMOVED$Arcsine <- transf.arcsin(VI_PLOT2_hemocytes_BAD_REMOVED$M4_PERCENT_OF_THIS_PLOT*.01)
VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_Arcsine <- transf.arcsin(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_Arcsine <- transf.arcsin(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$Arcsine <- transf.arcsin(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE*0.01)
VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$Arcsine <- transf.arcsin(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE*0.01)
VI_PLOT12_P1_PerCP_BAD_REMOVED$V1_L_Arcsine <- transf.arcsin(VI_PLOT12_P1_PerCP_BAD_REMOVED$V1_L_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT12_P1_PerCP_BAD_REMOVED$V1_R_Arcsine <- transf.arcsin(VI_PLOT12_P1_PerCP_BAD_REMOVED$V1_R_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT4_restructured_BAD_REMOVED$Arcsine <- transf.arcsin(VI_PLOT4_restructured_BAD_REMOVED$PERCENT_OF_THIS_PLOT*0.01)
```

NOTE: Families with significant differences within or between groups have been highlighted in yellow

## Percent Granular Hemocytes out of all hemocytes
```{r percent_granular_hemocytes, echo=TRUE}
VI_Percent_Granular_Hemocytes_BAD_NOT_REMOVED <- ggplot(data=VI_PLOT4_E1_E3_GATE, aes(y=E1_PERCENT_OF_THIS_PLOT, x=FAMILY, by=GROUP, color=GROUP)) + geom_boxplot() + ggtitle("Percent of Granular Hemocyte \n Events Low Quality Not Removed") +xlab("Family") + ylab("Percent of Live and Dead Granular Hemocytes") + ylim(0,100)
VI_Percent_Granular_Hemocytes_BAD_NOT_REMOVED

VI_Percent_Granular_Hemocytes_BAD_REMOVED <- ggplot(data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED, aes(y=E1_PERCENT_OF_THIS_PLOT, x=FAMILY, by=GROUP, color=GROUP)) + geom_boxplot() + ggtitle("Percent of Granular Hemocyte \n Events Low Quality Removed") +
  xlab("Family") + ylab("Percent of Live and Dead Granular Hemocytes") + ylim(0,100)
VI_Percent_Granular_Hemocytes_BAD_REMOVED
```

## Percent of granular hemocytes (E1)

### FAMILY A
```{r granular_A, echo=TRUE}
VI_PLOT4_FAMILY_A <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="A")
VI_PLOT4_E1_AOV_FAMILY_A <- aov(VI_PLOT4_FAMILY_A$E1_Arcsine ~ VI_PLOT4_FAMILY_A$GROUP, data=VI_PLOT4_FAMILY_A)
summary(VI_PLOT4_E1_AOV_FAMILY_A)
VI_PLOT4_FAMILY_A_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="A")
VI_PLOT4_E1_AOV_FAMILY_A_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_A_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_FAMILY_A_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_A_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_A_BAD_REMOVED)
```

### FAMILY B

```{r granular_B, echo=TRUE}
V1_PLOT4_FAMILY_B <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="B")
VI_PLOT4_E1_AOV_FAMILY_B <- aov(V1_PLOT4_FAMILY_B$E1_Arcsine ~ V1_PLOT4_FAMILY_B$GROUP, data=V1_PLOT4_FAMILY_B)
summary(VI_PLOT4_E1_AOV_FAMILY_B)
V1_PLOT4_FAMILY_B_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY=="B")
VI_PLOT4_E1_AOV_FAMILY_B_BAD_REMOVED <- aov(V1_PLOT4_FAMILY_B_BAD_REMOVED$E1_Arcsine ~ V1_PLOT4_FAMILY_B_BAD_REMOVED$GROUP, data=V1_PLOT4_FAMILY_B_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_B_BAD_REMOVED)
```

### FAMILY D
```{r granular_D, echo=TRUE}
VI_PLOT4_FAMILY_D <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="D")
VI_PLOT4_E1_AOV_FAMILY_D <- aov(VI_PLOT4_FAMILY_D$E1_Arcsine ~ VI_PLOT4_FAMILY_D$GROUP, data=VI_PLOT4_FAMILY_D)
summary(VI_PLOT4_E1_AOV_FAMILY_D)
VI_PLOT4_FAMILY_D_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY=="D")
VI_PLOT4_E1_AOV_FAMILY_D_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_D_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_FAMILY_D_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_D_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_D_BAD_REMOVED)
```

### FAMILY E
```{r granular_E, echo=TRUE}
VI_PLOT4_FAMILY_E <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="E")
VI_PLOT4_E1_AOV_FAMILY_E <- aov(VI_PLOT4_FAMILY_E$E1_Arcsine ~ VI_PLOT4_FAMILY_E$GROUP, data=VI_PLOT4_FAMILY_E)
summary(VI_PLOT4_E1_AOV_FAMILY_E)
VI_PLOT4_FAMILY_E_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY=="E")
VI_PLOT4_E1_AOV_FAMILY_E_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_E_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_FAMILY_E_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_E_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_E_BAD_REMOVED)
```

### FAMILY J
```{r granular_J, echo=TRUE}
VI_PLOT4_FAMILY_J <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="J")
VI_PLOT4_E1_AOV_FAMILY_J <- aov(VI_PLOT4_FAMILY_J$E1_Arcsine ~ VI_PLOT4_FAMILY_J$GROUP, data=VI_PLOT4_FAMILY_J)
summary(VI_PLOT4_E1_AOV_FAMILY_J)
VI_PLOT4_FAMILY_J_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY=="J")
VI_PLOT4_E1_AOV_FAMILY_J_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_J_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_FAMILY_J_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_J_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_J_BAD_REMOVED)
```

### FAMILY L
```{r granular_L, echo=TRUE}
VI_PLOT4_FAMILY_L <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="L")
VI_PLOT4_E1_AOV_FAMILY_L <- aov(VI_PLOT4_FAMILY_L$E1_Arcsine ~ VI_PLOT4_FAMILY_L$GROUP, data=VI_PLOT4_FAMILY_L)
summary(VI_PLOT4_E1_AOV_FAMILY_L)
VI_PLOT4_FAMILY_L_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY=="L")
VI_PLOT4_E1_AOV_FAMILY_L_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_L_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_FAMILY_L_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_L_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_L_BAD_REMOVED)
```

### Two Way ANOVA of Granular Hemocytes

```{r granular_aov, echo=TRUE}
VI_PLOT4_Granular_hemocytes_AOV <- aov(VI_PLOT4_E1_E3_GATE$E1_Arcsine ~ VI_PLOT4_E1_E3_GATE$GROUP + VI_PLOT4_E1_E3_GATE$FAMILY, data=VI_PLOT4_E1_E3_GATE)
summary(VI_PLOT4_Granular_hemocytes_AOV)
VI_PLOT4_Granular_hemocytes_AOV_BAD_REMOVED <- aov(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP + VI_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY, data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED)
summary(VI_PLOT4_Granular_hemocytes_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED  (using lm model)
VI_PLOT4_Granular_hemocytes_INTERACTION_lm <- aov(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY + VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP + VI_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY*VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP)
summary(VI_PLOT4_Granular_hemocytes_INTERACTION_lm)
```

### One Way ANOVA of Differences between Families

```{r oneway_granular, include=TRUE}

VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED[!grepl("control", VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP),]
VI_PLOT4_Granular_hemocytes_oneway_lm <- aov(VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE$E1_Arcsine ~ VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE)
summary(VI_PLOT4_Granular_hemocytes_oneway_lm)
```

# Percent of Agranular hemocytes (E3) #

## Percent Agranular Hemocytes out of all hemocytes
```{r percent_agranular_hemocytes, echo=TRUE}
VI_Percent_Agranular_Hemocytes_BAD_NOT_REMOVED <-  ggplot(data=VI_PLOT4_E1_E3_GATE, aes(y=E3_PERCENT_OF_THIS_PLOT, x=FAMILY, by=GROUP, color=GROUP)) + geom_boxplot() + ggtitle("Percent of Agranular Hemocyte Events \n Low Quality Not Removed") +
  xlab("Family") + ylab("Percent of Live and Dead Agranular Hemocytes") + ylim(0,100)
VI_Percent_Agranular_Hemocytes_BAD_NOT_REMOVED
VI_Percent_Agranular_Hemocytes_BAD_REMOVED <-  ggplot(data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED, aes(y=E3_PERCENT_OF_THIS_PLOT, x=FAMILY, by=GROUP, color=GROUP)) + geom_boxplot() + ggtitle("Percent of Agranular Hemocyte Events") +
  xlab("Family") + ylab("Percent of Live and Dead \n Agranular Hemocytes Low Quality Removed") + ylim(0,100)
VI_Percent_Agranular_Hemocytes_BAD_REMOVED
```

### FAMILY A
```{r agranular_A, echo=TRUE}
VI_PLOT4_FAMILY_A_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="A")
VI_PLOT4_E3_AOV_FAMILY_A <- aov(VI_PLOT4_FAMILY_A_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_A_E3$GROUP, data=VI_PLOT4_FAMILY_A_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_A)
VI_PLOT4_FAMILY_A_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="A")
VI_PLOT4_E3_AOV_FAMILY_A_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_A_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_A_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_A_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_A_BAD_REMOVED)
```

### FAMILY B
```{r agranular_B, echo=FALSE}
VI_PLOT4_FAMILY_B_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="B")
VI_PLOT4_E3_AOV_FAMILY_B <- aov(VI_PLOT4_FAMILY_B_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_B_E3$GROUP, data=VI_PLOT4_FAMILY_B_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_B)
VI_PLOT4_FAMILY_B_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="B")
VI_PLOT4_E3_AOV_FAMILY_B_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_B_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_B_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_B_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_B_BAD_REMOVED)
```

### FAMILY D
```{r agranular D, echo=FALSE}
VI_PLOT4_FAMILY_D_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="D")
VI_PLOT4_E3_AOV_FAMILY_D <- aov(VI_PLOT4_FAMILY_D_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_D_E3$GROUP, data=VI_PLOT4_FAMILY_D_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_D)
VI_PLOT4_FAMILY_D_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="D")
VI_PLOT4_E3_AOV_FAMILY_D_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_D_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_D_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_D_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_D_BAD_REMOVED)
```

### FAMILY E
```{r agranular_E, echo=FALSE}
VI_PLOT4_FAMILY_E_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="E")
VI_PLOT4_E3_AOV_FAMILY_E <- aov(VI_PLOT4_FAMILY_E_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_E_E3$GROUP, data=VI_PLOT4_FAMILY_E_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_E)
VI_PLOT4_FAMILY_E_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="E")
VI_PLOT4_E3_AOV_FAMILY_E_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_E_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_E_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_E_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_E_BAD_REMOVED)
```

### FAMILY J
```{r agranular_J, echo=FALSE}
VI_PLOT4_FAMILY_J_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="J")
VI_PLOT4_E3_AOV_FAMILY_J <- aov(VI_PLOT4_FAMILY_J_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_J_E3$GROUP, data=VI_PLOT4_FAMILY_J_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_J)
VI_PLOT4_FAMILY_J_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="J")
VI_PLOT4_E3_AOV_FAMILY_J_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_J_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_J_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_J_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_J_BAD_REMOVED)
```

### FAMILY L 
```{r agrnaular_L, echo=FALSE}
VI_PLOT4_FAMILY_L_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="L")
VI_PLOT4_E3_AOV_FAMILY_L <- aov(VI_PLOT4_FAMILY_L_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_L_E3$GROUP, data=VI_PLOT4_FAMILY_L_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_L)
VI_PLOT4_FAMILY_L_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="L")
VI_PLOT4_E3_AOV_FAMILY_L_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_L_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_L_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_L_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_L_BAD_REMOVED)
```

### Two Way ANOVA of Agranular Hemocytes
```{r agrnaular_AOV, echo=FALSE}
VI_PLOT4_Agranular_hemocytes_AOV <- aov(VI_PLOT4_E1_E3_GATE$E3_Arcsine ~ VI_PLOT4_E1_E3_GATE$GROUP + VI_PLOT4_E1_E3_GATE$FAMILY, data=VI_PLOT4_E1_E3_GATE)
summary(VI_PLOT4_Agranular_hemocytes_AOV)
VI_PLOT4_Agranular_hemocytes_AOV_BAD_REMOVED <- aov(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP + VI_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY, data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED)
summary(VI_PLOT4_Agranular_hemocytes_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED  (using lm model)
VI_PLOT4_Agranular_hemocytes_INTERACTION_aov <- aov(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY + VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP + VI_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY:VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP)
summary(VI_PLOT4_Agranular_hemocytes_INTERACTION_aov)

```

### One Way ANOVA of Differences between Families

```{r oneway_Agranular, include=FALSe}

VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED[!grepl("control", VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP),]
VI_PLOT4_Agranular_hemocytes_oneway_aov <- aov(VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE$E3_Arcsine ~ VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE)
summary(VI_PLOT4_Agranular_hemocytes_oneway_aov)
```

# Percent of Live Granular Hemocytes #

## Percent Live Granular Hemocytes out of all Granular hemocytes
```{r percent, echo=FALSE}
VI_Percent_Live_Granular_BAD_NOT_REMOVED_GRAPH <- ggplot(VI_PLOT9_E1_MINUS_V1R, aes(x=FAMILY, y=PERCENT_LIVE, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Granular Hemocyte Events \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Live Granular Hemocytes") + ylim(0,100)
VI_Percent_Live_Granular_BAD_NOT_REMOVED_GRAPH                               

VI_Percent_Live_Granular_BAD_REMOVED_GRAPH <- ggplot(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED, aes(x=FAMILY, y=PERCENT_LIVE, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Granular Hemocyte \n Events Low Quality Removed") + xlab("Family") + ylab("Percent of Live Granular Hemocytes") + ylim(0,100)
VI_Percent_Live_Granular_BAD_REMOVED_GRAPH                          
```

### FAMILY A
```{r live_granular_A, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_A <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="A")
VI_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_A$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_A$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_A)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV)
VI_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="A")
VI_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED)
```

### FAMILY B
```{r live_granular_B, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_B <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="B")
VI_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_B$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_B$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_B)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV)
VI_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="B")
VI_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED)
```

### FAMILY D
```{r live_granula_D, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_D <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="D")
VI_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_D$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_D$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_D)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV)
VI_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="D")
VI_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED)
```

### FAMILY E
```{r live_granular_E, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_E <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="E")
VI_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_E$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_E$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_E)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV)
VI_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="E")
VI_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED)
```

### FAMILY J
```{r live_granular_J, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_J <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="J")
VI_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_J$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_J$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_J)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV)
VI_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="J")
VI_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED)
```

### FAMILY L
```{r live_granular_L, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_L <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="L")
VI_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_L$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_L$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_L)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV) 
VI_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="L")
VI_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED)
```

### Two Way ANOVA of LIVE Granular Hemocytes
```{r live_granular_aov, echo=FALSE}
VI_PLOT9_LIVE_granular_hemocytes_AOV <- aov(VI_PLOT9_E1_MINUS_V1R$Arcsine ~ VI_PLOT9_E1_MINUS_V1R$GROUP + VI_PLOT9_E1_MINUS_V1R$FAMILY, data=VI_PLOT9_E1_MINUS_V1R)
summary(VI_PLOT9_LIVE_granular_hemocytes_AOV)
VI_PLOT9_LIVE_granular_hemocytes_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP + VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY, data=VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED)
summary(VI_PLOT9_LIVE_granular_hemocytes_AOV_BAD_REMOVED)
TukeyHSD(VI_PLOT9_LIVE_granular_hemocytes_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED
VI_PLOT9_LIVE_granular_hemocytes_INTERACTION_aov <- aov(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY + VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP + VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY*VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP)
summary(VI_PLOT9_LIVE_granular_hemocytes_INTERACTION_aov)
TukeyHSD(VI_PLOT9_LIVE_granular_hemocytes_INTERACTION_aov)

```

### One Way ANOVA of Differences between Families

```{r oneway_live-granular, include=FALSE}

VI_PLOT9_LIVE_granular_hemocytes_BAD_REMOVED_CHALLENGE <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED[!grepl("control", VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP),]
VI_PLOT9_LIVE_granular_hemocytes_oneway_aov <- aov(VI_PLOT9_LIVE_granular_hemocytes_BAD_REMOVED_CHALLENGE$Arcsine ~ VI_PLOT9_LIVE_granular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_PLOT9_LIVE_granular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(VI_PLOT9_LIVE_granular_hemocytes_oneway_aov)
```
# Percent of Live Agranular Hemocytes (E3) #

# Percent Live Agranular Hemocytes
```{r percent_live_agranular_hemocytes, echo=FALSE}
VI_Percent_Live_Agranular_BAD_NOT_REMOVED_GRAPH <- ggplot(VI_PLOT10_E3_MINUS_V1R, aes(x=FAMILY, y=PERCENT_LIVE, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Agranular Hemocyte \n Events Low Quality Not Removed") + xlab("Family") +   ylab("Percent of Live Agranular Hemocytes") + ylim(0,100)          
VI_Percent_Live_Agranular_BAD_NOT_REMOVED_GRAPH                                             

VI_Percent_Live_Agranular_BAD_REMOVED_GRAPH <- ggplot(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED, aes(x=FAMILY, y=PERCENT_LIVE, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Agranular Hemocyte \n Events Low Quality Removed") + xlab("Family") + ylab("Percent of Live Agranular Hemocytes") + ylim(0,100)
VI_Percent_Live_Agranular_BAD_REMOVED_GRAPH                                                          
```

### FAMILY A
```{r live_agranular_A, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_A <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="A")
VI_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_A$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_A$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_A)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="A")
VI_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED)
```

### FAMILY B
```{r live_agranular_B, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_B <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="B")
VI_PLOT10_E3_MINUS_V1R_FAMILY_B_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_B$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_B$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_B)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_B_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="B")
VI_PLOT10_E1_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED)
summary(VI_PLOT10_E1_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED)
```

### FAMILY D
```{r live_agranular_D, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_D <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="D")
VI_PLOT10_E3_MINUS_V1R_FAMILY_D_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_D$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_D$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_D)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_D_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="D")
VI_PLOT10_E1_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED)
summary(VI_PLOT10_E1_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED)
```

### FAMILY E
```{r live_agranular_E, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_E <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="E")
VI_PLOT10_E3_MINUS_V1R_FAMILY_E_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_E$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_E$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_E)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_E_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="E")
VI_PLOT10_E1_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED)
summary(VI_PLOT10_E1_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED)
```

### FAMILY J
```{r live_agranular_J, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_J <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="J")
VI_PLOT10_E3_MINUS_V1R_FAMILY_J_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_J$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_J$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_J)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_J_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="J")
VI_PLOT10_E1_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED)
summary(VI_PLOT10_E1_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED)
```

### FAMILY L
```{r live_agranular_L, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_L <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="L")
VI_PLOT10_E3_MINUS_V1R_FAMILY_L_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_L$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_L$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_L)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_L_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="L")
VI_PLOT10_E1_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED)
summary(VI_PLOT10_E1_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED)
```

### Two Way ANOVA of LIVE AGranular Hemocytes
```{r live_agranular_aov, echo=FALSE}
VI_PLOT10_LIVE_AGranular_hemocytes_AOV <- aov(VI_PLOT10_E3_MINUS_V1R$Arcsine ~ VI_PLOT10_E3_MINUS_V1R$GROUP + VI_PLOT10_E3_MINUS_V1R$FAMILY, data=VI_PLOT10_E3_MINUS_V1R)
summary(VI_PLOT10_LIVE_AGranular_hemocytes_AOV)
VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP + VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$FAMILY, data=VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED)
summary(VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED)
TukeyHSD(VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED  (using lm model)
VI_PLOT10_LIVE_AGranular_hemocytes_INTERACTION_aov <- aov(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$FAMILY + VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP + VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$FAMILY*VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP)
summary(VI_PLOT10_LIVE_AGranular_hemocytes_INTERACTION_aov)

```

### One Way ANOVA of Differences between Families

```{r oneway_live-agranular, include=FALSE}

VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED_CHALLENGE <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED[!grepl("control", VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP),]
VI_PLOT10_LIVE_AGranular_hemocytes_oneway_aov <- aov(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED_CHALLENGE$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED_CHALLENGE)
summary(VI_PLOT10_LIVE_AGranular_hemocytes_oneway_aov)
```

## ANALYZING DIFFERENCE BETWEEN PERCENTAGE OF AGRANULAR VERSUS GRANULAR TOTAL, AND LIVE AND DEAD
```{r difference_between_cells, include=TRUE}
## Statistical difference between total agranular cells and granular cells 
VI_PLOT4_granular_vs_agranular_twoway_aov <- aov(VI_PLOT4_restructured_BAD_REMOVED$Arcsine ~ VI_PLOT4_restructured_BAD_REMOVED$E1_E3 + VI_PLOT4_restructured_BAD_REMOVED$GROUP, data=VI_PLOT4_E1_E3_GATE)
summary(VI_PLOT4_granular_vs_agranular_twoway_aov)
TukeyHSD(VI_PLOT4_granular_vs_agranular_twoway_aov)

# Plus an interaction term
VI_PLOT4_granular_vs_agranular_twoway_interaction_aov <- aov(VI_PLOT4_restructured_BAD_REMOVED$Arcsine ~ VI_PLOT4_restructured_BAD_REMOVED$E1_E3 + VI_PLOT4_restructured_BAD_REMOVED$GROUP + VI_PLOT4_restructured_BAD_REMOVED$E1_E3*VI_PLOT4_restructured_BAD_REMOVED$GROUP, data=VI_PLOT4_E1_E3_GATE)
summary(VI_PLOT4_granular_vs_agranular_twoway_interaction_aov)
TukeyHSD(VI_PLOT4_granular_vs_agranular_twoway_interaction_aov)

## Statistical difference between Live agranular cells and granular cells 
VI_PLOT9_E1_MINUS_V1R$E1_E3 <- "E1"
VI_PLOT10_E3_MINUS_V1R$E1_E3 <- "E3"
VI_PLOT9_PLOT10_combined <-rbind(VI_PLOT9_E1_MINUS_V1R, VI_PLOT10_E3_MINUS_V1R)

VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$E1_E3 <- "E1"
VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$E1_E3 <- "E3"
VI_PLOT9_PLOT10_BAD_REMOVED_combined <-rbind(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED, VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED)

VI_PLOT9_PLOT10_granular_vs_agranular_twoway_aov <- aov(VI_PLOT9_PLOT10_BAD_REMOVED_combined$Arcsine ~ VI_PLOT9_PLOT10_BAD_REMOVED_combined$E1_E3 +  VI_PLOT9_PLOT10_BAD_REMOVED_combined$GROUP,data=VI_PLOT9_PLOT10_BAD_REMOVED_combined)
summary(VI_PLOT9_PLOT10_granular_vs_agranular_twoway_aov)
TukeyHSD(VI_PLOT9_PLOT10_granular_vs_agranular_twoway_aov)

# Plus an interaction term
VI_PLOT9_PLOT10_granular_vs_agranular_twoway_interaction_aov <- aov(VI_PLOT9_PLOT10_BAD_REMOVED_combined$Arcsine ~ VI_PLOT9_PLOT10_BAD_REMOVED_combined$E1_E3 + VI_PLOT9_PLOT10_BAD_REMOVED_combined$GROUP + VI_PLOT9_PLOT10_BAD_REMOVED_combined$E1_E3*VI_PLOT9_PLOT10_BAD_REMOVED_combined$GROUP, data=VI_PLOT9_PLOT10_BAD_REMOVED_combined)
summary(VI_PLOT9_PLOT10_granular_vs_agranular_twoway_interaction_aov)
TukeyHSD(VI_PLOT9_PLOT10_granular_vs_agranular_twoway_interaction_aov)
```

## VIABILITY ASSAY OBSERVATIONS AND CONCLUSIONS
When comparing the control and treatment percentages of granular hemocytes and agranular hemocytes within families, no significant differences were observed. No significant differences were observed between families either. 

## APOPTOSIS ASSAY

## Load in data for each plot

```{r load_data, echo=TRUE}
#Load in the Data for each plot on a separate spreadsheet

APOP_PLOT3_P1_GATE <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT3.csv", header=TRUE)
APOP_PLOT8_GRANULAR_AGRANULAR <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT8.csv", header=TRUE)
APOP_PLOT4_GRANULAR_QUAD_PLOT <-read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT4.csv", header=TRUE)
APOP_PLOT7_AGRANULAR_QUAD_PLOT <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT7.csv", header=TRUE)

APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT4_GATE_ADDED.csv", header=TRUE)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT7_GATE_ADDED.csv", header=TRUE)

#Remove empty rows
APOP_PLOT3_P1_GATE <- na.omit(APOP_PLOT3_P1_GATE)
APOP_PLOT8_GRANULAR_AGRANULAR <- na.omit(APOP_PLOT8_GRANULAR_AGRANULAR)
APOP_PLOT4_GRANULAR_QUAD_PLOT <- na.omit(APOP_PLOT4_GRANULAR_QUAD_PLOT)
APOP_PLOT7_AGRANULAR_QUAD_PLOT<- na.omit(APOP_PLOT7_AGRANULAR_QUAD_PLOT)

APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED <- na.omit(APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED <- na.omit(APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED)


## Remove percent symbol from columns 
APOP_PLOT3_P1_GATE$P1_PERCENT_OF_THE_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT3_P1_GATE$P1_PERCENT_OF_THE_PLOT))
APOP_PLOT8_GRANULAR_AGRANULAR$P3_PERCENT_OF_THIS_PLOT<- as.numeric(gsub("\\%", "", APOP_PLOT8_GRANULAR_AGRANULAR$P3_PERCENT_OF_THIS_PLOT))
APOP_PLOT8_GRANULAR_AGRANULAR$P4_PERCENT_OF_THIS_PLOT<- as.numeric(gsub("\\%", "", APOP_PLOT8_GRANULAR_AGRANULAR$P4_PERCENT_OF_THIS_PLOT))

APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UL_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UL_PERCENT_OF_THIS_PLOT))
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UR_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UR_PERCENT_OF_THIS_PLOT))
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LL_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LL_PERCENT_OF_THIS_PLOT))
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LR_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LR_PERCENT_OF_THIS_PLOT))

APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UL_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UL_PERCENT_OF_THIS_PLOT))
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UR_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UR_PERCENT_OF_THIS_PLOT))
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LL_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LL_PERCENT_OF_THIS_PLOT))
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LR_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LR_PERCENT_OF_THIS_PLOT))

APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT))
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT))

# Load in Data for the samples to remove 
APOPTOSIS_Samples_Remove <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/APOPTOSIS_SAMPLES_REMOVE.csv", header=TRUE)

# Data Frame with bad samples removed
APOP_PLOT3_P1_GATE_BAD_REMOVED <- APOP_PLOT3_P1_GATE[!APOP_PLOT3_P1_GATE$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]
APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED <- APOP_PLOT8_GRANULAR_AGRANULAR[!APOP_PLOT8_GRANULAR_AGRANULAR$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]
APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED <- APOP_PLOT4_GRANULAR_QUAD_PLOT[!APOP_PLOT4_GRANULAR_QUAD_PLOT$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]
APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED <- APOP_PLOT7_AGRANULAR_QUAD_PLOT[!APOP_PLOT7_AGRANULAR_QUAD_PLOT$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]
APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED <- APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED[!APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED[!APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]

```

# Arc sine Percentage data
```{r arcsine_percentages, echo=FALSE}
# NOTE: NA's produced whenever the percentages were above 100%
APOP_PLOT3_P1_GATE$Arcsine<- transf.arcsin(APOP_PLOT3_P1_GATE$P1_PERCENT_OF_THE_PLOT*0.01)
APOP_PLOT8_GRANULAR_AGRANULAR$P3_Arcsine <- transf.arcsin(APOP_PLOT8_GRANULAR_AGRANULAR$P3_PERCENT_OF_THIS_PLOT *0.01)
APOP_PLOT8_GRANULAR_AGRANULAR$P4_Arcsine <- transf.arcsin(APOP_PLOT8_GRANULAR_AGRANULAR$P4_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UL_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UR_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UR_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LL_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LR_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LR_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UL_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UR_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UR_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LL_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LR_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LR_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT*0.01)

# NOTE: NA's produced whenever the percentages were above 100%
APOP_PLOT3_P1_GATE_BAD_REMOVED$Arcsine<- transf.arcsin(APOP_PLOT3_P1_GATE_BAD_REMOVED$P1_PERCENT_OF_THE_PLOT*0.01)
APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P3_Arcsine <- transf.arcsin(APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P3_PERCENT_OF_THIS_PLOT *0.01)
APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P4_Arcsine <- transf.arcsin(APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P4_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UL_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UR_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UR_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LL_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LR_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LR_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UL_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UR_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UR_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LL_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LR_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LR_PERCENT_OF_THIS_PLOT*0.01)
```

# % LIVE apoptotic granular hemocytes (PLOT4, Q2-LR)

## Percent LIVE apoptotic granular hemocytes (PLOT4, Q2-LR)
```{r LIVE_apoptotic_Granular, include=TRUE, echo=FALSE}
 
APOP_live_apoptotic_granular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q2.LR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Granular Hemocytes \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

APOP_live_apoptotic_granular_BAD_NOT_REMOVED

APOP_live_apoptotic_granular_BAD_REMOVED <- ggplot(data= APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q2.LR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Granular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
APOP_live_apoptotic_granular_BAD_REMOVED
```


### FAMILY A

```{r live_apoptotic_granular_aov_A, echo=FALSE}
APOP_PLOT_4_granular_FAMILY_A <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="A")

APOP_PLOT_4_granular_FAMILY_A_AOV <- aov(APOP_PLOT_4_granular_FAMILY_A$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A$GROUP, data=APOP_PLOT_4_granular_FAMILY_A)
summary(APOP_PLOT_4_granular_FAMILY_A_AOV)

APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="A")
APOP_PLOT_4_granular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_A_AOV_BAD_REMOVED)      
        
```


### FAMILY B
```{r live_apoptotic_granular_aov_B, echo=FALSE}
APOP_PLOT_4_granular_FAMILY_B <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="B")

APOP_PLOT_4_granular_FAMILY_B_AOV <- aov(APOP_PLOT_4_granular_FAMILY_B$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B$GROUP, data=APOP_PLOT_4_granular_FAMILY_B)
summary(APOP_PLOT_4_granular_FAMILY_B_AOV)

APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="B")
APOP_PLOT_4_granular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r live_apoptotic_granular_aov_D, echo=FALSE}
APOP_PLOT_4_granular_FAMILY_D <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="D")

APOP_PLOT_4_granular_FAMILY_D_AOV <- aov(APOP_PLOT_4_granular_FAMILY_D$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D$GROUP, data=APOP_PLOT_4_granular_FAMILY_D)
summary(APOP_PLOT_4_granular_FAMILY_D_AOV)

APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="D")
APOP_PLOT_4_granular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E

```{r live_apoptotic_granular_aov_E, echo=FALSE}
APOP_PLOT_4_granular_FAMILY_E <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="E")

APOP_PLOT_4_granular_FAMILY_E_AOV <- aov(APOP_PLOT_4_granular_FAMILY_E$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E$GROUP, data=APOP_PLOT_4_granular_FAMILY_E)
summary(APOP_PLOT_4_granular_FAMILY_E_AOV)

APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="E")
APOP_PLOT_4_granular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_E_AOV_BAD_REMOVED)      

```

### FAMILY J 
```{r live_apoptotic_granular_aov_J, echo=FALSE}
APOP_PLOT_4_granular_FAMILY_J <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="J")

APOP_PLOT_4_granular_FAMILY_J_AOV <- aov(APOP_PLOT_4_granular_FAMILY_J$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J$GROUP, data=APOP_PLOT_4_granular_FAMILY_J)
summary(APOP_PLOT_4_granular_FAMILY_J_AOV)

APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="J")
APOP_PLOT_4_granular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 
```{r live_apoptotic_granular_aov_L, echo=FALSE}
APOP_PLOT_4_granular_FAMILY_L <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="L")

APOP_PLOT_4_granular_FAMILY_L_AOV <- aov(APOP_PLOT_4_granular_FAMILY_L$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L$GROUP, data=APOP_PLOT_4_granular_FAMILY_L)
summary(APOP_PLOT_4_granular_FAMILY_L_AOV)

APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="L")
APOP_PLOT_4_granular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_L_AOV_BAD_REMOVED)      

```

### TWO WAY ANOVA
```{r live_granular_apoptotic_aov, echo=FALSE}
APOP_PLOT_4_granular_TWO_WAY_AOV <- aov(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT)
summary(APOP_PLOT_4_granular_TWO_WAY_AOV)

APOP_PLOT_4_granular_TWO_WAY_AOV_BAD_REMOVED <- aov(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED)
summary(APOP_PLOT_4_granular_TWO_WAY_AOV_BAD_REMOVED)
TukeyHSD(APOP_PLOT_4_granular_TWO_WAY_AOV_BAD_REMOVED)


# INTERACTION TERM ADDED  (using lm model)
APOP_PLOT_4_granular_hemocytes_INTERACTION_aov <- aov(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY*APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
summary(APOP_PLOT_4_granular_hemocytes_INTERACTION_aov)
TukeyHSD(APOP_PLOT_4_granular_hemocytes_INTERACTION_aov)

```

### One Way ANOVA of Differences between Families

```{r oneway_apoptotic-granular, include=FALSE}

APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control", APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_4_granular_hemocytes_oneway_aov <- aov(APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_4_granular_hemocytes_oneway_aov)
TukeyHSD(APOP_PLOT_4_granular_hemocytes_oneway_aov)
```

# % LIVE apoptotic agranular hemocytes (PLOT 7, Q1-LR)

## Percent LIVE apoptotic agranular hemocytes (PLOT7, Q1-LR)

```{r live_apoptotic_agranular, echo=FALSE}

APOP_live_apoptotic_Agranular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q1.LR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Agranular Hemocytes \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

APOP_live_apoptotic_Agranular_BAD_NOT_REMOVED

APOP_live_apoptotic_Agranular_BAD_REMOVED <- ggplot(data= APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q1.LR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Agranular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
APOP_live_apoptotic_Agranular_BAD_REMOVED

```


### FAMILY A
```{r live_apoptotic_agranular_aov_A, echo=FALSE}
APOP_PLOT_7_agranular_FAMILY_A <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="A")

APOP_PLOT_7_agranular_FAMILY_A_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_A$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A)
summary(APOP_PLOT_7_agranular_FAMILY_A_AOV)

APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="A")
APOP_PLOT_7_agranular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_A_AOV_BAD_REMOVED)      

```

### FAMILY B

```{r live_apoptotic_agranular_aov_B, echo=FALSE}
APOP_PLOT_7_agranular_FAMILY_B <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="B")

APOP_PLOT_7_agranular_FAMILY_B_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_B$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B)
summary(APOP_PLOT_7_agranular_FAMILY_B_AOV)

APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="B")
APOP_PLOT_7_agranular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r live_apoptotic_agranular_aov_D, echo=FALSE}
APOP_PLOT_7_agranular_FAMILY_D <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="D")

APOP_PLOT_7_agranular_FAMILY_D_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_D$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D)
summary(APOP_PLOT_7_agranular_FAMILY_D_AOV)

APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="D")
APOP_PLOT_7_agranular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E

```{r live_apoptotic_agranular_aov_E, echo=FALSE}
APOP_PLOT_7_agranular_FAMILY_E <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="E")

APOP_PLOT_7_agranular_FAMILY_E_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_E$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E)
summary(APOP_PLOT_7_agranular_FAMILY_E_AOV)

APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="E")
APOP_PLOT_7_agranular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_E_AOV_BAD_REMOVED)      

```

### FAMILY J 
```{r live_apoptotic_agranular_aov_J, echo=FALSE}
APOP_PLOT_7_agranular_FAMILY_J <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="J")

APOP_PLOT_7_agranular_FAMILY_J_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_J$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J)
summary(APOP_PLOT_7_agranular_FAMILY_J_AOV)

APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="J")
APOP_PLOT_7_agranular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 

```{r live_apoptotic_agranular_aov_L, echo=FALSE}
APOP_PLOT_7_agranular_FAMILY_L <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="L")

APOP_PLOT_7_agranular_FAMILY_L_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_L$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L)
summary(APOP_PLOT_7_agranular_FAMILY_L_AOV)

APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="L")
APOP_PLOT_7_agranular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_L_AOV_BAD_REMOVED)      

```

### TWO WAY ANOVA

```{r live_Agranular_apoptotic_aov, echo=FALSE}
APOP_PLOT_7_agranular_TWO_WAY_AOV <- aov(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT)
summary(APOP_PLOT_7_agranular_TWO_WAY_AOV)

APOP_PLOT_7_agranular_TWO_WAY_AOV_BAD_REMOVED <- aov(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_TWO_WAY_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED
APOP_PLOT_7_agranular_INTERACTION_aov <- aov(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY*APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
summary(APOP_PLOT_7_agranular_INTERACTION_aov)
TukeyHSD(APOP_PLOT_7_agranular_INTERACTION_aov)

```

### One Way ANOVA of Differences between Families

```{r oneway_apoptotic-agranular, include=FALSE}

APOP_PLOT_7_agranular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control", APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_7_agranular_oneway_aov <- aov(APOP_PLOT_7_agranular_hemocytes_BAD_REMOVED_CHALLENGE$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_7_agranular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_7_agranular_oneway_aov)
```


## % DEAD apoptotic granular hemocytes (PLOT4, Q2-UR)

## Percent DEAD apoptotic granular hemocytes (PLOT4, Q1-UR)

```{r dead_apoptotic_granular, echo=FALSE}
APOP_dead_apoptotic_granular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q2.UR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Granular Hemocytes \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

APOP_dead_apoptotic_granular_BAD_NOT_REMOVED

APOP_dead_apoptotic_granular_BAD_REMOVED <- ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q2.UR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Granular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
APOP_dead_apoptotic_granular_BAD_REMOVED

```


### FAMILY A
```{r dead_apoptotic_granular_aov_A, echo=FALSE}

APOP_PLOT_4_dead_granular_FAMILY_A_AOV <- aov(APOP_PLOT_4_granular_FAMILY_A$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A$GROUP, data=APOP_PLOT_4_granular_FAMILY_A)
summary(APOP_PLOT_4_dead_granular_FAMILY_A_AOV)

APOP_PLOT_4_dead_granular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_A_AOV_BAD_REMOVED)      

```

### FAMILY B
```{r dead_apoptotic_granular_aov_B, echo=FALSE}

APOP_PLOT_4_dead_granular_FAMILY_B_AOV <- aov(APOP_PLOT_4_granular_FAMILY_B$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B$GROUP, data=APOP_PLOT_4_granular_FAMILY_B)
summary(APOP_PLOT_4_dead_granular_FAMILY_B_AOV)

APOP_PLOT_4_dead_granular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r dead_apoptotic_granular_aov_D, echo=FALSE}

APOP_PLOT_4_dead_granular_FAMILY_D_AOV <- aov(APOP_PLOT_4_granular_FAMILY_D$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D$GROUP, data=APOP_PLOT_4_granular_FAMILY_D)
summary(APOP_PLOT_4_dead_granular_FAMILY_D_AOV)

APOP_PLOT_4_dead_granular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E

```{r dead_apoptotic_granular_aov_E, echo=FALSE}

APOP_PLOT_4_dead_granular_FAMILY_E_AOV <- aov(APOP_PLOT_4_granular_FAMILY_E$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E$GROUP, data=APOP_PLOT_4_granular_FAMILY_E)
summary(APOP_PLOT_4_dead_granular_FAMILY_E_AOV)

APOP_PLOT_4_dead_granular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_E_AOV_BAD_REMOVED)      

```

### FAMILY J 

```{r dead_apoptotic_granular_aov_J, echo=FALSE}

APOP_PLOT_4_dead_granular_FAMILY_J_AOV <- aov(APOP_PLOT_4_granular_FAMILY_J$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J$GROUP, data=APOP_PLOT_4_granular_FAMILY_J)
summary(APOP_PLOT_4_dead_granular_FAMILY_J_AOV)

APOP_PLOT_4_dead_granular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 
```{r dead_apoptotic_granular_aov_L, echo=FALSE}

APOP_PLOT_4_dead_granular_FAMILY_L_AOV <- aov(APOP_PLOT_4_granular_FAMILY_L$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L$GROUP, data=APOP_PLOT_4_granular_FAMILY_L)
summary(APOP_PLOT_4_dead_granular_FAMILY_L_AOV)

APOP_PLOT_4_dead_granular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_L_AOV_BAD_REMOVED)      

```

### TWO WAY ANOVA

```{r DEAD_granular_apoptotic_aov, echo=FALSE}
APOP_PLOT_4_dead_granular_TWO_WAY_AOV <- aov(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT)
summary(APOP_PLOT_4_dead_granular_TWO_WAY_AOV)

APOP_PLOT_4_dead_granular_TWO_WAY_AOV_BAD_REMOVED <- aov(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_TWO_WAY_AOV_BAD_REMOVED)
TukeyHSD(APOP_PLOT_4_dead_granular_TWO_WAY_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED  (using lm model)
APOP_PLOT_4_dead_granular_INTERACTION_aov <- aov(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY*APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
summary(APOP_PLOT_4_dead_granular_INTERACTION_aov)
TukeyHSD(APOP_PLOT_4_dead_granular_INTERACTION_aov)

```

### One Way ANOVA of Differences between Families

```{r oneway_DEAD_granular_apoptotic, include=FALSE}

APOP_PLOT_4_dead_granular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control",APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_4_dead_granular_oneway_aov <- aov(APOP_PLOT_4_dead_granular_hemocytes_BAD_REMOVED_CHALLENGE$Q2.UR_Arcsine ~ APOP_PLOT_4_dead_granular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_4_dead_granular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_4_dead_granular_oneway_aov)
TukeyHSD(APOP_PLOT_4_dead_granular_oneway_aov)
```


## % DEAD apoptotic agranular hemocytes (PLOT 7, Q1-UR)

## Percent DEAD apoptotic agranular hemocytes (PLOT 7, Q1-UR)

```{r dead apoptotic_agranular, echo=FALSE}

APOP_dead_apoptotic_Agranular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q1.UR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Agranular Hemocytes \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

APOP_dead_apoptotic_Agranular_BAD_NOT_REMOVED

APOP_dead_apoptotic_Agranular_BAD_REMOVED <- ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q1.UR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Agranular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
APOP_dead_apoptotic_Agranular_BAD_REMOVED

```


### FAMILY A
```{r dead_apoptotic_agranular_aov_A, echo=FALSE}

APOP_PLOT_7_dead_agranular_FAMILY_A_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_A$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A)
summary(APOP_PLOT_7_dead_agranular_FAMILY_A_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_A_AOV_BAD_REMOVED)      

```

### FAMILY B
```{r dead_apoptotic_agranular_aov_B, echo=FALSE}

APOP_PLOT_7_dead_agranular_FAMILY_B_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_B$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B)
summary(APOP_PLOT_7_dead_agranular_FAMILY_B_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r dead_apoptotic_agranular_aov_D, echo=FALSE}

APOP_PLOT_7_dead_agranular_FAMILY_D_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_D$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D)
summary(APOP_PLOT_7_dead_agranular_FAMILY_D_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E
```{r dead_apoptotic_agranular_aov_E, echo=FALSE}

APOP_PLOT_7_dead_agranular_FAMILY_E_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_E$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E)
summary(APOP_PLOT_7_dead_agranular_FAMILY_E_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_E_AOV_BAD_REMOVED)      

```

### FAMILY J 

```{r dead_apoptotic_agranular_aov_J, echo=FALSE}

APOP_PLOT_7_dead_agranular_FAMILY_J_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_J$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J)
summary(APOP_PLOT_7_dead_agranular_FAMILY_J_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 
```{r dead_apoptotic_agranular_aov_L, echo=FALSE}

APOP_PLOT_7_dead_agranular_FAMILY_L_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_L$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L)
summary(APOP_PLOT_7_dead_agranular_FAMILY_L_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_L_AOV_BAD_REMOVED)      

```

### TWO WAY ANOVA

```{r DEAD_Agranular_apoptotic_aov, echo=FALSE}
APOP_PLOT_7_dead_agranular_TWO_WAY_AOV <- aov(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT)
summary(APOP_PLOT_7_dead_agranular_TWO_WAY_AOV)

APOP_PLOT_7_dead_agranular_TWO_WAY_AOV_BAD_REMOVED <- aov(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_TWO_WAY_AOV_BAD_REMOVED)
TukeyHSD(APOP_PLOT_7_dead_agranular_TWO_WAY_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED
APOP_PLOT_7_dead_agranular_INTERACTION_aov <- aov(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY*APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
summary(APOP_PLOT_7_dead_agranular_INTERACTION_aov)
TukeyHSD(APOP_PLOT_7_dead_agranular_INTERACTION_aov)

```

### One Way ANOVA of Differences between Families

```{r oneway_DEAD_Agranular_apoptotic, include=FALSE}

APOP_PLOT_7_dead_agranular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control",APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_7_dead_agranular_oneway_aov <- aov(APOP_PLOT_7_dead_agranular_hemocytes_BAD_REMOVED_CHALLENGE$Q1.UR_Arcsine ~ APOP_PLOT_7_dead_agranular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_7_dead_agranular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_7_dead_agranular_oneway_aov)
TukeyHSD(APOP_PLOT_7_dead_agranular_oneway_aov)
```

## Percent necrotic granular hemocytes (PLOT 4, Q2-UL)

## Percent Necrotic granular hemocytes (PLOT 4, Q2-UL)

```{r necrotic_apoptosis_granular, echo=FALSE}
APOP_necrotic_granular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q2.UL_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Granular Hemocytes \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

APOP_necrotic_granular_BAD_NOT_REMOVED

APOP_necrotic_granular_BAD_REMOVED <- ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q2.UL_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Granular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
APOP_necrotic_granular_BAD_REMOVED

```

### FAMILY A
```{r necrotic_granular_aov_A, echo=FALSE}

APOP_PLOT_4_necrotic_granular_FAMILY_A_AOV <- aov(APOP_PLOT_4_granular_FAMILY_A$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A$GROUP, data=APOP_PLOT_4_granular_FAMILY_A)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_A_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_A_AOV_BAD_REMOVED)      

```

### FAMILY B
```{r necrotic_granular_aov_B, echo=FALSE}

APOP_PLOT_4_necrotic_granular_FAMILY_B_AOV <- aov(APOP_PLOT_4_granular_FAMILY_B$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B$GROUP, data=APOP_PLOT_4_granular_FAMILY_B)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_B_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r necrotic_granular_aov_D, echo=FALSE}

APOP_PLOT_4_necrotic_granular_FAMILY_D_AOV <- aov(APOP_PLOT_4_granular_FAMILY_D$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D$GROUP, data=APOP_PLOT_4_granular_FAMILY_D)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_D_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E

```{r necrotic_granular_aov_E, echo=FALSE}

APOP_PLOT_4_necrotic_granular_FAMILY_E_AOV <- aov(APOP_PLOT_4_granular_FAMILY_E$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E$GROUP, data=APOP_PLOT_4_granular_FAMILY_E)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_E_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_E_AOV_BAD_REMOVED)      

```

### FAMILY J 
```{r necrotic_granular_aov_J, echo=FALSE}

APOP_PLOT_4_necrotic_granular_FAMILY_J_AOV <- aov(APOP_PLOT_4_granular_FAMILY_J$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J$GROUP, data=APOP_PLOT_4_granular_FAMILY_J)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_J_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 

```{r necrotic_granular_aov_L, echo=FALSE}

APOP_PLOT_4_necrotic_granular_FAMILY_L_AOV <- aov(APOP_PLOT_4_granular_FAMILY_L$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L$GROUP, data=APOP_PLOT_4_granular_FAMILY_L)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_L_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_L_AOV_BAD_REMOVED)      

```

### TWO WAY ANOVA

```{r necrotic_granular_aov, echo=FALSE}
APOP_PLOT_4_necrotic_granular_TWO_WAY_AOV <- aov(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UL_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT)
summary(APOP_PLOT_4_necrotic_granular_TWO_WAY_AOV)

APOP_PLOT_4_necrotic_granular_TWO_WAY_AOV_BAD_REMOVED <- aov(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_TWO_WAY_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED
APOP_PLOT_4_necrotic_granular_INTERACTION_aov <- aov(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY*APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
summary(APOP_PLOT_4_necrotic_granular_INTERACTION_aov)
TukeyHSD(APOP_PLOT_4_necrotic_granular_INTERACTION_aov)

```

### One Way ANOVA of Differences between Families

```{r necrotic_granular, include=FALSE}

APOP_PLOT_4_necrotic_granular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control",APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_4_necrotic_granular_oneway_aov <- aov(APOP_PLOT_4_necrotic_granular_hemocytes_BAD_REMOVED_CHALLENGE$Q2.UL_Arcsine ~ APOP_PLOT_4_necrotic_granular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_4_necrotic_granular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_4_necrotic_granular_oneway_aov)
TukeyHSD(APOP_PLOT_4_necrotic_granular_oneway_aov)
```

## Percent necrotic agranular hemocytes (PLOT 7, Q1-UL)


## Percent necrotic agranular hemocytes (PLOT 7, Q1-UL)
```{r necrotic_apoptotic_agranular, echo=FALSE}
APOP_necrotic_Agranular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q1.UL_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Agranular Hemocytes \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

APOP_necrotic_Agranular_BAD_NOT_REMOVED

APOP_necrotic_Agranular_BAD_REMOVED <- ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q1.UL_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Agranular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
APOP_necrotic_Agranular_BAD_REMOVED
```



### FAMILY A
```{r necrotic_agranular_aov_A, echo=FALSE}

APOP_PLOT_7_necrotic_agranular_FAMILY_A_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_A$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_A_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_A_AOV_BAD_REMOVED)      

```

### FAMILY B
```{r necrotic_agranular_aov_B, echo=FALSE}

APOP_PLOT_7_necrotic_agranular_FAMILY_B_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_B$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_B_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r necrotic_agranular_aov_D, echo=FALSE}

APOP_PLOT_7_necrotic_agranular_FAMILY_D_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_D$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_D_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E
```{r necrotic_agranular_aov_E, echo=FALSE}

APOP_PLOT_7_necrotic_agranular_FAMILY_E_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_E$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_E_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_E_AOV_BAD_REMOVED)      

```
### FAMILY J 

```{r necrotic_agranular_aov_J, echo=FALSE}

APOP_PLOT_7_necrotic_agranular_FAMILY_J_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_J$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_J_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 
```{r necrotic__agranular_aov_L, echo=FALSE}

APOP_PLOT_7_necrotic_agranular_FAMILY_L_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_L$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_L_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_L_AOV_BAD_REMOVED)      

```


### TWO WAY ANOVA
```{r necrotic_Agranular_aov, echo=FALSE}
APOP_PLOT_7_necrotic_agranular_TWO_WAY_AOV <- aov(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UL_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT)
summary(APOP_PLOT_7_necrotic_agranular_TWO_WAY_AOV)

APOP_PLOT_7_necrotic_agranular_TWO_WAY_AOV_BAD_REMOVED <- aov(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_TWO_WAY_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED  (using lm model)
APOP_PLOT_7_necrotic_agranular_INTERACTION_aov <- aov(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY*APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
summary(APOP_PLOT_7_necrotic_agranular_INTERACTION_aov)
TukeyHSD(APOP_PLOT_7_necrotic_agranular_INTERACTION_aov)

```

### One Way ANOVA of Differences between Families

```{r necrotic_Agranular, include=FALSE}

APOP_PLOT_7_necrotic_agranular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control",APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_7_necrotic_agranular_oneway_aov <- aov(APOP_PLOT_7_necrotic_agranular_hemocytes_BAD_REMOVED_CHALLENGE$Q1.UL_Arcsine ~ APOP_PLOT_7_necrotic_agranular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_7_necrotic_agranular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_7_necrotic_agranular_oneway_aov)
```


# CASPASE ASSAY DATA # 

## Load in data for each plot

```{r load, echo=TRUE}
#Load in the Data for each plot on a separate spreadsheet

CAS_P1_hemocytes <- read.csv(file="../ANALYSIS_CSVs/CASPASE_ASSAY/PLOT3.csv", header=TRUE)
CAS_PLOT4_granular_quad_plot <- read.csv(file="../ANALYSIS_CSVs/CASPASE_ASSAY/PLOT4.csv", header=TRUE)
CAS_PLOT7_agranular_quad_plot <- read.csv(file="../ANALYSIS_CSVs/CASPASE_ASSAY/PLOT7.csv", header=TRUE)
CAS_PLOT8_granular_agranular <- read.csv(file="../ANALYSIS_CSVs/CASPASE_ASSAY/PLOT8.csv", header=TRUE)
CAS_PLOT10_live_dead <- read.csv(file="../ANALYSIS_CSVs/CASPASE_ASSAY/PLOT10.csv", header=TRUE)

#Load in data tables with the extra GATE category
CAS_P1_hemocytes_GATE_ADDED <- read.csv(file="../ANALYSIS_CSVs/CASPASE_ASSAY/PLOT3_GATE_ADDED.csv", header = TRUE)
CAS_PLOT4_granular_quad_plot_GATE_ADDED <- read.csv(file="../ANALYSIS_CSVs/CASPASE_ASSAY/PLOT4_GATE_ADDED.csv", header=TRUE)
CAS_PLOT7_agranular_quad_plot_GATE_ADDED <- read.csv(file="../ANALYSIS_CSVs/CASPASE_ASSAY/PLOT7_GATE_ADDED.csv", header=TRUE)
CAS_PLOT8_granular_agranular_GATE_ADDED <- read.csv(file="../ANALYSIS_CSVs/CASPASE_ASSAY/PLOT8_GATE_ADDED.csv", header=TRUE)
CAS_PLOT10_live_dead_GATE_ADDED <- read.csv(file="../ANALYSIS_CSVs/CASPASE_ASSAY/PLOT10_GATE_ADDED.csv", header=TRUE)

# Remove rows with na's with the remove.na function from rgr
CAS_P1_hemocytes <- na.omit(CAS_P1_hemocytes)
CAS_PLOT4_granular_quad_plot <-na.omit(CAS_PLOT4_granular_quad_plot)
CAS_PLOT7_agranular_quad_plot <- na.omit(CAS_PLOT7_agranular_quad_plot)
CAS_PLOT8_granular_agranular <- na.omit(CAS_PLOT8_granular_agranular)
CAS_PLOT10_live_dead <- na.omit(CAS_PLOT10_live_dead)

CAS_P1_hemocytes_GATE_ADDED <- na.omit(CAS_P1_hemocytes_GATE_ADDED)
CAS_PLOT4_granular_quad_plot_GATE_ADDED <- na.omit(CAS_PLOT4_granular_quad_plot_GATE_ADDED)
CAS_PLOT7_agranular_quad_plot_GATE_ADDED <- na.omit(CAS_PLOT7_agranular_quad_plot_GATE_ADDED)
CAS_PLOT8_granular_agranular_GATE_ADDED <- na.omit(CAS_PLOT8_granular_agranular_GATE_ADDED)
CAS_PLOT10_live_dead_GATE_ADDED <- na.omit(CAS_PLOT10_live_dead_GATE_ADDED)

## Remove percent symbol from columns 
CAS_P1_hemocytes$P1_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_P1_hemocytes$P1_Percent_of_this_plot))
CAS_PLOT4_granular_quad_plot$Q3.UL_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT4_granular_quad_plot$Q3.UL_Percent_of_this_plot))
CAS_PLOT4_granular_quad_plot$Q3.UR_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT4_granular_quad_plot$Q3.UR_Percent_of_this_plot))
CAS_PLOT4_granular_quad_plot$Q3.LL_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT4_granular_quad_plot$Q3.LL_Percent_of_this_plot))
CAS_PLOT4_granular_quad_plot$Q3.LR_Percent_of_this_plot  <- as.numeric(gsub("\\%", "", CAS_PLOT4_granular_quad_plot$Q3.LR_Percent_of_this_plot))

CAS_PLOT7_agranular_quad_plot$Q4.UL_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT7_agranular_quad_plot$Q4.UL_Percent_of_this_plot))
CAS_PLOT7_agranular_quad_plot$Q4.UR_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT7_agranular_quad_plot$Q4.UR_Percent_of_this_plot))
CAS_PLOT7_agranular_quad_plot$Q4.LR_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT7_agranular_quad_plot$Q4.LR_Percent_of_this_plot))
CAS_PLOT7_agranular_quad_plot$Q4.LL_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT7_agranular_quad_plot$Q4.LL_Percent_of_this_plot))

CAS_PLOT8_granular_agranular$P3_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT8_granular_agranular$P3_Percent_of_this_plot))
CAS_PLOT8_granular_agranular$P4_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT8_granular_agranular$P4_Percent_of_this_plot))

CAS_PLOT10_live_dead$V2.L_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT10_live_dead$V2.L_Percent_of_this_plot))
CAS_PLOT10_live_dead$V2.R_Percent_of_this_plot <- as.numeric(gsub("\\%", "", CAS_PLOT10_live_dead$V2.R_Percent_of_this_plot))

CAS_P1_hemocytes_GATE_ADDED$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", CAS_P1_hemocytes_GATE_ADDED$PERCENT_OF_THIS_PLOT ))
CAS_PLOT4_granular_quad_plot_GATE_ADDED$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", CAS_PLOT4_granular_quad_plot_GATE_ADDED$PERCENT_OF_THIS_PLOT))
CAS_PLOT7_agranular_quad_plot_GATE_ADDED$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", CAS_PLOT7_agranular_quad_plot_GATE_ADDED$PERCENT_OF_THIS_PLOT))
CAS_PLOT8_granular_agranular_GATE_ADDED$PERCENT_OF_THIS_PLOT <-  as.numeric(gsub("\\%", "", CAS_PLOT8_granular_agranular_GATE_ADDED$PERCENT_OF_THIS_PLOT))
CAS_PLOT10_live_dead_GATE_ADDED$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", CAS_PLOT10_live_dead_GATE_ADDED$PERCENT_OF_THIS_PLOT))

# Not going to remove any samples right now due to low sample sizes to begin with


```

## Basic plots showing the data across families

## Percent LIVE Apoptotic Granular Hemocytes out of all granular hemocytes
```{r CAS_live_apoptotic_granular, echo=FALSE}
 
Percent_live_apoptotic_granular_BAD_NOT_REMOVED <- ggplot(data= CAS_PLOT4_granular_quad_plot, aes(x=FAMILY, y=Q3.LR_Percent_of_this_plot, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Caspase-dependent Apoptotic \n Granular Hemocytes Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Granular Hemocyte Events") + ylim(0,100)
Percent_live_apoptotic_granular_BAD_NOT_REMOVED

```

# LIVE Apoptotic Granular hemocytes compared to Live and Necrotic hemocytes
```{r apoptosis_granular_compared, echo=TRUE}

CAS_all_percentages_granular <- ggplot(CAS_PLOT4_granular_quad_plot_GATE_ADDED, aes(x=FAMILY, y=PERCENT_OF_THIS_PLOT, by=GATE, color=GATE, shape=GROUP)) + geom_point() + ggtitle("Percent of Granular Caspase-dependent Apoptotic, \n Necrotic, and Live Hemocytes") + ylab("Percent of Granular Hemocyte Events") 
CAS_all_percentages_granular + scale_color_manual(name="Hemocyte Status", labels=c("Live Non-Apoptotic", "Live Caspase-dependent Apoptotic", "Dead", "Necrotic"), values=c("Q3_LL"="red","Q3_LR"="green","Q3_UL"="blue", "Q3_UR"="purple"))
```

# LIVE APOPTOTIC AGRANULAR Hemocytes 


## Percent LIVE Apoptotic Aranular Hemocytes out of all Agranular hemocytes
```{r CAS_live_apoptotic_granular, echo=FALSE}
 
Percent_live_apoptotic_agranular_BAD_NOT_REMOVED <- ggplot(data=CAS_PLOT7_agranular_quad_plot, aes(x=FAMILY, y=Q4.LR_Percent_of_this_plot, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Caspase-dependent Apoptotic \n Agranular Hemocytes Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Agranular Hemocyte Events") + ylim(0,100)
Percent_live_apoptotic_agranular_BAD_NOT_REMOVED

```


# LIVE Apoptotic Agranular hemocytes compared to Live and Necrotic hemocytes
```{r apoptosis_granular_compared, echo=TRUE}

CAS_all_percentages_agranular <- ggplot(CAS_PLOT7_agranular_quad_plot_GATE_ADDED, aes(x=FAMILY, y=PERCENT_OF_THIS_PLOT, by=GATE, color=GATE, shape=GROUP)) + geom_point() + ggtitle("Percent of Agranular Caspase-dependent Apoptotic, \n Necrotic, and Live Hemocytes") + ylab("Percent of Agranular Hemocyte Events") 

CAS_all_percentages_agranular + scale_color_manual(name="Hemocyte Status", labels=c("Live Non-Apoptotic", "Live Caspase-dependent Apoptotic", "Dead", "Necrotic"), values=c("Q4_LL"="red","Q4_LR"="green","Q4_UL"="blue", "Q4_UR"="purple"))
```

# Comparing Live apoptotic cells following treatment between granular and agranular

```{r compare_granular_agranular, echo=TRUE}
CAS_live_apoptotic_granular <- CAS_PLOT4_granular_quad_plot_GATE_ADDED %>% filter(GATE=="Q3_LR")
CAS_live_apoptotic_agranular <- CAS_PLOT7_agranular_quad_plot_GATE_ADDED %>% filter(GATE=="Q4_LR")
CAS_live_apoptotic_granular_agranular <- rbind(CAS_live_apoptotic_granular,CAS_live_apoptotic_agranular)

CAS_live_apoptotic_granular_agranular_plot <- ggplot(CAS_live_apoptotic_granular_agranular, aes(x=FAMILY, y=PERCENT_OF_THIS_PLOT, by=GATE, color=GATE, shape=GROUP)) + geom_point() + ggtitle("Percent of Granular and Agranular Caspase-dependent Apoptotic Hemocytes") + ylab("Percent of Hemocyte Events in each respective quad plot") 

CAS_live_apoptotic_granular_agranular_plot + scale_color_manual(name="Hemocyte Type", labels=c("Live Caspase-dependent Apoptotic Granular", "Live Caspase-dependent Apoptotic Agranular"), values=c("Q3_LR"="red","Q4_LR"="green"))

```


# Arc sine Percentage data

```{r arcsine, echo=TRUE}

# NOTE: NA's produced whenever the percentages were above 100%
VI_PLOT2_hemocytes$Arcsine <- transf.arcsin(VI_PLOT2_hemocytes$M4_PERCENT_OF_THIS_PLOT*.01)

CAS_PLOT4_granular_quad_plot$Q3.UL_Arcsine<- transf.arcsin(CAS_PLOT4_granular_quad_plot$Q3.UL_Percent_of_this_plot*0.01)
CAS_PLOT4_granular_quad_plot$Q3.UR_Arcsine <-  transf.arcsin(CAS_PLOT4_granular_quad_plot$Q3.UR_Percent_of_this_plot*0.01)
CAS_PLOT4_granular_quad_plot$Q3.LL_Arcsine <- transf.arcsin(CAS_PLOT4_granular_quad_plot$Q3.LL_Percent_of_this_plot*0.01)
CAS_PLOT4_granular_quad_plot$Q3.LR_Arcsine  <- transf.arcsin(CAS_PLOT4_granular_quad_plot$Q3.LR_Percent_of_this_plot*0.01)

CAS_PLOT7_agranular_quad_plot$Q4.UL_Arcsine <- transf.arcsin(CAS_PLOT7_agranular_quad_plot$Q4.UL_Percent_of_this_plot*0.01)
CAS_PLOT7_agranular_quad_plot$Q4.UR_Arcsine <- transf.arcsin(CAS_PLOT7_agranular_quad_plot$Q4.UR_Percent_of_this_plot*0.01)
CAS_PLOT7_agranular_quad_plot$Q4.LR_Arcsine <- transf.arcsin(CAS_PLOT7_agranular_quad_plot$Q4.LR_Percent_of_this_plot*0.01)
CAS_PLOT7_agranular_quad_plot$Q4.LL_Arcsine <- transf.arcsin(CAS_PLOT7_agranular_quad_plot$Q4.LL_Percent_of_this_plot*0.01)

CAS_PLOT4_granular_quad_plot_GATE_ADDED$Arcsine <- transf.arcsin(CAS_PLOT4_granular_quad_plot_GATE_ADDED$PERCENT_OF_THIS_PLOT*0.01)
CAS_PLOT7_agranular_quad_plot_GATE_ADDED$Arcsine <- transf.arcsin(CAS_PLOT7_agranular_quad_plot_GATE_ADDED$PERCENT_OF_THIS_PLOT*0.01)

```

# One-Way Anova of Live Caspase-dependent Apoptotic Granular Hemocytes 

## Family A HAS NO CONTROL, cannot perform ANOVA

### Family B
```{r CAS_live_apoptotic_familyB, echo=TRUE}
CAS_live_apoptotic_granular_FamilyB <- CAS_PLOT4_granular_quad_plot %>% filter(FAMILY=="B")

CAS_live_apoptotic_granular_FamilyB_aov <- aov(CAS_live_apoptotic_granular_FamilyB$Q3.LR_Arcsine ~ CAS_live_apoptotic_granular_FamilyB$GROUP, data= CAS_live_apoptotic_granular_FamilyB)
summary(CAS_live_apoptotic_granular_FamilyB_aov)
```

### Family D
```{r CAS_live_apoptotic_familyD, echo=TRUE}
CAS_live_apoptotic_granular_FamilyD <- CAS_PLOT4_granular_quad_plot %>% filter(FAMILY=="D")

CAS_live_apoptotic_granular_FamilyD_aov <- aov(CAS_live_apoptotic_granular_FamilyD$Q3.LR_Arcsine ~ CAS_live_apoptotic_granular_FamilyD$GROUP, data= CAS_live_apoptotic_granular_FamilyD)
summary(CAS_live_apoptotic_granular_FamilyD_aov)

```

### Family E
```{r CAS_live_apoptotic_familyE, echo=TRUE}
CAS_live_apoptotic_granular_FamilyE <- CAS_PLOT4_granular_quad_plot %>% filter(FAMILY=="E")

CAS_live_apoptotic_granular_FamilyE_aov <- aov(CAS_live_apoptotic_granular_FamilyE$Q3.LR_Arcsine ~ CAS_live_apoptotic_granular_FamilyE$GROUP, data= CAS_live_apoptotic_granular_FamilyE)
summary(CAS_live_apoptotic_granular_FamilyE_aov)

```

### Family J
```{r CAS_live_apoptotic_familyJ, echo=TRUE}
CAS_live_apoptotic_granular_FamilyJ <- CAS_PLOT4_granular_quad_plot %>% filter(FAMILY=="J")

CAS_live_apoptotic_granular_FamilyJ_aov <- aov(CAS_live_apoptotic_granular_FamilyJ$Q3.LR_Arcsine ~ CAS_live_apoptotic_granular_FamilyJ$GROUP, data= CAS_live_apoptotic_granular_FamilyJ)
summary(CAS_live_apoptotic_granular_FamilyJ_aov)

```

### Family L 
```{r CAS_live_apoptotic_familyL, echo=TRUE}
CAS_live_apoptotic_granular_FamilyL <- CAS_PLOT4_granular_quad_plot %>% filter(FAMILY=="L")

CAS_live_apoptotic_granular_FamilyL_aov <- aov(CAS_live_apoptotic_granular_FamilyL$Q3.LR_Arcsine ~ CAS_live_apoptotic_granular_FamilyL$GROUP, data= CAS_live_apoptotic_granular_FamilyL)
summary(CAS_live_apoptotic_granular_FamilyL_aov)

```

# Two-Way ANOVA of Live Apoptotic Granular Hemocytes to test difference between families 
```{r CAS_twoway_aov_live_apoptotic_granular, echo=TRUE}
CAS_live_apoptotic_granular_twoway_aov <- aov(CAS_PLOT4_granular_quad_plot$Q3.LR_Arcsine ~ CAS_PLOT4_granular_quad_plot$FAMILY + CAS_PLOT4_granular_quad_plot$GROUP, data= CAS_PLOT4_granular_quad_plot)
summary(CAS_live_apoptotic_granular_twoway_aov)

# INTERACTION TERM ADDED  (using lm model)
CAS_live_apoptotic_granular_twoway_interaction_aov <- aov(CAS_PLOT4_granular_quad_plot$Q3.LR_Arcsine ~ CAS_PLOT4_granular_quad_plot$FAMILY + CAS_PLOT4_granular_quad_plot$GROUP + CAS_PLOT4_granular_quad_plot$FAMILY*CAS_PLOT4_granular_quad_plot$GROUP, data=CAS_PLOT4_granular_quad_plot)
summary(CAS_live_apoptotic_granular_twoway_interaction_aov)
```

# One-way ANOVA of Live Caspase-dependent Apoptotic Agranular Hemocytes

## Family A HAS NO CONTROL, cannot perform ANOVA

### Family B
```{r CAS_live_apoptotic_agranular_familyB, echo=TRUE}
CAS_live_apoptotic_agranular_FamilyB <- CAS_PLOT7_agranular_quad_plot %>% filter(FAMILY=="B")

CAS_live_apoptotic_agranular_FamilyB_aov <- aov(CAS_live_apoptotic_agranular_FamilyB$Q4.LR_Arcsine ~ CAS_live_apoptotic_agranular_FamilyB$GROUP, data= CAS_live_apoptotic_agranular_FamilyB)
summary(CAS_live_apoptotic_agranular_FamilyB_aov)
```

### Family D
```{r CAS_live_apoptotic_agranular_familyD, echo=TRUE}
CAS_live_apoptotic_agranular_FamilyD <- CAS_PLOT7_agranular_quad_plot %>% filter(FAMILY=="D")

CAS_live_apoptotic_agranular_FamilyD_aov <- aov(CAS_live_apoptotic_agranular_FamilyD$Q4.LR_Arcsine ~ CAS_live_apoptotic_agranular_FamilyD$GROUP, data= CAS_live_apoptotic_agranular_FamilyD)
summary(CAS_live_apoptotic_agranular_FamilyD_aov)
```

### FAMILY E
```{r CAS_live_apoptotic_agranular_familyE, echo=TRUE}
CAS_live_apoptotic_agranular_FamilyE <- CAS_PLOT7_agranular_quad_plot %>% filter(FAMILY=="E")

CAS_live_apoptotic_agranular_FamilyE_aov <- aov(CAS_live_apoptotic_agranular_FamilyE$Q4.LR_Arcsine ~ CAS_live_apoptotic_agranular_FamilyE$GROUP, data= CAS_live_apoptotic_agranular_FamilyE)
summary(CAS_live_apoptotic_agranular_FamilyE_aov)
```

### FAMILY J
```{r CAS_live_apoptotic_agranular_familyJ, echo=TRUE}
CAS_live_apoptotic_agranular_FamilyJ <- CAS_PLOT7_agranular_quad_plot %>% filter(FAMILY=="J")

CAS_live_apoptotic_agranular_FamilyJ_aov <- aov(CAS_live_apoptotic_agranular_FamilyJ$Q4.LR_Arcsine ~ CAS_live_apoptotic_agranular_FamilyJ$GROUP, data= CAS_live_apoptotic_agranular_FamilyJ)
summary(CAS_live_apoptotic_agranular_FamilyJ_aov)
```

### FAMILY L 
```{r CAS_live_apoptotic_agranular_familyL, echo=TRUE}
CAS_live_apoptotic_agranular_FamilyL <- CAS_PLOT7_agranular_quad_plot %>% filter(FAMILY=="L")

CAS_live_apoptotic_agranular_FamilyL_aov <- aov(CAS_live_apoptotic_agranular_FamilyL$Q4.LR_Arcsine ~ CAS_live_apoptotic_agranular_FamilyL$GROUP, data= CAS_live_apoptotic_agranular_FamilyL)
summary(CAS_live_apoptotic_agranular_FamilyL_aov)
```

## Two-Way ANOVA of Live Caspase dependent apoptotic agranular hemocytes

```{r CAS_live_apoptotic_agranular_twoway, echo=TRUE}
CAS_live_apoptotic_agranular_twoway_aov <- aov(CAS_PLOT7_agranular_quad_plot$Q4.LR_Arcsine ~ CAS_PLOT7_agranular_quad_plot$FAMILY + CAS_PLOT7_agranular_quad_plot$GROUP, data= CAS_PLOT7_agranular_quad_plot)
summary(CAS_live_apoptotic_agranular_twoway_aov)

# Plus interaction term
CAS_live_apoptotic_agranular_twoway_interaction_aov <- aov(CAS_PLOT7_agranular_quad_plot$Q4.LR_Arcsine ~ CAS_PLOT7_agranular_quad_plot$FAMILY + CAS_PLOT7_agranular_quad_plot$GROUP + CAS_PLOT7_agranular_quad_plot$FAMILY*CAS_PLOT7_agranular_quad_plot$GROUP, data= CAS_PLOT7_agranular_quad_plot)
summary(CAS_live_apoptotic_agranular_twoway_interaction_aov)

```

# One Way and Two-Way ANOVA of Live apoptotic granular and agranular hemocytes 
```{r CAS_live_apoptotic_agranular_agranular_twoway, echo=TRUE}
CAS_live_apoptotic_granular_agranular_oneway_aov <- aov(CAS_PLOT7_agranular_quad_plot_GATE_ADDED$Arcsine ~ CAS_PLOT7_agranular_quad_plot_GATE_ADDED$GATE, data= CAS_PLOT7_agranular_quad_plot_GATE_ADDED)
summary(CAS_live_apoptotic_granular_agranular_oneway_aov)

CAS_live_apoptotic_granular_agranular_twoway_aov <- aov(CAS_PLOT7_agranular_quad_plot_GATE_ADDED$Arcsine ~ CAS_PLOT7_agranular_quad_plot_GATE_ADDED$GATE + CAS_PLOT7_agranular_quad_plot_GATE_ADDED$GROUP, data= CAS_PLOT7_agranular_quad_plot_GATE_ADDED)
summary(CAS_live_apoptotic_granular_agranular_twoway_aov)

# Plus interaction term
CAS_live_apoptotic_granular_agranular_twoway_aov <- aov(CAS_PLOT7_agranular_quad_plot_GATE_ADDED$Arcsine ~ CAS_PLOT7_agranular_quad_plot_GATE_ADDED$GATE + CAS_PLOT7_agranular_quad_plot_GATE_ADDED$GROUP + CAS_PLOT7_agranular_quad_plot_GATE_ADDED$GATE*CAS_PLOT7_agranular_quad_plot_GATE_ADDED$GROUP, data= CAS_PLOT7_agranular_quad_plot_GATE_ADDED)
summary(CAS_live_apoptotic_granular_agranular_twoway_aov)
```


# Websites for Reference #
http://rcompanion.org/handbook/G_09.html




