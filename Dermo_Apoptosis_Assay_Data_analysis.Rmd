---
title: "Dermo Challenge Apoptosis Assay Data Analysis"
author: "Erin Roberts"
date: "8/14/2018"
output: github_document

---

## Load Packages

```{r packages, echo=TRUE}
library(ggplot2)
library(metafor)
library(dplyr)
library(car)
library(lsmeans)
library(rgr)
library(multcompView)
library(Rmisc)
library(ggpubr)
```


## APOPTOSIS ASSAY Day 7 

## Load in data for each plot

```{r load_data, echo=TRUE}
#Load in the Data for each plot on a separate spreadsheet

APOP_PLOT3_P1_GATE <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT3.csv", header=TRUE)
APOP_PLOT8_GRANULAR_AGRANULAR <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT8.csv", header=TRUE)
APOP_PLOT4_GRANULAR_QUAD_PLOT <-read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT4.csv", header=TRUE)
APOP_PLOT7_AGRANULAR_QUAD_PLOT <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT7.csv", header=TRUE)

APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT4_GATE_ADDED.csv", header=TRUE)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/PLOT7_GATE_ADDED.csv", header=TRUE)

#Remove empty rows
APOP_PLOT3_P1_GATE <- na.omit(APOP_PLOT3_P1_GATE)
APOP_PLOT8_GRANULAR_AGRANULAR <- na.omit(APOP_PLOT8_GRANULAR_AGRANULAR)
APOP_PLOT4_GRANULAR_QUAD_PLOT <- na.omit(APOP_PLOT4_GRANULAR_QUAD_PLOT)
APOP_PLOT7_AGRANULAR_QUAD_PLOT<- na.omit(APOP_PLOT7_AGRANULAR_QUAD_PLOT)

APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED <- na.omit(APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED <- na.omit(APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED)


## Remove percent symbol from columns 
APOP_PLOT3_P1_GATE$P1_PERCENT_OF_THE_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT3_P1_GATE$P1_PERCENT_OF_THE_PLOT))
APOP_PLOT8_GRANULAR_AGRANULAR$P3_PERCENT_OF_THIS_PLOT<- as.numeric(gsub("\\%", "", APOP_PLOT8_GRANULAR_AGRANULAR$P3_PERCENT_OF_THIS_PLOT))
APOP_PLOT8_GRANULAR_AGRANULAR$P4_PERCENT_OF_THIS_PLOT<- as.numeric(gsub("\\%", "", APOP_PLOT8_GRANULAR_AGRANULAR$P4_PERCENT_OF_THIS_PLOT))

APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UL_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UL_PERCENT_OF_THIS_PLOT))
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UR_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UR_PERCENT_OF_THIS_PLOT))
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LL_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LL_PERCENT_OF_THIS_PLOT))
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LR_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LR_PERCENT_OF_THIS_PLOT))

APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UL_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UL_PERCENT_OF_THIS_PLOT))
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UR_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UR_PERCENT_OF_THIS_PLOT))
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LL_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LL_PERCENT_OF_THIS_PLOT))
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LR_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LR_PERCENT_OF_THIS_PLOT))

APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT))
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT))

# Load in Data for the samples to remove 
APOPTOSIS_Samples_Remove <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY7/APOPTOSIS_SAMPLES_REMOVE.csv", header=TRUE)

# Data Frame with bad samples removed
APOP_PLOT3_P1_GATE_BAD_REMOVED <- APOP_PLOT3_P1_GATE[!APOP_PLOT3_P1_GATE$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]
APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED <- APOP_PLOT8_GRANULAR_AGRANULAR[!APOP_PLOT8_GRANULAR_AGRANULAR$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]
APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED <- APOP_PLOT4_GRANULAR_QUAD_PLOT[!APOP_PLOT4_GRANULAR_QUAD_PLOT$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]
APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED <- APOP_PLOT7_AGRANULAR_QUAD_PLOT[!APOP_PLOT7_AGRANULAR_QUAD_PLOT$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]
APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED <- APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED[!APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED[!APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED$SAMPLE_ID %in% APOPTOSIS_Samples_Remove$SAMPLE_ID, , drop=FALSE]

```

# Arc sine Percentage data
```{r apop_arcsine_percentages, echo=TRUE}
# NOTE: NA's produced whenever the percentages were above 100%
APOP_PLOT3_P1_GATE$Arcsine<- transf.arcsin(APOP_PLOT3_P1_GATE$P1_PERCENT_OF_THE_PLOT*0.01)
APOP_PLOT8_GRANULAR_AGRANULAR$P3_Arcsine <- transf.arcsin(APOP_PLOT8_GRANULAR_AGRANULAR$P3_PERCENT_OF_THIS_PLOT *0.01)
APOP_PLOT8_GRANULAR_AGRANULAR$P4_Arcsine <- transf.arcsin(APOP_PLOT8_GRANULAR_AGRANULAR$P4_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UL_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UR_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UR_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LL_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LR_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LR_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UL_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UR_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UR_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LL_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LR_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LR_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED$Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED$Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED$PERCENT_OF_THIS_PLOT*0.01)

# NOTE: NA's produced whenever the percentages were above 100%
APOP_PLOT3_P1_GATE_BAD_REMOVED$Arcsine<- transf.arcsin(APOP_PLOT3_P1_GATE_BAD_REMOVED$P1_PERCENT_OF_THE_PLOT*0.01)
APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P3_Arcsine <- transf.arcsin(APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P3_PERCENT_OF_THIS_PLOT *0.01)
APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P4_Arcsine <- transf.arcsin(APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P4_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UL_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UR_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UR_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LL_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LR_Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LR_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UL_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UR_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UR_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LL_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LL_PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LR_Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LR_PERCENT_OF_THIS_PLOT*0.01)

APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED$Arcsine <- transf.arcsin(APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED$PERCENT_OF_THIS_PLOT*0.01)
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED$Arcsine <- transf.arcsin(APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED$PERCENT_OF_THIS_PLOT*0.01)
```

# % LIVE apoptotic granular hemocytes (PLOT4, Q2-LR)

## Percent LIVE apoptotic granular hemocytes (PLOT4, Q2-LR)
```{r LIVE_apoptotic_Granula_plot4, include=TRUE, echo=TRUE}
 
APOP_live_apoptotic_granular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q2.LR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Granular Hemocytes \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
ggsave(filename = "./Figures/APOP_live_apoptotic_granular_BAD_NOT_REMOVED.png",plot=APOP_live_apoptotic_granular_BAD_NOT_REMOVED)
```
![Percent of Live Apoptotic Granular Hemocytes Low Quality Not Removed](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/APOP_live_apoptotic_granular_BAD_NOT_REMOVED.png)

```{r LIVE_apoptotic_Granula_plot4_part2,echo=TRUE}
APOP_live_apoptotic_granular_BAD_REMOVED <- ggplot(data= APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q2.LR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Granular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
ggsave(filename="./Figures/APOP_live_apoptotic_granular_BAD_REMOVED.png",plot=APOP_live_apoptotic_granular_BAD_REMOVED)
```
![Percent of Live Apoptotic Granular Hemocytes Low Quality Removed](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/APOP_live_apoptotic_granular_BAD_REMOVED.png)

### FAMILY A

```{r live_apoptotic_granular_aov_A, echo=TRUE}
APOP_PLOT_4_granular_FAMILY_A <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="A")

APOP_PLOT_4_granular_FAMILY_A_AOV <- aov(APOP_PLOT_4_granular_FAMILY_A$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A$GROUP, data=APOP_PLOT_4_granular_FAMILY_A)
summary(APOP_PLOT_4_granular_FAMILY_A_AOV)

APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="A")
APOP_PLOT_4_granular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_A_AOV_BAD_REMOVED)      
        
```


### FAMILY B
```{r live_apoptotic_granular_aov_B, echo=TRUE}
APOP_PLOT_4_granular_FAMILY_B <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="B")

APOP_PLOT_4_granular_FAMILY_B_AOV <- aov(APOP_PLOT_4_granular_FAMILY_B$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B$GROUP, data=APOP_PLOT_4_granular_FAMILY_B)
summary(APOP_PLOT_4_granular_FAMILY_B_AOV)

APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="B")
APOP_PLOT_4_granular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r live_apoptotic_granular_aov_D, echo=TRUE}
APOP_PLOT_4_granular_FAMILY_D <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="D")

APOP_PLOT_4_granular_FAMILY_D_AOV <- aov(APOP_PLOT_4_granular_FAMILY_D$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D$GROUP, data=APOP_PLOT_4_granular_FAMILY_D)
summary(APOP_PLOT_4_granular_FAMILY_D_AOV)

APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="D")
APOP_PLOT_4_granular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E

```{r live_apoptotic_granular_aov_E, echo=TRUE}
APOP_PLOT_4_granular_FAMILY_E <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="E")

APOP_PLOT_4_granular_FAMILY_E_AOV <- aov(APOP_PLOT_4_granular_FAMILY_E$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E$GROUP, data=APOP_PLOT_4_granular_FAMILY_E)
summary(APOP_PLOT_4_granular_FAMILY_E_AOV)

APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="E")
APOP_PLOT_4_granular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_E_AOV_BAD_REMOVED)      

```

### FAMILY J 
```{r live_apoptotic_granular_aov_J, echo=TRUE}
APOP_PLOT_4_granular_FAMILY_J <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="J")

APOP_PLOT_4_granular_FAMILY_J_AOV <- aov(APOP_PLOT_4_granular_FAMILY_J$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J$GROUP, data=APOP_PLOT_4_granular_FAMILY_J)
summary(APOP_PLOT_4_granular_FAMILY_J_AOV)

APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="J")
APOP_PLOT_4_granular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 
```{r live_apoptotic_granular_aov_L, echo=TRUE}
APOP_PLOT_4_granular_FAMILY_L <- APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(FAMILY=="L")

APOP_PLOT_4_granular_FAMILY_L_AOV <- aov(APOP_PLOT_4_granular_FAMILY_L$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L$GROUP, data=APOP_PLOT_4_granular_FAMILY_L)
summary(APOP_PLOT_4_granular_FAMILY_L_AOV)

APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED <-  APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="L")
APOP_PLOT_4_granular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_4_granular_FAMILY_L_AOV_BAD_REMOVED)      

```

### TWO WAY ANOVA of granular apoptotic 
```{r live_granular_apoptotic_aov, echo=TRUE}
APOP_PLOT_4_granular_TWO_WAY_AOV <- lm(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.LR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT)
Anova(APOP_PLOT_4_granular_TWO_WAY_AOV, type="II") 
summary(APOP_PLOT_4_granular_TWO_WAY_AOV) #produces the overall p-value and r squared
#checking model assumptions, should be approximately normally distributed
hist(residuals(APOP_PLOT_4_granular_TWO_WAY_AOV))

# Bad samples removed 
APOP_PLOT_4_granular_TWO_WAY_AOV_BAD_REMOVED <- lm(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED)
Anova(APOP_PLOT_4_granular_TWO_WAY_AOV_BAD_REMOVED, type="II")
summary(APOP_PLOT_4_granular_TWO_WAY_AOV_BAD_REMOVED)
#checking model assumptions
hist(residuals(APOP_PLOT_4_granular_TWO_WAY_AOV_BAD_REMOVED))

# INTERACTION TERM ADDED  (using lm model)
APOP_PLOT_4_granular_hemocytes_INTERACTION_aov <- lm(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY:APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
Anova(APOP_PLOT_4_granular_hemocytes_INTERACTION_aov, type="II") # effect of Family is significant, but interaction and group are not
summary(APOP_PLOT_4_granular_hemocytes_INTERACTION_aov)

# Mean separation for main factor with lsmeans
lsmeans = lsmeans::lsmeans
APOP_PLOT_4_granular_hemocytes_INTERACTION_leastsquare <- lsmeans(APOP_PLOT_4_granular_hemocytes_INTERACTION_aov, "APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY", adjust="tukey")
cld(APOP_PLOT_4_granular_hemocytes_INTERACTION_leastsquare, alpha=0.05, Letters=letters)

```

### One Way ANOVA of Differences between Families

```{r oneway_apoptotic-granular, echo=TRUE}

APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control", APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_4_granular_hemocytes_oneway_aov <- aov(APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE$Q2.LR_Arcsine ~ APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_4_granular_hemocytes_oneway_aov)
TukeyHSD(APOP_PLOT_4_granular_hemocytes_oneway_aov)
```

# % LIVE apoptotic agranular hemocytes (PLOT 7, Q1-LR)

## Percent LIVE apoptotic agranular hemocytes (PLOT7, Q1-LR)

```{r live_apoptotic_agranular, echo=TRUE}

APOP_live_apoptotic_Agranular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q1.LR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Agranular Hemocytes \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

ggsave(filename="./Figures/APOP_live_apoptotic_Agranular_BAD_NOT_REMOVED.png",plot=APOP_live_apoptotic_Agranular_BAD_NOT_REMOVED)
```
![APOP_live_apoptotic_Agranular_BAD_NOT_REMOVED](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/APOP_live_apoptotic_Agranular_BAD_NOT_REMOVED.png)

```{r live_apoptotic_agranular_bad_removed, echo=TRUE}
APOP_live_apoptotic_Agranular_BAD_REMOVED <- ggplot(data= APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q1.LR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Agranular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
ggsave(filename="./Figures/APOP_live_apoptotic_Agranular_BAD_REMOVED.png",plot=APOP_live_apoptotic_Agranular_BAD_NOT_REMOVED)

```
![Percent of Live Apoptotic Agranular Hemocytes Low Quality Removed](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/APOP_live_apoptotic_Agranular_BAD_REMOVED.png)

### FAMILY A
```{r live_apoptotic_agranular_aov_A, echo=TRUE}
APOP_PLOT_7_agranular_FAMILY_A <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="A")

APOP_PLOT_7_agranular_FAMILY_A_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_A$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A)
summary(APOP_PLOT_7_agranular_FAMILY_A_AOV)

APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="A")
APOP_PLOT_7_agranular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_A_AOV_BAD_REMOVED)      

```

### FAMILY B

```{r live_apoptotic_agranular_aov_B, echo=FALSE}
APOP_PLOT_7_agranular_FAMILY_B <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="B")

APOP_PLOT_7_agranular_FAMILY_B_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_B$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B)
summary(APOP_PLOT_7_agranular_FAMILY_B_AOV)

APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="B")
APOP_PLOT_7_agranular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r live_apoptotic_agranular_aov_D, echo=TRUE}
APOP_PLOT_7_agranular_FAMILY_D <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="D")

APOP_PLOT_7_agranular_FAMILY_D_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_D$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D)
summary(APOP_PLOT_7_agranular_FAMILY_D_AOV)

APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="D")
APOP_PLOT_7_agranular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E

```{r live_apoptotic_agranular_aov_E, echo=TRUE}
APOP_PLOT_7_agranular_FAMILY_E <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="E")

APOP_PLOT_7_agranular_FAMILY_E_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_E$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E)
summary(APOP_PLOT_7_agranular_FAMILY_E_AOV)

APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="E")
APOP_PLOT_7_agranular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_E_AOV_BAD_REMOVED)      

```

### FAMILY J 
```{r live_apoptotic_agranular_aov_J, echo=TRUE}
APOP_PLOT_7_agranular_FAMILY_J <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="J")

APOP_PLOT_7_agranular_FAMILY_J_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_J$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J)
summary(APOP_PLOT_7_agranular_FAMILY_J_AOV)

APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="J")
APOP_PLOT_7_agranular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 

```{r live_apoptotic_agranular_aov_L, echo=TRUE}
APOP_PLOT_7_agranular_FAMILY_L <- APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(FAMILY=="L")

APOP_PLOT_7_agranular_FAMILY_L_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_L$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L)
summary(APOP_PLOT_7_agranular_FAMILY_L_AOV)

APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED <-  APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(FAMILY=="L")
APOP_PLOT_7_agranular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_7_agranular_FAMILY_L_AOV_BAD_REMOVED)      

```

### TWO WAY ANOVA 

```{r live_Agranular_apoptotic_aov, echo=TRUE}
APOP_PLOT_7_agranular_TWO_WAY_AOV <- lm(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.LR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT)
Anova(APOP_PLOT_7_agranular_TWO_WAY_AOV, type="II") #significant family effect
summary(APOP_PLOT_7_agranular_TWO_WAY_AOV) # p-value overall is significant

APOP_PLOT_7_agranular_TWO_WAY_AOV_BAD_REMOVED <- lm(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED)
Anova(APOP_PLOT_7_agranular_TWO_WAY_AOV_BAD_REMOVED, type="II") # effect of family is significant
summary(APOP_PLOT_7_agranular_TWO_WAY_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED
APOP_PLOT_7_agranular_INTERACTION_aov <- lm(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY:APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
Anova(APOP_PLOT_7_agranular_INTERACTION_aov, type="II") #family is significant, but the interaction and group are not
summary(APOP_PLOT_7_agranular_INTERACTION_aov)
APOP_PLOT_7_agranular_INTERACTION_aov_lsmeans<- lsmeans(APOP_PLOT_7_agranular_INTERACTION_aov, "APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY", adjust="tukey")
cld(APOP_PLOT_7_agranular_INTERACTION_aov_lsmeans, alpha=0.05, Letters=letters) #each family is different from one another
APOP_PLOT_7_agranular_INTERACTION_aov_lsmeans_group <- lsmeans(APOP_PLOT_7_agranular_INTERACTION_aov, "APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP", adjust="tukey")
cld(APOP_PLOT_7_agranular_INTERACTION_aov_lsmeans_group, alpha=0.05, Letters=letters) #control and treatment are also different
```

### One Way ANOVA of Differences between Families

```{r oneway_apoptotic-agranular, include=FALSE}
APOP_PLOT_7_agranular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control", APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_7_agranular_oneway_aov <- aov(APOP_PLOT_7_agranular_hemocytes_BAD_REMOVED_CHALLENGE$Q1.LR_Arcsine ~ APOP_PLOT_7_agranular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_7_agranular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_7_agranular_oneway_aov)

```

## % LIVE apoptotic granular and agranular hemocytes

```{r combined, echo=TRUE}
# Graphing
agranular_live_apoptotic_all <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED %>% filter(GATE=="Q1_LR")
granular_live_apoptotic_all <- APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED %>% filter(GATE=="Q2_LR")
APOP_Live_apoptotic_combined_all <- rbind(agranular_live_apoptotic_all,granular_live_apoptotic_all)

ggplot(APOP_Live_apoptotic_combined_all, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + facet_grid(.~FAMILY+GROUP, scales="free") + geom_boxplot() + ggtitle("Percent of Granular and Agranular Live Apoptotic Hemocytes (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + scale_fill_manual(name="Hemocyte Type", labels=c("Live Apoptotic Agranular", "Live Apoptotic Granular"), values=c("Q2_LR"="#99a765","Q1_LR"="#96578a")) 

# Graph for abstract
ggplot(APOP_Live_apoptotic_combined_all, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + facet_grid(.~FAMILY+GROUP, scales="free") + theme(strip.text = element_text(size=15), axis.text = element_text(size=15, face="bold"), axis.title = element_text(size=15, face="bold"), plot.title = element_text(size=20, face="bold"),legend.text = element_text(size=15, face="bold"), legend.title = element_text(size=15, face="bold")) + geom_boxplot() + ggtitle("Percent of Granular and Agranular Live Apoptotic Hemocytes at Day 7 Post-Challenge") + ylab("Percent of Hemocyte Events") + scale_fill_manual(name="Hemocyte Type", labels=c("Live Apoptotic Agranular", "Live Apoptotic Granular"), values=c("Q2_LR"="black","Q1_LR"="grey"))


# Two-Way ANOVA
APOP_Live_apoptotic_combined_all_aov <- lm(APOP_Live_apoptotic_combined_all$Arcsine ~ APOP_Live_apoptotic_combined_all$FAMILY + APOP_Live_apoptotic_combined_all$GATE, data=APOP_Live_apoptotic_combined_all)
Anova(APOP_Live_apoptotic_combined_all_aov, type="II") #family and GATE significantly different
summary(APOP_Live_apoptotic_combined_all_aov)
hist(residuals(APOP_Live_apoptotic_combined_all_aov))

# Two-Way ANOVA with interaction 
APOP_Live_apoptotic_combined_all_aov_interaction <- lm(Arcsine ~ FAMILY + GATE + FAMILY:GATE, data=APOP_Live_apoptotic_combined_all)
Anova(APOP_Live_apoptotic_combined_all_aov_interaction, type="II") #family and GATE are significntly different
summary(APOP_Live_apoptotic_combined_all_aov_interaction)
hist(residuals(APOP_Live_apoptotic_combined_all_aov_interaction))

APOP_Live_apoptotic_combined_all_aov_interaction_leastsquare <- lsmeans(APOP_Live_apoptotic_combined_all_aov_interaction, "FAMILY",adjust="tukey")
cld(APOP_Live_apoptotic_combined_all_aov_interaction_leastsquare, alpha=0.05, Letters=letters)
APOP_Live_apoptotic_combined_all_aov_interaction_leastsquare_gate <- lsmeans(APOP_Live_apoptotic_combined_all_aov_interaction, "GATE",adjust="tukey")
cld(APOP_Live_apoptotic_combined_all_aov_interaction_leastsquare_gate, alpha=0.05, Letters=letters) #the two gates are significantly different 

```

## % DEAD apoptotic granular hemocytes (PLOT4, Q2-UR)

## Percent DEAD apoptotic granular hemocytes (PLOT4, Q1-UR)

```{r dead_apoptotic_granular, echo=TRUE}
APOP_dead_apoptotic_granular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q2.UR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Granular Hemocytes \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

APOP_dead_apoptotic_granular_BAD_NOT_REMOVED

APOP_dead_apoptotic_granular_BAD_REMOVED <- ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q2.UR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Granular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
APOP_dead_apoptotic_granular_BAD_REMOVED

```


### FAMILY A
```{r dead_apoptotic_granular_aov_A, echo=TRUE}

APOP_PLOT_4_dead_granular_FAMILY_A_AOV <- aov(APOP_PLOT_4_granular_FAMILY_A$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A$GROUP, data=APOP_PLOT_4_granular_FAMILY_A)
summary(APOP_PLOT_4_dead_granular_FAMILY_A_AOV)

APOP_PLOT_4_dead_granular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_A_AOV_BAD_REMOVED)      

```

### FAMILY B
```{r dead_apoptotic_granular_aov_B, echo=TRUE}

APOP_PLOT_4_dead_granular_FAMILY_B_AOV <- aov(APOP_PLOT_4_granular_FAMILY_B$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B$GROUP, data=APOP_PLOT_4_granular_FAMILY_B)
summary(APOP_PLOT_4_dead_granular_FAMILY_B_AOV)

APOP_PLOT_4_dead_granular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r dead_apoptotic_granular_aov_D, echo=TRUE}

APOP_PLOT_4_dead_granular_FAMILY_D_AOV <- aov(APOP_PLOT_4_granular_FAMILY_D$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D$GROUP, data=APOP_PLOT_4_granular_FAMILY_D)
summary(APOP_PLOT_4_dead_granular_FAMILY_D_AOV)

APOP_PLOT_4_dead_granular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E

```{r dead_apoptotic_granular_aov_E, echo=TRUE}

APOP_PLOT_4_dead_granular_FAMILY_E_AOV <- aov(APOP_PLOT_4_granular_FAMILY_E$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E$GROUP, data=APOP_PLOT_4_granular_FAMILY_E)
summary(APOP_PLOT_4_dead_granular_FAMILY_E_AOV)

APOP_PLOT_4_dead_granular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_E_AOV_BAD_REMOVED)      

```

### FAMILY J 

```{r dead_apoptotic_granular_aov_J, echo=TRUE}

APOP_PLOT_4_dead_granular_FAMILY_J_AOV <- aov(APOP_PLOT_4_granular_FAMILY_J$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J$GROUP, data=APOP_PLOT_4_granular_FAMILY_J)
summary(APOP_PLOT_4_dead_granular_FAMILY_J_AOV)

APOP_PLOT_4_dead_granular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 
```{r dead_apoptotic_granular_aov_L, echo=TRUE}

APOP_PLOT_4_dead_granular_FAMILY_L_AOV <- aov(APOP_PLOT_4_granular_FAMILY_L$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L$GROUP, data=APOP_PLOT_4_granular_FAMILY_L)
summary(APOP_PLOT_4_dead_granular_FAMILY_L_AOV)

APOP_PLOT_4_dead_granular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_4_dead_granular_FAMILY_L_AOV_BAD_REMOVED)      

```

### TWO WAY ANOVA

```{r DEAD_granular_apoptotic_aov, echo=TRUE}
APOP_PLOT_4_dead_granular_TWO_WAY_AOV <- lm(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT)
Anova(APOP_PLOT_4_dead_granular_TWO_WAY_AOV, type="II")
summary(APOP_PLOT_4_dead_granular_TWO_WAY_AOV)

APOP_PLOT_4_dead_granular_TWO_WAY_AOV_BAD_REMOVED <- lm(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED)
Anova(APOP_PLOT_4_dead_granular_TWO_WAY_AOV_BAD_REMOVED, type="II")
summary(APOP_PLOT_4_dead_granular_TWO_WAY_AOV_BAD_REMOVED)

# INTERACTION TERM ADDED  (using lm model)
APOP_PLOT_4_dead_granular_INTERACTION_aov <- lm(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UR_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY:APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
Anova(APOP_PLOT_4_dead_granular_INTERACTION_aov, type="II") # family is significant 
summary(APOP_PLOT_4_dead_granular_INTERACTION_aov)

APOP_PLOT_4_dead_granular_INTERACTION_aov_leastsquares <- lsmeans(APOP_PLOT_4_dead_granular_INTERACTION_aov, "APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY", adjust="tukey")
cld(APOP_PLOT_4_dead_granular_INTERACTION_aov_leastsquares, alpha=0.05, Letters=letters) #each is significantly different 
```

### One Way ANOVA of Differences between Families

```{r oneway_DEAD_granular_apoptotic, include=FALSE}

APOP_PLOT_4_dead_granular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control",APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_4_dead_granular_oneway_aov <- aov(APOP_PLOT_4_dead_granular_hemocytes_BAD_REMOVED_CHALLENGE$Q2.UR_Arcsine ~ APOP_PLOT_4_dead_granular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_4_dead_granular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_4_dead_granular_oneway_aov)
TukeyHSD(APOP_PLOT_4_dead_granular_oneway_aov)
```


## % DEAD apoptotic agranular hemocytes (PLOT 7, Q1-UR)

## Percent DEAD apoptotic agranular hemocytes (PLOT 7, Q1-UR)

```{r dead apoptotic_agranular, echo=TRUE}

APOP_dead_apoptotic_Agranular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q1.UR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Agranular Hemocytes \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

APOP_dead_apoptotic_Agranular_BAD_NOT_REMOVED

APOP_dead_apoptotic_Agranular_BAD_REMOVED <- ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q1.UR_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Agranular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
APOP_dead_apoptotic_Agranular_BAD_REMOVED

```


### FAMILY A
```{r dead_apoptotic_agranular_aov_A, echo=TRUE}

APOP_PLOT_7_dead_agranular_FAMILY_A_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_A$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A)
summary(APOP_PLOT_7_dead_agranular_FAMILY_A_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_A_AOV_BAD_REMOVED)      

```

### FAMILY B
```{r dead_apoptotic_agranular_aov_B, echo=TRUE}

APOP_PLOT_7_dead_agranular_FAMILY_B_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_B$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B)
summary(APOP_PLOT_7_dead_agranular_FAMILY_B_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r dead_apoptotic_agranular_aov_D, echo=TRUE}

APOP_PLOT_7_dead_agranular_FAMILY_D_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_D$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D)
summary(APOP_PLOT_7_dead_agranular_FAMILY_D_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E
```{r dead_apoptotic_agranular_aov_E, echo=TRUE}

APOP_PLOT_7_dead_agranular_FAMILY_E_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_E$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E)
summary(APOP_PLOT_7_dead_agranular_FAMILY_E_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_E_AOV_BAD_REMOVED)      

```

### FAMILY J 

```{r dead_apoptotic_agranular_aov_J, echo=TRUE}

APOP_PLOT_7_dead_agranular_FAMILY_J_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_J$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J)
summary(APOP_PLOT_7_dead_agranular_FAMILY_J_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 
```{r dead_apoptotic_agranular_aov_L, echo=TRUE}

APOP_PLOT_7_dead_agranular_FAMILY_L_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_L$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L)
summary(APOP_PLOT_7_dead_agranular_FAMILY_L_AOV)

APOP_PLOT_7_dead_agranular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_7_dead_agranular_FAMILY_L_AOV_BAD_REMOVED)      

```

### TWO WAY ANOVA

```{r DEAD_Agranular_apoptotic_aov, echo=TRUE}
APOP_PLOT_7_dead_agranular_TWO_WAY_AOV <- lm(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT)
Anova(APOP_PLOT_7_dead_agranular_TWO_WAY_AOV, type="II")
summary(APOP_PLOT_7_dead_agranular_TWO_WAY_AOV)

APOP_PLOT_7_dead_agranular_TWO_WAY_AOV_BAD_REMOVED <- lm(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED)
Anova(APOP_PLOT_7_dead_agranular_TWO_WAY_AOV_BAD_REMOVED,type="II")
summary(APOP_PLOT_7_dead_agranular_TWO_WAY_AOV_BAD_REMOVED) 

# INTERACTION TERM ADDED
APOP_PLOT_7_dead_agranular_INTERACTION_aov <- lm(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UR_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY*APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
Anova(APOP_PLOT_7_dead_agranular_INTERACTION_aov, type="II") #family is significant
summary(APOP_PLOT_7_dead_agranular_INTERACTION_aov)

APOP_PLOT_7_dead_agranular_INTERACTION_aov_leastsquares <- lsmeans(APOP_PLOT_7_dead_agranular_INTERACTION_aov, "APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY", adjust="tukey")
cld(APOP_PLOT_7_dead_agranular_INTERACTION_aov_leastsquares, alpha=0.05, Letters=letters)
#each family is significantly different
```

### One Way ANOVA of Differences between Families

```{r oneway_DEAD_Agranular_apoptotic, echo=TRUE}

APOP_PLOT_7_dead_agranular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control",APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_7_dead_agranular_oneway_aov <- aov(APOP_PLOT_7_dead_agranular_hemocytes_BAD_REMOVED_CHALLENGE$Q1.UR_Arcsine ~ APOP_PLOT_7_dead_agranular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_7_dead_agranular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_7_dead_agranular_oneway_aov)
TukeyHSD(APOP_PLOT_7_dead_agranular_oneway_aov)
```

## Percent Dead Apoptotic Granular and Agranular Hemocytes

```{r dead_apoptotic_granular_agranular, echo=TRUE}
dead_apoptotic_granular <- APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED %>% filter(GATE=="Q2_UR") 
dead_apoptotic_agranular <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED %>% filter(GATE=="Q1_UR")
combined_dead_apoptotic_agranular_granular <- rbind(dead_apoptotic_granular, dead_apoptotic_agranular)

ggplot(combined_dead_apoptotic_agranular_granular, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + geom_boxplot() + ggtitle("Percent of Granular and Agranular Dead Apoptotic Hemocytes (low quality removed)") +
  ylab("Percent of Hemocyte Events in each quad plot") + scale_fill_manual(name="Hemocyte Type", labels=c("Dead Apoptotic Granular", "Dead Apoptotic Agranular"), values=c("Q2_UR"="#99a765","Q1_UR"="#96578a")) + facet_grid(.~FAMILY+GROUP, scales="free")

# Two-Way ANOVA
combined_dead_apoptotic_agranular_granular_aov <- lm(combined_dead_apoptotic_agranular_granular$Arcsine ~ combined_dead_apoptotic_agranular_granular$FAMILY + combined_dead_apoptotic_agranular_granular$GATE, data=combined_dead_apoptotic_agranular_granular) # both family and gate are very significant
Anova(combined_dead_apoptotic_agranular_granular_aov, type="II")
summary(combined_dead_apoptotic_agranular_granular_aov)

#Two-Way ANOVA plus an interaction 
combined_dead_apoptotic_agranular_granular_aov_interaction <- lm(combined_dead_apoptotic_agranular_granular$Arcsine ~ combined_dead_apoptotic_agranular_granular$FAMILY + combined_dead_apoptotic_agranular_granular$GATE + combined_dead_apoptotic_agranular_granular$FAMILY:combined_dead_apoptotic_agranular_granular$GATE, data=combined_dead_apoptotic_agranular_granular)
Anova(combined_dead_apoptotic_agranular_granular_aov_interaction, type="II") #Gate and family are significant
summary(combined_dead_apoptotic_agranular_granular_aov_interaction)

combined_dead_apoptotic_agranular_granular_aov_interaction_leastsquares <- lsmeans(combined_dead_apoptotic_agranular_granular_aov_interaction, "combined_dead_apoptotic_agranular_granular$FAMILY", adjust = "tukey")
cld(combined_dead_apoptotic_agranular_granular_aov_interaction_leastsquares, alpha=0.05, Letters=letters) #indicates significant differences between families
combined_dead_apoptotic_agranular_granular_aov_interaction_leastsquares_gate <- lsmeans(combined_dead_apoptotic_agranular_granular_aov_interaction, "combined_dead_apoptotic_agranular_granular$GATE", adjust = "tukey")
cld(combined_dead_apoptotic_agranular_granular_aov_interaction_leastsquares_gate,  alpha=0.05, Letters=letters) 

```

## Percent necrotic granular hemocytes (PLOT 4, Q2-UL)

## Percent Necrotic granular hemocytes (PLOT 4, Q2-UL)

```{r necrotic_apoptosis_granular, echo=TRUE}
APOP_necrotic_granular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q2.UL_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Granular Hemocytes \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

APOP_necrotic_granular_BAD_NOT_REMOVED

APOP_necrotic_granular_BAD_REMOVED <- ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q2.UL_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Granular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
APOP_necrotic_granular_BAD_REMOVED

```

### FAMILY A
```{r necrotic_granular_aov_A, echo=TRUE}

APOP_PLOT_4_necrotic_granular_FAMILY_A_AOV <- aov(APOP_PLOT_4_granular_FAMILY_A$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A$GROUP, data=APOP_PLOT_4_granular_FAMILY_A)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_A_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_A_AOV_BAD_REMOVED)      

```

### FAMILY B
```{r necrotic_granular_aov_B, echo=TRUE}

APOP_PLOT_4_necrotic_granular_FAMILY_B_AOV <- aov(APOP_PLOT_4_granular_FAMILY_B$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B$GROUP, data=APOP_PLOT_4_granular_FAMILY_B)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_B_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r necrotic_granular_aov_D, echo=TRUE}

APOP_PLOT_4_necrotic_granular_FAMILY_D_AOV <- aov(APOP_PLOT_4_granular_FAMILY_D$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D$GROUP, data=APOP_PLOT_4_granular_FAMILY_D)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_D_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E

```{r necrotic_granular_aov_E, echo=TRUE}

APOP_PLOT_4_necrotic_granular_FAMILY_E_AOV <- aov(APOP_PLOT_4_granular_FAMILY_E$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E$GROUP, data=APOP_PLOT_4_granular_FAMILY_E)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_E_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_E_AOV_BAD_REMOVED)      

```

### FAMILY J 
```{r necrotic_granular_aov_J, echo=TRUE}

APOP_PLOT_4_necrotic_granular_FAMILY_J_AOV <- aov(APOP_PLOT_4_granular_FAMILY_J$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J$GROUP, data=APOP_PLOT_4_granular_FAMILY_J)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_J_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 

```{r necrotic_granular_aov_L, echo=TRUE}

APOP_PLOT_4_necrotic_granular_FAMILY_L_AOV <- aov(APOP_PLOT_4_granular_FAMILY_L$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L$GROUP, data=APOP_PLOT_4_granular_FAMILY_L)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_L_AOV)

APOP_PLOT_4_necrotic_granular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_4_necrotic_granular_FAMILY_L_AOV_BAD_REMOVED)      

```

### TWO WAY ANOVA

```{r necrotic_granular_aov, echo=TRUE}
APOP_PLOT_4_necrotic_granular_TWO_WAY_AOV <- lm(APOP_PLOT4_GRANULAR_QUAD_PLOT$Q2.UL_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT)
Anova(APOP_PLOT_4_necrotic_granular_TWO_WAY_AOV, type="II")
summary(APOP_PLOT_4_necrotic_granular_TWO_WAY_AOV) #nothing significant

# INTERACTION TERM ADDED
APOP_PLOT_4_necrotic_granular_INTERACTION_aov <- lm(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.UL_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY:APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP)
Anova(APOP_PLOT_4_necrotic_granular_INTERACTION_aov, type="II") #the interaction term is significant
summary(APOP_PLOT_4_necrotic_granular_INTERACTION_aov)

#mean separations for the interaction effect with lsmeans
APOP_PLOT_4_necrotic_granular_INTERACTION_aov_leastsquares <- lsmeans(APOP_PLOT_4_necrotic_granular_INTERACTION_aov, pairwise ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY:APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP,adjust="tukey")
cld(APOP_PLOT_4_necrotic_granular_INTERACTION_aov_leastsquares, alpha=0.05, Letters=letters) #groups are not significantly different

```

### One Way ANOVA of Differences between Families

```{r necrotic_granular, echo=TRUE}

APOP_PLOT_4_necrotic_granular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control",APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_4_necrotic_granular_oneway_aov <- aov(APOP_PLOT_4_necrotic_granular_hemocytes_BAD_REMOVED_CHALLENGE$Q2.UL_Arcsine ~ APOP_PLOT_4_necrotic_granular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_4_necrotic_granular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_4_necrotic_granular_oneway_aov)
TukeyHSD(APOP_PLOT_4_necrotic_granular_oneway_aov)
```


## Percent necrotic agranular hemocytes (PLOT 7, Q1-UL)


## Percent necrotic agranular hemocytes (PLOT 7, Q1-UL)
```{r necrotic_apoptotic_agranular, echo=TRUE}
APOP_necrotic_Agranular_BAD_NOT_REMOVED <- ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT, aes(x=FAMILY, y=Q1.UL_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Agranular Hemocytes \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)

APOP_necrotic_Agranular_BAD_NOT_REMOVED

APOP_necrotic_Agranular_BAD_REMOVED <- ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q1.UL_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Agranular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
APOP_necrotic_Agranular_BAD_REMOVED
```



### FAMILY A
```{r necrotic_agranular_aov_A, echo=TRUE}

APOP_PLOT_7_necrotic_agranular_FAMILY_A_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_A$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_A_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_A_AOV_BAD_REMOVED)      

```

### FAMILY B
```{r necrotic_agranular_aov_B, echo=TRUE}

APOP_PLOT_7_necrotic_agranular_FAMILY_B_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_B$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_B_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_B_AOV_BAD_REMOVED)      

```

### FAMILY D
```{r necrotic_agranular_aov_D, echo=TRUE}

APOP_PLOT_7_necrotic_agranular_FAMILY_D_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_D$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_D_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_D_AOV_BAD_REMOVED)      

```

### FAMILY E
```{r necrotic_agranular_aov_E, echo=TRUE}

APOP_PLOT_7_necrotic_agranular_FAMILY_E_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_E$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_E_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_E_AOV_BAD_REMOVED)      

```
### FAMILY J 

```{r necrotic_agranular_aov_J, echo=TRUE}

APOP_PLOT_7_necrotic_agranular_FAMILY_J_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_J$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_J_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_J_AOV_BAD_REMOVED)      

```

### FAMILY L 
```{r necrotic_agranular_aov_L, echo=TRUE}

APOP_PLOT_7_necrotic_agranular_FAMILY_L_AOV <- aov(APOP_PLOT_7_agranular_FAMILY_L$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_L_AOV)

APOP_PLOT_7_necrotic_agranular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_7_necrotic_agranular_FAMILY_L_AOV_BAD_REMOVED)      

```


### TWO WAY ANOVA
```{r necrotic_Agranular_aov, echo=TRUE}
APOP_PLOT_7_necrotic_agranular_TWO_WAY_AOV <- lm(APOP_PLOT7_AGRANULAR_QUAD_PLOT$Q1.UL_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT)
Anova(APOP_PLOT_7_necrotic_agranular_TWO_WAY_AOV, type="II")
summary(APOP_PLOT_7_necrotic_agranular_TWO_WAY_AOV)

APOP_PLOT_7_necrotic_agranular_TWO_WAY_AOV_BAD_REMOVED <- lm(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.UL_Arcsine ~ APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED)
Anova(APOP_PLOT_7_necrotic_agranular_TWO_WAY_AOV_BAD_REMOVED, type="II")
summary(APOP_PLOT_7_necrotic_agranular_TWO_WAY_AOV_BAD_REMOVED)

#NONE are significant
```

### One Way ANOVA of Differences between Families

```{r necrotic_Agranular, echo=TRUE}

APOP_PLOT_7_necrotic_agranular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control",APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]
APOP_PLOT_7_necrotic_agranular_oneway_aov <- aov(APOP_PLOT_7_necrotic_agranular_hemocytes_BAD_REMOVED_CHALLENGE$Q1.UL_Arcsine ~ APOP_PLOT_7_necrotic_agranular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_7_necrotic_agranular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_7_necrotic_agranular_oneway_aov)
```

## Necrotic granular and agranular hemoctes 

```{r necrotic_granular_agranular, echo=TRUE}
necrotic_granular <- APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED %>% filter(GATE=="Q2_UL")
necrotic_agranular <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED %>% filter(GATE=="Q1_UL")
necrotic_granular_agranular_combined <- rbind(necrotic_granular,necrotic_agranular)

ggplot(necrotic_granular_agranular_combined, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + facet_grid(.~FAMILY+GROUP, scales="free") + geom_boxplot() + ggtitle("Percent of Granular and Agranular Necrotic Hemocytes (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") +
scale_fill_manual(name="Hemocyte Type", labels=c("Necrotic Granular", "Necrotic Agranular"), values=c("Q2_UL"="#99a765","Q1_UL"="#96578a")) 

# Two way ANOVA
necrotic_granular_agranula_aov <- lm(necrotic_granular_agranular_combined$Arcsine ~necrotic_granular_agranular_combined$FAMILY + necrotic_granular_agranular_combined$GATE, data=necrotic_granular_agranular_combined)
Anova(necrotic_granular_agranula_aov, type="II") #GATE is significant
summary(necrotic_granular_agranula_aov)


# Two- Way ANOVA 
necrotic_granular_agranula_aov_interaction <- lm(necrotic_granular_agranular_combined$Arcsine ~ necrotic_granular_agranular_combined$FAMILY + necrotic_granular_agranular_combined$GATE + necrotic_granular_agranular_combined$FAMILY:necrotic_granular_agranular_combined$GATE, data=necrotic_granular_agranular_combined)
Anova(necrotic_granular_agranula_aov_interaction, type="II") #GATE is significant
summary(necrotic_granular_agranula_aov_interaction)
necgate1<-filter(necrotic_granular_agranular_combined, GATE=="Q1_UL")
necgate2<-filter(necrotic_granular_agranular_combined, GATE=="Q2_UL")
t.test(necgate1$Arcsine,necgate2$Arcsine)

necrotic_granular_agranula_aov_interaction_leastsquares <- lsmeans(necrotic_granular_agranula_aov_interaction, "necrotic_granular_agranular_combined$GATE", adjust="tukey")
cld(necrotic_granular_agranula_aov_interaction_leastsquares, alpha=0.05, Letters=letters) # the means of the two groups are not significantly different 

```

## Combined Faceted all parameters by cell type

```{r graphing_granular, echo=TRUE}
ggplot(APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + facet_grid(.~FAMILY+GROUP, scales="free") + geom_boxplot() + ggtitle("Percent of Granular Hemocytes in each Quadrant (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + scale_fill_manual(name="Hemocyte Type", labels=c("Live Non-Apoptotic", "Live Apoptotic", "Dead Apoptotic", "Necrotic"), values=c("Q2_LL"="red","Q2_LR"="green", "Q2_UL"="purple", "Q2_UR"="blue")) 

ggplot(APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + facet_grid(.~FAMILY+GROUP, scales="free") + geom_boxplot() + ggtitle("Percent of Agranular Hemocytes in each Quadrant (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot")+ scale_fill_manual(name="Hemocyte Type", labels=c("Live Non-Apoptotic", "Live Apoptotic", "Dead Apoptotic", "Necrotic"), values=c("Q1_LL"="red","Q1_LR"="green", "Q1_UL"="purple", "Q1_UR"="blue")) 

APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED$cell <- "agranular"
APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED$cell <- "granular"
full_Data <- rbind(APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED, APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED)

ggplot(full_Data, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE, linetype=cell, color=cell)) + facet_grid(.~FAMILY, scales="free") +
  ggtitle("Percent of Granular and Agranular Hemocytes in each Quadrant (low quality removed)") +
  geom_boxplot()+
  ylab("Percent of Hemocyte Events in each quad plot") + 
  scale_fill_manual(name="Hemocyte Type", labels=c("Live Agranular Non-Apoptotic", "Live Agranular Apoptotic", "Dead Agranular Apoptotic", "Agranular Necrotic", "Live Granular Non-Apoptotic", "Live Granular Apoptotic", "Dead Granular Apoptotic", "Granular Necrotic"), values=c("Q1_LL"="#50b47b","Q1_LR"="#5d3585", "Q1_UL"="#98a441", "Q1_UR"="#6770d5","Q2_LL"="#ba6437","Q2_LR"="#6d8dd7", "Q2_UL"="#ba496b", "Q2_UR"="#c26abb")) +
  scale_color_manual(values=c("granular"="black","agranular"="black"))

```

#### Percent Live Granular Hemocytes

### One-Way ANOVA control vs. challenge

## Plotting
```{r live_granular_plotting, echo=TRUE}
ggplot(data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q2.LL_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Granular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
```

### Family A
```{r live_granular_A, echo=TRUE}
APOP_PLOT_4_live_granular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$Q2.LL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_4_live_granular_FAMILY_A_AOV_BAD_REMOVED)

```

### Family B
```{r live_granular_B, echo=TRUE}
APOP_PLOT_4_live_granular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$Q2.LL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_4_live_granular_FAMILY_B_AOV_BAD_REMOVED)
```

### Family D
```{r live_granular_D, echo=TRUE}
APOP_PLOT_4_live_granular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$Q2.LL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_4_live_granular_FAMILY_D_AOV_BAD_REMOVED)

```

### Family E
```{r live_granular_E, echo=TRUE}
APOP_PLOT_4_live_granular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$Q2.LL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_4_live_granular_FAMILY_E_AOV_BAD_REMOVED)
```

### Family J
```{r live_granular_J, echo=TRUE}
APOP_PLOT_4_live_granular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$Q2.LL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_4_live_granular_FAMILY_J_AOV_BAD_REMOVED)
```

### Family L
```{r live_granular_L, echo=TRUE}
APOP_PLOT_4_live_granular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$Q2.LL_Arcsine ~ APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_4_granular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_4_live_granular_FAMILY_L_AOV_BAD_REMOVED)
```

### Two- Way ANOVA
```{r live_granular_anova, echo=TRUE}
APOP_PLOT_4_live_granular_FAMILY_BAD_REMOVED_lm <- lm(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LL_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED)
Anova(APOP_PLOT_4_live_granular_FAMILY_BAD_REMOVED_lm, type="II")
summary(APOP_PLOT_4_live_granular_FAMILY_BAD_REMOVED_lm)

# Interaction
APOP_PLOT_4_live_granular_FAMILY_BAD_REMOVED_interaction_lm <- lm(APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Q2.LL_Arcsine ~ APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP:APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED)
Anova(APOP_PLOT_4_live_granular_FAMILY_BAD_REMOVED_interaction_lm, type="II") # Family is significant
summary(APOP_PLOT_4_live_granular_FAMILY_BAD_REMOVED_interaction_lm)

APOP_PLOT_4_live_granular_FAMILY_BAD_REMOVED_interaction_lm_leastsquares <-lsmeans(APOP_PLOT_4_live_granular_FAMILY_BAD_REMOVED_interaction_lm, "APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY", adjust="tukey")
cld(APOP_PLOT_4_live_granular_FAMILY_BAD_REMOVED_interaction_lm_leastsquares, alpha=0.05, Letters=letters)
```


### One-Way Anova of just challenged 
```{r live_granular_oneway, echo=TRUE}
APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control",APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]

APOP_PLOT_4_granular_oneway_aov <- aov(APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE$Q2.LL_Arcsine ~ APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_4_granular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_4_granular_oneway_aov)
TukeyHSD(APOP_PLOT_4_granular_oneway_aov)
```
#### Percent Live Agranular Hemocytes 

## Plotting
```{r live_agranular_plotting, echo=TRUE}
ggplot(data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED, aes(x=FAMILY, y=Q1.LL_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Agranular Hemocytes \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
```

### Family A
```{r live_agranular_A, echo=TRUE}
APOP_PLOT_7_live_agranular_FAMILY_A_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$Q1.LL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_A_BAD_REMOVED)
summary(APOP_PLOT_7_live_agranular_FAMILY_A_AOV_BAD_REMOVED)  
```

### Family B
```{r live_agranular_B, echo=TRUE}
APOP_PLOT_7_live_agranular_FAMILY_B_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$Q1.LL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_B_BAD_REMOVED)
summary(APOP_PLOT_7_live_agranular_FAMILY_B_AOV_BAD_REMOVED)  
```

### Family D
```{r live_agranular_D, echo=TRUE}
APOP_PLOT_7_live_agranular_FAMILY_D_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$Q1.LL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_D_BAD_REMOVED)
summary(APOP_PLOT_7_live_agranular_FAMILY_D_AOV_BAD_REMOVED)  
```

### Family E
```{r live_agranular_E, echo=TRUE}
APOP_PLOT_7_live_agranular_FAMILY_E_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$Q1.LL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_E_BAD_REMOVED)
summary(APOP_PLOT_7_live_agranular_FAMILY_E_AOV_BAD_REMOVED)  
```

### Family J
```{r live_agranular_J, echo=TRUE}
APOP_PLOT_7_live_agranular_FAMILY_J_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$Q1.LL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_J_BAD_REMOVED)
summary(APOP_PLOT_7_live_agranular_FAMILY_J_AOV_BAD_REMOVED)  
```

### Family L
```{r live_agranular_L, echo=TRUE}
APOP_PLOT_7_live_agranular_FAMILY_L_AOV_BAD_REMOVED <- aov(APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$Q1.LL_Arcsine ~ APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED$GROUP, data=APOP_PLOT_7_agranular_FAMILY_L_BAD_REMOVED)
summary(APOP_PLOT_7_live_agranular_FAMILY_L_AOV_BAD_REMOVED)  
```

### Two- Way ANOVA
```{r live_agranular_twoway}
APOP_PLOT_7_live_agranular_FAMILY_BAD_REMOVED_lm <- lm(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LL_Arcsine ~APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY, data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED)
Anova(APOP_PLOT_7_live_agranular_FAMILY_BAD_REMOVED_lm, type="II") # Family is significant
summary(APOP_PLOT_7_live_agranular_FAMILY_BAD_REMOVED_lm) 

# Interaction
APOP_PLOT_7_live_agranular_FAMILY_BAD_REMOVED_lm_interaction <- lm(APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Q1.LL_Arcsine ~APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY + APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP:APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY , data=APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED)
Anova(APOP_PLOT_7_live_agranular_FAMILY_BAD_REMOVED_lm_interaction, type="II") # Family is significant
summary(APOP_PLOT_7_live_agranular_FAMILY_BAD_REMOVED_lm_interaction) 

APOP_PLOT_7_live_agranular_FAMILY_BAD_REMOVED_lm_interaction_leastsquares <-lsmeans(APOP_PLOT_7_live_agranular_FAMILY_BAD_REMOVED_lm_interaction, "APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$FAMILY", adjust="tukey")
cld(APOP_PLOT_7_live_agranular_FAMILY_BAD_REMOVED_lm_interaction_leastsquares, alpha=0.05, Letters=letters)
```

### One-Way Anova of just challenged 
```{r live_granular_oneway_double, echo=TRUE}
APOP_PLOT_7_live_agranular_hemocytes_BAD_REMOVED_CHALLENGE <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED[!grepl("control",APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$GROUP),]

APOP_PLOT_7_live_agranular_oneway_aov <- aov(APOP_PLOT_7_live_agranular_hemocytes_BAD_REMOVED_CHALLENGE$Q1.LL_Arcsine ~ APOP_PLOT_7_live_agranular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=APOP_PLOT_7_live_agranular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(APOP_PLOT_7_live_agranular_oneway_aov) # significantly different between families 
TukeyHSD(APOP_PLOT_7_live_agranular_oneway_aov)
```

### Two-Way ANOVA of Live Granular vs. Agranular
```{r two_way_aov_granular_agranular, echo=TRUE}
live_granular <- APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED %>% filter(GATE=="Q2_LL")
live_agranular <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED %>% filter(GATE=="Q1_LL")
live_granular_agranular_combined <- rbind(live_granular,live_agranular)

ggplot(live_granular_agranular_combined, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + facet_grid(.~FAMILY+GROUP, scales="free") + geom_boxplot() + ggtitle("Percent of Granular and Agranular Live Hemocytes (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + scale_fill_manual(name="Hemocyte Type", labels=c("Live Granular", "Live Agranular"), values=c("Q2_LL"="#99a765","Q1_LL"="#96578a")) 

# Two way ANOVA
live_granular_agranular_aov <- lm(live_granular_agranular_combined$Arcsine ~live_granular_agranular_combined$FAMILY + live_granular_agranular_combined$GATE, data=live_granular_agranular_combined)
Anova(live_granular_agranular_aov, type="II") #GATE and Family are significant
summary(live_granular_agranular_aov)

# Two- Way ANOVA 
live_granular_agranular_aov_interaction <- lm(live_granular_agranular_combined$Arcsine ~live_granular_agranular_combined$FAMILY + live_granular_agranular_combined$GATE + live_granular_agranular_combined$FAMILY:live_granular_agranular_combined$GATE, data=live_granular_agranular_combined)
Anova(live_granular_agranular_aov_interaction, type="II") #GATE and Family are significant
summary(live_granular_agranular_aov_interaction)

live_granular_agranula_aov_interaction_leastsquares <- lsmeans(live_granular_agranular_aov_interaction, "live_granular_agranular_combined$GATE", adjust="tukey")
cld(live_granular_agranula_aov_interaction_leastsquares, alpha=0.05, Letters=letters) # the means of the two groups are significantly different 
live_granular_agranula_aov_interaction_leastsquares_family <- lsmeans(live_granular_agranular_aov_interaction, "live_granular_agranular_combined$FAMILY", adjust="tukey")
cld(live_granular_agranula_aov_interaction_leastsquares_family, alpha=0.05, Letters=letters) # the means of the two groups are not significantly different 



```


#### Calculate Summary Statistics ####
```{r summary_stats, echo=TRUE}
full_combined <- rbind(APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED, APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED)

full_statistics <- summarySE(data=full_combined, "PERCENT_OF_THIS_PLOT", groupvars=c("GATE", "GROUP", "cell","FAMILY"), conf.interval= 0.95)
```


#### DAY 50 APOPTOSIS DATA ANALYSIS ####

## Load in data for each plot

```{r load_data_DAY50, echo=TRUE}
#Load in the Data for each plot on a separate spreadsheet

DAY50_APOP_PLOT3_P1_GATE <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY50/PLOT3.csv", header=TRUE)
DAY50_APOP_PLOT8_GRANULAR_AGRANULAR <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY50/PLOT8.csv", header=TRUE)
DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT <-read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY50/PLOT4.csv", header=TRUE)
DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY50/PLOT7.csv", header=TRUE)

#Remove empty rows
DAY50_APOP_PLOT3_P1_GATE <- na.omit(DAY50_APOP_PLOT3_P1_GATE)
DAY50_APOP_PLOT8_GRANULAR_AGRANULAR <- na.omit(DAY50_APOP_PLOT8_GRANULAR_AGRANULAR)
DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT <- na.omit(DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT)
DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT<- na.omit(DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT)

## Remove percent symbol from columns 
DAY50_APOP_PLOT3_P1_GATE$P1_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", DAY50_APOP_PLOT3_P1_GATE$P1_PERCENT_OF_THIS_PLOT))

DAY50_APOP_PLOT8_GRANULAR_AGRANULAR$P3_PERCENT_OF_THIS_PLOT<- as.numeric(gsub("\\%", "", DAY50_APOP_PLOT8_GRANULAR_AGRANULAR$P3_PERCENT_OF_THIS_PLOT))

DAY50_APOP_PLOT8_GRANULAR_AGRANULAR$P4_PERCENT_OF_THIS_PLOT<- as.numeric(gsub("\\%", "", DAY50_APOP_PLOT8_GRANULAR_AGRANULAR$P4_PERCENT_OF_THIS_PLOT))

DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT$PERCENT_OF_THIS_PLOT))

DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT$PERCENT_OF_THIS_PLOT))

# Load in Data for the samples to remove 
APOPTOSIS_Samples_Remove_day50 <- read.csv(file="../ANALYSIS_CSVs/APOPTOSIS_ASSAY/DAY50/Apoptosis_assay_remove.csv", header=TRUE)

# Data Frame with bad samples removed
DAY50_APOP_PLOT3_P1_GATE_BAD_REMOVED <- DAY50_APOP_PLOT3_P1_GATE[!DAY50_APOP_PLOT3_P1_GATE$SAMPLE_ID %in% APOPTOSIS_Samples_Remove_day50$SAMPLE_ID, , drop=FALSE]

DAY50_APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED <- DAY50_APOP_PLOT8_GRANULAR_AGRANULAR[!DAY50_APOP_PLOT8_GRANULAR_AGRANULAR$SAMPLE_ID %in% APOPTOSIS_Samples_Remove_day50$SAMPLE_ID, , drop=FALSE]

DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED <- DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT[!DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT$SAMPLE_ID %in% APOPTOSIS_Samples_Remove_day50$SAMPLE_ID, , drop=FALSE]

DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED <- DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT[!DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT$SAMPLE_ID %in% APOPTOSIS_Samples_Remove_day50$SAMPLE_ID, , drop=FALSE]

```

# Arc sine Percentage data
```{r arcsine_percentages, echo=TRUE}
# NOTE: NA's produced whenever the percentages were above 100%
DAY50_APOP_PLOT3_P1_GATE$Arcsine<- transf.arcsin(DAY50_APOP_PLOT3_P1_GATE$P1_PERCENT_OF_THIS_PLOT*0.01)
DAY50_APOP_PLOT8_GRANULAR_AGRANULAR$P3_Arcsine <- transf.arcsin(DAY50_APOP_PLOT8_GRANULAR_AGRANULAR$P3_PERCENT_OF_THIS_PLOT *0.01)
DAY50_APOP_PLOT8_GRANULAR_AGRANULAR$P4_Arcsine <- transf.arcsin(DAY50_APOP_PLOT8_GRANULAR_AGRANULAR$P4_PERCENT_OF_THIS_PLOT*0.01)
DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT$Arcsine <- transf.arcsin(DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT$PERCENT_OF_THIS_PLOT*0.01)
DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT$Arcsine <- transf.arcsin(DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT$PERCENT_OF_THIS_PLOT*0.01)

# Bad removed 
DAY50_APOP_PLOT3_P1_GATE_BAD_REMOVED$Arcsine<- transf.arcsin(DAY50_APOP_PLOT3_P1_GATE_BAD_REMOVED$P1_PERCENT_OF_THIS_PLOT*0.01)
DAY50_APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P3_Arcsine <- transf.arcsin(DAY50_APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P3_PERCENT_OF_THIS_PLOT *0.01)
DAY50_APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P4_Arcsine <- transf.arcsin(DAY50_APOP_PLOT8_GRANULAR_AGRANULAR_BAD_REMOVED$P4_PERCENT_OF_THIS_PLOT*0.01)
DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$Arcsine <- transf.arcsin(DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$PERCENT_OF_THIS_PLOT*0.01)
DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$Arcsine <- transf.arcsin(DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$PERCENT_OF_THIS_PLOT*0.01)
```

# % LIVE apoptotic granular hemocytes (PLOT4, Q2-LR)

## Percent LIVE apoptotic granular hemocytes (PLOT4, Q2-LR)
```{r LIVE_apoptotic_Granular_day50, include=TRUE, echo=TRUE}
DAY50_live_granular <- DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(GATE=="Q2_LR")
DAY50_APOP_live_apoptotic_granular_BAD_NOT_REMOVED <- ggplot(data=DAY50_live_granular, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Granular Hemocytes at Day 50 \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 

DAY50_live_granular_BAD_REMOVED <- DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(GATE=="Q2_LR")
DAY50_APOP_live_apoptotic_granular_BAD_REMOVED <- ggplot(data= DAY50_live_granular_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Granular Hemocytes at Day 50 \nLow Quality Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 
DAY50_APOP_live_apoptotic_granular_BAD_REMOVED
```

### FAMILY A

```{r day50_live_apoptotic_granular_A, echo=TRUE}
DAY50_live_granular_FAMILY_A <- DAY50_live_granular %>% filter(FAMILY=="A")

DAY50_live_granular_FAMILY_A_aov <- aov(DAY50_live_granular_FAMILY_A$Arcsine ~ DAY50_live_granular_FAMILY_A$GROUP, data=DAY50_live_granular_FAMILY_A)
summary(DAY50_live_granular_FAMILY_A_aov)

DAY50_live_granular_BAD_REMOVED_FAMILY_A <- DAY50_live_granular_BAD_REMOVED %>% filter(FAMILY=="A") 
DAY50_live_granular_BAD_REMOVED_FAMILY_A_aov <- aov(DAY50_live_granular_BAD_REMOVED_FAMILY_A$Arcsine ~ DAY50_live_granular_BAD_REMOVED_FAMILY_A$GROUP, data=DAY50_live_granular_BAD_REMOVED_FAMILY_A)
summary(DAY50_live_granular_BAD_REMOVED_FAMILY_A_aov)
```

### FAMILY B
```{r day50_live_apoptotic_granular_B, echo=TRUE}
DAY50_live_granular_FAMILY_B <- DAY50_live_granular %>% filter(FAMILY=="B")

DAY50_live_granular_FAMILY_B_aov <- aov(DAY50_live_granular_FAMILY_B$Arcsine ~ DAY50_live_granular_FAMILY_B$GROUP, data=DAY50_live_granular_FAMILY_B)
summary(DAY50_live_granular_FAMILY_B_aov)

DAY50_live_granular_BAD_REMOVED_FAMILY_B <- DAY50_live_granular_BAD_REMOVED %>% filter(FAMILY=="B") 
DAY50_live_granular_BAD_REMOVED_FAMILY_B_aov <- aov(DAY50_live_granular_BAD_REMOVED_FAMILY_B$Arcsine ~ DAY50_live_granular_BAD_REMOVED_FAMILY_B$GROUP, data=DAY50_live_granular_BAD_REMOVED_FAMILY_B)
summary(DAY50_live_granular_BAD_REMOVED_FAMILY_B_aov)
```


### FAMILY D
```{r day50_live_apoptotic_granular_D, echo=TRUE}
DAY50_live_granular_FAMILY_D <- DAY50_live_granular %>% filter(FAMILY=="D")

DAY50_live_granular_FAMILY_D_aov <- aov(DAY50_live_granular_FAMILY_D$Arcsine ~ DAY50_live_granular_FAMILY_D$GROUP, data=DAY50_live_granular_FAMILY_D)
summary(DAY50_live_granular_FAMILY_D_aov)

DAY50_live_granular_BAD_REMOVED_FAMILY_D <- DAY50_live_granular_BAD_REMOVED %>% filter(FAMILY=="D") 
DAY50_live_granular_BAD_REMOVED_FAMILY_D_aov <- aov(DAY50_live_granular_BAD_REMOVED_FAMILY_D$Arcsine ~ DAY50_live_granular_BAD_REMOVED_FAMILY_D$GROUP, data=DAY50_live_granular_BAD_REMOVED_FAMILY_D)
summary(DAY50_live_granular_BAD_REMOVED_FAMILY_D_aov)
```

### FAMILY E 

```{r day50_live_apoptotic_granular_E, echo=TRUE}
DAY50_live_granular_FAMILY_E <- DAY50_live_granular %>% filter(FAMILY=="E")

DAY50_live_granular_FAMILY_E_aov <- aov(DAY50_live_granular_FAMILY_E$Arcsine ~ DAY50_live_granular_FAMILY_E$GROUP, data=DAY50_live_granular_FAMILY_E)
summary(DAY50_live_granular_FAMILY_E_aov)

DAY50_live_granular_BAD_REMOVED_FAMILY_E <- DAY50_live_granular_BAD_REMOVED %>% filter(FAMILY=="E") 
DAY50_live_granular_BAD_REMOVED_FAMILY_E_aov <- aov(DAY50_live_granular_BAD_REMOVED_FAMILY_E$Arcsine ~ DAY50_live_granular_BAD_REMOVED_FAMILY_E$GROUP, data=DAY50_live_granular_BAD_REMOVED_FAMILY_E)
summary(DAY50_live_granular_BAD_REMOVED_FAMILY_E_aov)
```

### FAMILY J
```{r day50_live_apoptotic_granular_J, echo=TRUE}
DAY50_live_granular_FAMILY_J <- DAY50_live_granular %>% filter(FAMILY=="J")

DAY50_live_granular_FAMILY_J_aov <- aov(DAY50_live_granular_FAMILY_J$Arcsine ~ DAY50_live_granular_FAMILY_J$GROUP, data=DAY50_live_granular_FAMILY_J)
summary(DAY50_live_granular_FAMILY_J_aov)

DAY50_live_granular_BAD_REMOVED_FAMILY_J <- DAY50_live_granular_BAD_REMOVED %>% filter(FAMILY=="J") 
DAY50_live_granular_BAD_REMOVED_FAMILY_J_aov <- aov(DAY50_live_granular_BAD_REMOVED_FAMILY_J$Arcsine ~ DAY50_live_granular_BAD_REMOVED_FAMILY_J$GROUP, data=DAY50_live_granular_BAD_REMOVED_FAMILY_J)
summary(DAY50_live_granular_BAD_REMOVED_FAMILY_J_aov)
```

### FAMILY L 
```{r day50_live_apoptotic_granular_L, echo=TRUE}
DAY50_live_granular_FAMILY_L <- DAY50_live_granular %>% filter(FAMILY=="L")

DAY50_live_granular_FAMILY_L_aov <- aov(DAY50_live_granular_FAMILY_L$Arcsine ~ DAY50_live_granular_FAMILY_L$GROUP, data=DAY50_live_granular_FAMILY_L)
summary(DAY50_live_granular_FAMILY_L_aov)

DAY50_live_granular_BAD_REMOVED_FAMILY_L <- DAY50_live_granular_BAD_REMOVED %>% filter(FAMILY=="L") 
DAY50_live_granular_BAD_REMOVED_FAMILY_L_aov <- aov(DAY50_live_granular_BAD_REMOVED_FAMILY_L$Arcsine ~ DAY50_live_granular_BAD_REMOVED_FAMILY_L$GROUP, data=DAY50_live_granular_BAD_REMOVED_FAMILY_L)
summary(DAY50_live_granular_BAD_REMOVED_FAMILY_L_aov)
```

### Two Way ANOVA of Live Apoptotic Granular

```{r day50_live_apoptotic_granular_twoway, echo=TRUE}
DAY50_APOP_PLOT4_live_granular_FAMILY_BAD_REMOVED_lm <- lm(DAY50_live_granular_BAD_REMOVED$Arcsine ~DAY50_live_granular_BAD_REMOVED$GROUP + DAY50_live_granular_BAD_REMOVED$FAMILY, data=DAY50_live_granular_BAD_REMOVED)

Anova(DAY50_APOP_PLOT4_live_granular_FAMILY_BAD_REMOVED_lm, type="II") # Family is significant
summary(DAY50_APOP_PLOT4_live_granular_FAMILY_BAD_REMOVED_lm) # NO significant differences
```

### One-Way Anova of just challenged 
```{r Day50_live_apoptotic_granular_oneway_double, echo=TRUE}
DAY50_PLOT4_live_apoptotic_granular_BAD_REMOVED_CHALLENGE <- DAY50_live_granular_BAD_REMOVED[!grepl("control",DAY50_live_granular_BAD_REMOVED$GROUP),]

DAY50_PLOT4_live_apoptotic_granular_oneway_aov <- aov(DAY50_PLOT4_live_apoptotic_granular_BAD_REMOVED_CHALLENGE$Arcsine ~ DAY50_PLOT4_live_apoptotic_granular_BAD_REMOVED_CHALLENGE$FAMILY, data=DAY50_PLOT4_live_apoptotic_granular_BAD_REMOVED_CHALLENGE)
summary(DAY50_PLOT4_live_apoptotic_granular_oneway_aov) # significantly different between families 
TukeyHSD(DAY50_PLOT4_live_apoptotic_granular_oneway_aov)
```

### Live Apoptotic Agranular 

## Percent LIVE apoptotic agranular hemocytes (PLOT4, Q2-LR)
```{r LIVE_apoptotic_agrranular, include=TRUE, echo=TRUE}
DAY50_live_agranular <- DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(GATE=="Q1_LR")
DAY50_APOP_live_apoptotic_agranular_BAD_NOT_REMOVED <- ggplot(data=DAY50_live_agranular, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Agranular Hemocytes at Day 50 \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 

DAY50_live_agranular_BAD_REMOVED <- DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(GATE=="Q1_LR")
DAY50_APOP_live_apoptotic_agranular_BAD_REMOVED <- ggplot(data= DAY50_live_agranular_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Apoptotic Agranular Hemocytes at Day 50 \nLow Quality Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 
DAY50_APOP_live_apoptotic_agranular_BAD_REMOVED
```

### FAMILY A 
```{r day50_live_apoptotic_Agranular, echo=TRUE}
DAY50_live_agranular_FAMILY_A <- DAY50_live_agranular %>% filter(FAMILY=="A")

DAY50_live_agranular_FAMILY_A_aov <- aov(DAY50_live_agranular_FAMILY_A$Arcsine ~ DAY50_live_agranular_FAMILY_A$GROUP, data=DAY50_live_agranular_FAMILY_A)
summary(DAY50_live_agranular_FAMILY_A_aov)

DAY50_live_agranular_BAD_REMOVED_FAMILY_A <- DAY50_live_agranular_BAD_REMOVED %>% filter(FAMILY=="A") 
DAY50_live_agranular_BAD_REMOVED_FAMILY_A_aov <- aov(DAY50_live_agranular_BAD_REMOVED_FAMILY_A$Arcsine ~ DAY50_live_agranular_BAD_REMOVED_FAMILY_A$GROUP, data=DAY50_live_agranular_BAD_REMOVED_FAMILY_A)
summary(DAY50_live_agranular_BAD_REMOVED_FAMILY_A_aov)
```

### FAMILY B
```{r day50_live_apoptotic_Agranular_familyB, echo=TRUE}
DAY50_live_agranular_FAMILY_B <- DAY50_live_agranular %>% filter(FAMILY=="B")

DAY50_live_agranular_FAMILY_B_aov <- aov(DAY50_live_agranular_FAMILY_B$Arcsine ~ DAY50_live_granular_FAMILY_B$GROUP, data=DAY50_live_agranular_FAMILY_B)
summary(DAY50_live_agranular_FAMILY_B_aov)

DAY50_live_agranular_BAD_REMOVED_FAMILY_B <- DAY50_live_agranular_BAD_REMOVED %>% filter(FAMILY=="B") 
DAY50_live_agranular_BAD_REMOVED_FAMILY_B_aov <- aov(DAY50_live_agranular_BAD_REMOVED_FAMILY_B$Arcsine ~ DAY50_live_agranular_BAD_REMOVED_FAMILY_B$GROUP, data=DAY50_live_agranular_BAD_REMOVED_FAMILY_B)
summary(DAY50_live_agranular_BAD_REMOVED_FAMILY_B_aov)
```

### FAMILY D
```{r day50_live_apoptotic_Agranular_familyD, echo=TRUE}
DAY50_live_agranular_FAMILY_D <- DAY50_live_agranular %>% filter(FAMILY=="D")

DAY50_live_agranular_FAMILY_D_aov <- aov(DAY50_live_agranular_FAMILY_D$Arcsine ~ DAY50_live_agranular_FAMILY_D$GROUP, data=DAY50_live_agranular_FAMILY_D)
summary(DAY50_live_agranular_FAMILY_D_aov)

DAY50_live_agranular_BAD_REMOVED_FAMILY_D <- DAY50_live_agranular_BAD_REMOVED %>% filter(FAMILY=="D") 
DAY50_live_agranular_BAD_REMOVED_FAMILY_D_aov <- aov(DAY50_live_agranular_BAD_REMOVED_FAMILY_D$Arcsine ~ DAY50_live_agranular_BAD_REMOVED_FAMILY_D$GROUP, data=DAY50_live_agranular_BAD_REMOVED_FAMILY_D)
summary(DAY50_live_agranular_BAD_REMOVED_FAMILY_D_aov)
```

### FAMILY E
```{r day50_live_apoptotic_Agranular_familyE, echo=TRUE}
DAY50_live_agranular_FAMILY_E <- DAY50_live_agranular %>% filter(FAMILY=="E")

DAY50_live_agranular_FAMILY_E_aov <- aov(DAY50_live_agranular_FAMILY_E$Arcsine ~ DAY50_live_agranular_FAMILY_E$GROUP, data=DAY50_live_agranular_FAMILY_E)
summary(DAY50_live_agranular_FAMILY_E_aov)

DAY50_live_agranular_BAD_REMOVED_FAMILY_E <- DAY50_live_agranular_BAD_REMOVED %>% filter(FAMILY=="E") 
DAY50_live_agranular_BAD_REMOVED_FAMILY_E_aov <- aov(DAY50_live_agranular_BAD_REMOVED_FAMILY_E$Arcsine ~ DAY50_live_agranular_BAD_REMOVED_FAMILY_E$GROUP, data=DAY50_live_agranular_BAD_REMOVED_FAMILY_E)
summary(DAY50_live_agranular_BAD_REMOVED_FAMILY_E_aov)
```

### FAMILY J
```{r day50_live_apoptotic_Agranular_familyJ, echo=TRUE}
DAY50_live_agranular_FAMILY_J <- DAY50_live_agranular %>% filter(FAMILY=="J")

DAY50_live_agranular_FAMILY_J_aov <- aov(DAY50_live_agranular_FAMILY_J$Arcsine ~ DAY50_live_agranular_FAMILY_J$GROUP, data=DAY50_live_agranular_FAMILY_J)
summary(DAY50_live_agranular_FAMILY_J_aov)

DAY50_live_agranular_BAD_REMOVED_FAMILY_J <- DAY50_live_agranular_BAD_REMOVED %>% filter(FAMILY=="J") 
DAY50_live_agranular_BAD_REMOVED_FAMILY_J_aov <- aov(DAY50_live_agranular_BAD_REMOVED_FAMILY_J$Arcsine ~ DAY50_live_agranular_BAD_REMOVED_FAMILY_J$GROUP, data=DAY50_live_agranular_BAD_REMOVED_FAMILY_J)
summary(DAY50_live_agranular_BAD_REMOVED_FAMILY_J_aov)
```

### FAMILY L
```{r day50_live_apoptotic_Agranular_familyL, echo=TRUE}
DAY50_live_agranular_FAMILY_L <- DAY50_live_agranular %>% filter(FAMILY=="L")

DAY50_live_agranular_FAMILY_L_aov <- aov(DAY50_live_agranular_FAMILY_L$Arcsine ~ DAY50_live_agranular_FAMILY_L$GROUP, data=DAY50_live_agranular_FAMILY_L)
summary(DAY50_live_agranular_FAMILY_L_aov)

DAY50_live_agranular_BAD_REMOVED_FAMILY_L <- DAY50_live_agranular_BAD_REMOVED %>% filter(FAMILY=="L") 
DAY50_live_agranular_BAD_REMOVED_FAMILY_L_aov <- aov(DAY50_live_agranular_BAD_REMOVED_FAMILY_L$Arcsine ~ DAY50_live_agranular_BAD_REMOVED_FAMILY_L$GROUP, data=DAY50_live_agranular_BAD_REMOVED_FAMILY_L)
summary(DAY50_live_agranular_BAD_REMOVED_FAMILY_L_aov)
```

### Two Way ANOVA of Live Apoptotic Agranular

```{r day50_live_apoptotic_agranular_twoway, echo=TRUE}
DAY50_APOP_PLOT7_live_apoptotic_agranular_BAD_REMOVED_lm <- lm(DAY50_live_agranular_BAD_REMOVED$Arcsine ~DAY50_live_agranular_BAD_REMOVED$GROUP +DAY50_live_agranular_BAD_REMOVED$FAMILY, data=DAY50_live_agranular_BAD_REMOVED)

Anova(DAY50_APOP_PLOT7_live_apoptotic_agranular_BAD_REMOVED_lm, type="II") # Family is significant
summary(DAY50_APOP_PLOT7_live_apoptotic_agranular_BAD_REMOVED_lm) # Family is significant

# Interaction
DAY50_APOP_PLOT7_live_apoptotic_agranular_BAD_REMOVED_lm <- lm(DAY50_live_agranular_BAD_REMOVED$Arcsine ~DAY50_live_agranular_BAD_REMOVED$GROUP + DAY50_live_agranular_BAD_REMOVED$FAMILY + DAY50_live_agranular_BAD_REMOVED$GROUP:DAY50_live_agranular_BAD_REMOVED$FAMILY , data=DAY50_live_agranular_BAD_REMOVED)
Anova(DAY50_APOP_PLOT7_live_apoptotic_agranular_BAD_REMOVED_lm, type="II") # Family is significant
summary(DAY50_APOP_PLOT7_live_apoptotic_agranular_BAD_REMOVED_lm) 

DAY50_APOP_PLOT7_live_apoptotic_agranular_FAMILY_BAD_REMOVED_lm_interaction_leastsquares <-lsmeans(DAY50_APOP_PLOT7_live_apoptotic_agranular_BAD_REMOVED_lm, "DAY50_live_agranular_BAD_REMOVED$FAMILY", adjust="tukey")
cld(DAY50_APOP_PLOT7_live_apoptotic_agranular_FAMILY_BAD_REMOVED_lm_interaction_leastsquares, alpha=0.05, Letters=letters)
```

### One-Way Anova of just challenged 
```{r Day50_live_apoptotic_agranular_oneway, echo=TRUE}
DAY50_PLOT7_live_apoptotic_agranular_BAD_REMOVED_CHALLENGE <- DAY50_live_agranular_BAD_REMOVED[!grepl("control",DAY50_live_agranular_BAD_REMOVED$GROUP),]

DAY50_PLOT7_live_apoptotic_agranular_oneway_aov <- aov(DAY50_PLOT7_live_apoptotic_agranular_BAD_REMOVED_CHALLENGE$Arcsine ~ DAY50_PLOT7_live_apoptotic_agranular_BAD_REMOVED_CHALLENGE$FAMILY, data=DAY50_PLOT7_live_apoptotic_agranular_BAD_REMOVED_CHALLENGE)
summary(DAY50_PLOT7_live_apoptotic_agranular_oneway_aov) 
TukeyHSD(DAY50_PLOT7_live_apoptotic_agranular_oneway_aov)
```

### Two Way ANOVA of Live Apoptotic Cells 

```{r day50_live_apoptotic_cells_twoway, echo=TRUE}

DAY50_live_granular_agranular_combined <- rbind(DAY50_live_agranular_BAD_REMOVED,DAY50_live_granular_BAD_REMOVED)

ggplot(DAY50_live_granular_agranular_combined, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + facet_grid(.~FAMILY+GROUP, scales="free") + geom_boxplot() + ggtitle("Percent of Granular and Agranular Live Apoptotic Hemocytes at Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + scale_fill_manual(name="Hemocyte Type", labels=c("Live Agranular", "Live Granular"), values=c("Q1_LR"="#99a765","Q2_LR"="#96578a")) 

# Two way ANOVA
DAY50_live_granular_agranular_aov <- lm(DAY50_live_granular_agranular_combined$Arcsine ~DAY50_live_granular_agranular_combined$FAMILY + DAY50_live_granular_agranular_combined$GATE, data=DAY50_live_granular_agranular_combined)
Anova(DAY50_live_granular_agranular_aov, type="II") #GATE and Family are significant
summary(DAY50_live_granular_agranular_aov)

# Two- Way ANOVA 
DAY50_live_granular_agranular_aov_interaction <- lm(DAY50_live_granular_agranular_combined$Arcsine ~DAY50_live_granular_agranular_combined$FAMILY + DAY50_live_granular_agranular_combined$GATE + DAY50_live_granular_agranular_combined$FAMILY:DAY50_live_granular_agranular_combined$GATE, data=DAY50_live_granular_agranular_combined)
Anova(DAY50_live_granular_agranular_aov_interaction, type="II") #GATE,Family, and interaction are significant
summary(DAY50_live_granular_agranular_aov_interaction)

DAY50_live_granular_agranula_aov_interaction_leastsquares <- lsmeans(DAY50_live_granular_agranular_aov_interaction, pairwise ~ DAY50_live_granular_agranular_combined$FAMILY:DAY50_live_granular_agranular_combined$GATE, adjust="tukey")
cld(DAY50_live_granular_agranula_aov_interaction_leastsquares, alpha=0.05, Letters=letters) # the means of the two groups are significantly different 

DAY50_live_granular_agranula_aov_interaction_leastsquares_family <- lsmeans(DAY50_live_granular_agranular_aov_interaction, "DAY50_live_granular_agranular_combined$FAMILY", adjust="tukey")
cld(DAY50_live_granular_agranula_aov_interaction_leastsquares_family, alpha=0.05, Letters=letters) # the means of the groups are not significantly different 

DAY50_live_granular_agranula_aov_interaction_leastsquares_GATE <- lsmeans(DAY50_live_granular_agranular_aov_interaction, "DAY50_live_granular_agranular_combined$GATE", adjust="tukey")
cld(DAY50_live_granular_agranula_aov_interaction_leastsquares_GATE, alpha=0.05, Letters=letters) # the means of the groups are not significantly different 

```


### % Dead Apoptotic Granular Hemocytes 

## Percent Dead apoptotic granular hemocytes (PLOT4, Q2-LR)
```{r dead_apoptotic_granular_day50, include=TRUE, echo=TRUE}
DAY50_dead_granular <- DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(GATE=="Q2_UR")
DAY50_APOP_dead_apoptotic_granular_BAD_NOT_REMOVED <- ggplot(data=DAY50_dead_granular, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Granular Hemocytes at Day 50 \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 

DAY50_dead_granular_BAD_REMOVED <- DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(GATE=="Q2_UR")
DAY50_APOP_dead_apoptotic_granular_BAD_REMOVED <- ggplot(data= DAY50_dead_granular_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Granular Hemocytes at Day 50 \nLow Quality Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 
DAY50_APOP_dead_apoptotic_granular_BAD_REMOVED
```

### FAMILY A 
```{r day50_dead_apoptotic_granular_familyA, echo=TRUE}
DAY50_dead_granular_FAMILY_A <- DAY50_dead_granular %>% filter(FAMILY=="A")

DAY50_dead_granular_FAMILY_A_aov <- aov(DAY50_dead_granular_FAMILY_A$Arcsine ~ DAY50_dead_granular_FAMILY_A$GROUP, data=DAY50_dead_granular_FAMILY_A)
summary(DAY50_dead_granular_FAMILY_A_aov)

DAY50_dead_granular_BAD_REMOVED_FAMILY_A <- DAY50_dead_granular_BAD_REMOVED %>% filter(FAMILY=="A") 
DAY50_dead_granular_BAD_REMOVED_FAMILY_A_aov <- aov(DAY50_dead_granular_BAD_REMOVED_FAMILY_A$Arcsine ~ DAY50_dead_granular_BAD_REMOVED_FAMILY_A$GROUP, data=DAY50_dead_granular_BAD_REMOVED_FAMILY_A)
summary(DAY50_dead_granular_BAD_REMOVED_FAMILY_A_aov)
```

### FAMILY B 
```{r day50_dead_apoptotic_granular_familyB, echo=TRUE}
DAY50_dead_granular_FAMILY_B <- DAY50_dead_granular %>% filter(FAMILY=="B")

DAY50_dead_granular_FAMILY_B_aov <- aov(DAY50_dead_granular_FAMILY_B$Arcsine ~ DAY50_dead_granular_FAMILY_B$GROUP, data=DAY50_dead_granular_FAMILY_B)
summary(DAY50_dead_granular_FAMILY_B_aov)

DAY50_dead_granular_BAD_REMOVED_FAMILY_B <- DAY50_dead_granular_BAD_REMOVED %>% filter(FAMILY=="B") 
DAY50_dead_granular_BAD_REMOVED_FAMILY_B_aov <- aov(DAY50_dead_granular_BAD_REMOVED_FAMILY_B$Arcsine ~ DAY50_dead_granular_BAD_REMOVED_FAMILY_B$GROUP, data=DAY50_dead_granular_BAD_REMOVED_FAMILY_B)
summary(DAY50_dead_granular_BAD_REMOVED_FAMILY_B_aov)
```

### FAMILY D 
```{r day50_dead_apoptotic_granularfamilyD, echo=TRUE}
DAY50_dead_granular_FAMILY_D <- DAY50_dead_granular %>% filter(FAMILY=="D")

DAY50_dead_granular_FAMILY_D_aov <- aov(DAY50_dead_granular_FAMILY_D$Arcsine ~ DAY50_dead_granular_FAMILY_D$GROUP, data=DAY50_dead_granular_FAMILY_D)
summary(DAY50_dead_granular_FAMILY_D_aov)

DAY50_dead_granular_BAD_REMOVED_FAMILY_D <- DAY50_dead_granular_BAD_REMOVED %>% filter(FAMILY=="D") 
DAY50_dead_granular_BAD_REMOVED_FAMILY_D_aov <- aov(DAY50_dead_granular_BAD_REMOVED_FAMILY_D$Arcsine ~ DAY50_dead_granular_BAD_REMOVED_FAMILY_D$GROUP, data=DAY50_dead_granular_BAD_REMOVED_FAMILY_D)
summary(DAY50_dead_granular_BAD_REMOVED_FAMILY_D_aov)
```

### FAMILY E 
```{r day50_dead_apoptotic_granularfamilyE, echo=TRUE}
DAY50_dead_granular_FAMILY_E <- DAY50_dead_granular %>% filter(FAMILY=="E")

DAY50_dead_granular_FAMILY_E_aov <- aov(DAY50_dead_granular_FAMILY_E$Arcsine ~ DAY50_dead_granular_FAMILY_E$GROUP, data=DAY50_dead_granular_FAMILY_E)
summary(DAY50_dead_granular_FAMILY_E_aov)

DAY50_dead_granular_BAD_REMOVED_FAMILY_E <- DAY50_dead_granular_BAD_REMOVED %>% filter(FAMILY=="E") 
DAY50_dead_granular_BAD_REMOVED_FAMILY_E_aov <- aov(DAY50_dead_granular_BAD_REMOVED_FAMILY_E$Arcsine ~ DAY50_dead_granular_BAD_REMOVED_FAMILY_E$GROUP, data=DAY50_dead_granular_BAD_REMOVED_FAMILY_E)
summary(DAY50_dead_granular_BAD_REMOVED_FAMILY_E_aov)
```

### FAMILY J 
```{r day50_dead_apoptotic_granularfamilyJ, echo=TRUE}
DAY50_dead_granular_FAMILY_J <- DAY50_dead_granular %>% filter(FAMILY=="J")

DAY50_dead_granular_FAMILY_J_aov <- aov(DAY50_dead_granular_FAMILY_J$Arcsine ~ DAY50_dead_granular_FAMILY_J$GROUP, data=DAY50_dead_granular_FAMILY_J)
summary(DAY50_dead_granular_FAMILY_J_aov)

DAY50_dead_granular_BAD_REMOVED_FAMILY_J <- DAY50_dead_granular_BAD_REMOVED %>% filter(FAMILY=="J") 
DAY50_dead_granular_BAD_REMOVED_FAMILY_J_aov <- aov(DAY50_dead_granular_BAD_REMOVED_FAMILY_J$Arcsine ~ DAY50_dead_granular_BAD_REMOVED_FAMILY_J$GROUP, data=DAY50_dead_granular_BAD_REMOVED_FAMILY_J)
summary(DAY50_dead_granular_BAD_REMOVED_FAMILY_J_aov)
```

### FAMILY L 
```{r day50_dead_apoptotic_granularfamilyL, echo=TRUE}
DAY50_dead_granular_FAMILY_L <- DAY50_dead_granular %>% filter(FAMILY=="L")

DAY50_dead_granular_FAMILY_L_aov <- aov(DAY50_dead_granular_FAMILY_L$Arcsine ~ DAY50_dead_granular_FAMILY_L$GROUP, data=DAY50_dead_granular_FAMILY_L)
summary(DAY50_dead_granular_FAMILY_L_aov)

DAY50_dead_granular_BAD_REMOVED_FAMILY_L <- DAY50_dead_granular_BAD_REMOVED %>% filter(FAMILY=="L") 
DAY50_dead_granular_BAD_REMOVED_FAMILY_L_aov <- aov(DAY50_dead_granular_BAD_REMOVED_FAMILY_L$Arcsine ~ DAY50_dead_granular_BAD_REMOVED_FAMILY_L$GROUP, data=DAY50_dead_granular_BAD_REMOVED_FAMILY_L)
summary(DAY50_dead_granular_BAD_REMOVED_FAMILY_L_aov)
```

### Two-Way ANOVA of Dead Apoptotic Granular

```{r day50_dead_apoptotic_granular_twoway, echo=TRUE}
DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_lm <- lm(DAY50_dead_granular_BAD_REMOVED$Arcsine ~DAY50_dead_granular_BAD_REMOVED$GROUP +DAY50_dead_granular_BAD_REMOVED$FAMILY, data=DAY50_dead_granular_BAD_REMOVED)

Anova(DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_lm, type="II") # Family is significant
summary(DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_lm) # Family is significant

# Interaction
DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_lm <- lm(DAY50_dead_granular_BAD_REMOVED$Arcsine ~DAY50_dead_granular_BAD_REMOVED$GROUP + DAY50_dead_granular_BAD_REMOVED$FAMILY + DAY50_dead_granular_BAD_REMOVED$GROUP:DAY50_dead_granular_BAD_REMOVED$FAMILY , data=DAY50_dead_granular_BAD_REMOVED)
Anova(DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_lm, type="II") # Family is significant
summary(DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_lm) 

DAY50_PLOT4_dead_apoptotic_granular_FAMILY_BAD_REMOVED_lm_interaction_leastsquares <-lsmeans(DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_lm, "DAY50_dead_granular_BAD_REMOVED$FAMILY", adjust="tukey")
cld(DAY50_PLOT4_dead_apoptotic_granular_FAMILY_BAD_REMOVED_lm_interaction_leastsquares, alpha=0.05, Letters=letters)
```


### One-Way Anova of just challenged 
```{r Day50_dead_apoptotic_granular_oneway_double, echo=TRUE}
DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_CHALLENGE <- DAY50_dead_granular_BAD_REMOVED[!grepl("control",DAY50_dead_granular_BAD_REMOVED$GROUP),]

DAY50_PLOT4_dead_apoptotic_granular_oneway_aov <- aov(DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_CHALLENGE$Arcsine ~ DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_CHALLENGE$FAMILY, data=DAY50_PLOT4_dead_apoptotic_granular_BAD_REMOVED_CHALLENGE)
summary(DAY50_PLOT4_dead_apoptotic_granular_oneway_aov) # significantly different between families 
TukeyHSD(DAY50_PLOT4_dead_apoptotic_granular_oneway_aov)
```

### Dead Apoptotic Agranular cells 

## Percent Dead apoptotic agranular hemocytes (PLOT4, Q2-UR)
```{r DAY50_dead_apoptotic_agrranular, include=TRUE, echo=TRUE}
DAY50_dead_agranular <- DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(GATE=="Q1_UR")
DAY50_APOP_dead_apoptotic_agranular_BAD_NOT_REMOVED <- ggplot(data=DAY50_dead_agranular, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Agranular Hemocytes at Day 50 \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 

DAY50_dead_agranular_BAD_REMOVED <- DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(GATE=="Q1_UR")
DAY50_APOP_dead_apoptotic_agranular_BAD_REMOVED <- ggplot(data= DAY50_dead_agranular_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Dead Apoptotic Agranular Hemocytes at Day 50 \nLow Quality Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 
DAY50_APOP_dead_apoptotic_agranular_BAD_REMOVED
```

### FAMILY A

### FAMILY A 
```{r day50_dead_apoptotic_agranular, echo=TRUE}
DAY50_dead_agranular_FAMILY_A <- DAY50_dead_agranular %>% filter(FAMILY=="A")

DAY50_dead_agranular_FAMILY_A_aov <- aov(DAY50_dead_agranular_FAMILY_A$Arcsine ~ DAY50_dead_agranular_FAMILY_A$GROUP, data=DAY50_dead_agranular_FAMILY_A)
summary(DAY50_dead_agranular_FAMILY_A_aov)

DAY50_dead_agranular_BAD_REMOVED_FAMILY_A <- DAY50_dead_agranular_BAD_REMOVED %>% filter(FAMILY=="A") 
DAY50_dead_agranular_BAD_REMOVED_FAMILY_A_aov <- aov(DAY50_dead_agranular_BAD_REMOVED_FAMILY_A$Arcsine ~ DAY50_dead_agranular_BAD_REMOVED_FAMILY_A$GROUP, data=DAY50_dead_agranular_BAD_REMOVED_FAMILY_A)
summary(DAY50_dead_agranular_BAD_REMOVED_FAMILY_A_aov)
```

### FAMILY B

```{r day50_dead_apoptotic_agranular_familyb, echo=TRUE}
DAY50_dead_agranular_FAMILY_B <- DAY50_dead_agranular %>% filter(FAMILY=="B")

DAY50_dead_agranular_FAMILY_B_aov <- aov(DAY50_dead_agranular_FAMILY_B$Arcsine ~ DAY50_dead_agranular_FAMILY_B$GROUP, data=DAY50_dead_agranular_FAMILY_B)
summary(DAY50_dead_agranular_FAMILY_B_aov)

DAY50_dead_agranular_BAD_REMOVED_FAMILY_B <- DAY50_dead_agranular_BAD_REMOVED %>% filter(FAMILY=="B") 
DAY50_dead_agranular_BAD_REMOVED_FAMILY_B_aov <- aov(DAY50_dead_agranular_BAD_REMOVED_FAMILY_B$Arcsine ~ DAY50_dead_agranular_BAD_REMOVED_FAMILY_B$GROUP, data=DAY50_dead_agranular_BAD_REMOVED_FAMILY_B)
summary(DAY50_dead_agranular_BAD_REMOVED_FAMILY_B_aov)
```

### FAMILY D
```{r day50_dead_apoptotic_agranular_familyD, echo=TRUE}
DAY50_dead_agranular_FAMILY_D <- DAY50_dead_agranular %>% filter(FAMILY=="D")

DAY50_dead_agranular_FAMILY_D_aov <- aov(DAY50_dead_agranular_FAMILY_D$Arcsine ~ DAY50_dead_agranular_FAMILY_D$GROUP, data=DAY50_dead_agranular_FAMILY_D)
summary(DAY50_dead_agranular_FAMILY_D_aov)

DAY50_dead_agranular_BAD_REMOVED_FAMILY_D <- DAY50_dead_agranular_BAD_REMOVED %>% filter(FAMILY=="D") 
DAY50_dead_agranular_BAD_REMOVED_FAMILY_D_aov <- aov(DAY50_dead_agranular_BAD_REMOVED_FAMILY_D$Arcsine ~ DAY50_dead_agranular_BAD_REMOVED_FAMILY_D$GROUP, data=DAY50_dead_agranular_BAD_REMOVED_FAMILY_D)
summary(DAY50_dead_agranular_BAD_REMOVED_FAMILY_D_aov)
```

### Family E

```{r day50_dead_apoptotic_agranular_familyE, echo=TRUE}
DAY50_dead_agranular_FAMILY_E <- DAY50_dead_agranular %>% filter(FAMILY=="E")

DAY50_dead_agranular_FAMILY_E_aov <- aov(DAY50_dead_agranular_FAMILY_E$Arcsine ~ DAY50_dead_agranular_FAMILY_E$GROUP, data=DAY50_dead_agranular_FAMILY_E)
summary(DAY50_dead_agranular_FAMILY_E_aov)

DAY50_dead_agranular_BAD_REMOVED_FAMILY_E <- DAY50_dead_agranular_BAD_REMOVED %>% filter(FAMILY=="E") 
DAY50_dead_agranular_BAD_REMOVED_FAMILY_E_aov <- aov(DAY50_dead_agranular_BAD_REMOVED_FAMILY_E$Arcsine ~ DAY50_dead_agranular_BAD_REMOVED_FAMILY_E$GROUP, data=DAY50_dead_agranular_BAD_REMOVED_FAMILY_E)
summary(DAY50_dead_agranular_BAD_REMOVED_FAMILY_E_aov)
```

### FAMILY J
```{r day50_dead_apoptotic_agranular_familyJ, echo=TRUE}
DAY50_dead_agranular_FAMILY_J <- DAY50_dead_agranular %>% filter(FAMILY=="J")

DAY50_dead_agranular_FAMILY_J_aov <- aov(DAY50_dead_agranular_FAMILY_J$Arcsine ~ DAY50_dead_agranular_FAMILY_J$GROUP, data=DAY50_dead_agranular_FAMILY_J)
summary(DAY50_dead_agranular_FAMILY_J_aov)

DAY50_dead_agranular_BAD_REMOVED_FAMILY_J <- DAY50_dead_agranular_BAD_REMOVED %>% filter(FAMILY=="J") 
DAY50_dead_agranular_BAD_REMOVED_FAMILY_J_aov <- aov(DAY50_dead_agranular_BAD_REMOVED_FAMILY_J$Arcsine ~ DAY50_dead_agranular_BAD_REMOVED_FAMILY_J$GROUP, data=DAY50_dead_agranular_BAD_REMOVED_FAMILY_J)
summary(DAY50_dead_agranular_BAD_REMOVED_FAMILY_J_aov)
```

### FAMILY L
```{r day50_dead_apoptotic_agranular_FAMILYL, echo=TRUE}
DAY50_dead_agranular_FAMILY_L <- DAY50_dead_agranular %>% filter(FAMILY=="L")

DAY50_dead_agranular_FAMILY_L_aov <- aov(DAY50_dead_agranular_FAMILY_L$Arcsine ~ DAY50_dead_agranular_FAMILY_L$GROUP, data=DAY50_dead_agranular_FAMILY_L)
summary(DAY50_dead_agranular_FAMILY_L_aov)

DAY50_dead_agranular_BAD_REMOVED_FAMILY_L <- DAY50_dead_agranular_BAD_REMOVED %>% filter(FAMILY=="L") 
DAY50_dead_agranular_BAD_REMOVED_FAMILY_L_aov <- aov(DAY50_dead_agranular_BAD_REMOVED_FAMILY_L$Arcsine ~ DAY50_dead_agranular_BAD_REMOVED_FAMILY_L$GROUP, data=DAY50_dead_agranular_BAD_REMOVED_FAMILY_L)
summary(DAY50_dead_agranular_BAD_REMOVED_FAMILY_L_aov)
```

### Two-Way ANOVA of Dead Apoptotic Agranular Hemocytes ###


```{r day50_dead_apoptotic_agranular_twoway, echo=TRUE}
DAY50_PLOT4_dead_apoptotic_agranular_BAD_REMOVED_lm <- lm(DAY50_dead_agranular_BAD_REMOVED$Arcsine ~DAY50_dead_agranular_BAD_REMOVED$GROUP + DAY50_dead_agranular_BAD_REMOVED$FAMILY, data=DAY50_dead_agranular_BAD_REMOVED)

Anova(DAY50_PLOT4_dead_apoptotic_agranular_BAD_REMOVED_lm, type="II") # no significance
summary(DAY50_APOP_PLOT7_live_apoptotic_agranular_BAD_REMOVED_lm) # no significance
```

## One Way ANOVA of just challenged Dead Apoptotic Agranular 

```{r Day50_dead_apoptotic_agranular_oneway_double, echo=TRUE}
DAY50_PLOT4_dead_apoptotic_agranular_BAD_REMOVED_CHALLENGE <- DAY50_dead_agranular_BAD_REMOVED[!grepl("control",DAY50_dead_agranular_BAD_REMOVED$GROUP),]

DAY50_PLOT4_dead_apoptotic_agranular_oneway_aov <- aov(DAY50_PLOT4_dead_apoptotic_agranular_BAD_REMOVED_CHALLENGE$Arcsine ~ DAY50_PLOT4_dead_apoptotic_agranular_BAD_REMOVED_CHALLENGE$FAMILY, data=DAY50_PLOT4_dead_apoptotic_agranular_BAD_REMOVED_CHALLENGE)
summary(DAY50_PLOT4_dead_apoptotic_agranular_oneway_aov) # significantly different between families 
```

### Two Way ANOVA of Dead Apoptotic Hemocytes ###

```{r day50_dead_apoptotic_cells_twoway, echo=TRUE}

DAY50_dead_granular_agranular_combined <- rbind(DAY50_dead_agranular_BAD_REMOVED,DAY50_dead_granular_BAD_REMOVED)

ggplot(DAY50_dead_granular_agranular_combined, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + facet_grid(.~FAMILY+GROUP, scales="free") + geom_boxplot() + ggtitle("Percent of Granular and Agranular Dead Apoptotic Hemocytes at Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot")  +scale_fill_manual(name="Hemocyte Type", labels=c("Live Agranular", "Live Granular"), values=c("Q1_UR"="#99a765","Q2_UR"="#96578a")) 

# Two way ANOVA
DAY50_dead_granular_agranular_aov <- lm(DAY50_dead_granular_agranular_combined$Arcsine ~DAY50_dead_granular_agranular_combined$FAMILY + DAY50_dead_granular_agranular_combined$GATE, data=DAY50_dead_granular_agranular_combined)
Anova(DAY50_dead_granular_agranular_aov, type="II") #GATE is significant
summary(DAY50_dead_granular_agranular_aov)

# Two- Way ANOVA with interaction
DAY50_dead_granular_agranular_aov_interaction <- lm(DAY50_dead_granular_agranular_combined$Arcsine ~DAY50_dead_granular_agranular_combined$FAMILY + DAY50_dead_granular_agranular_combined$GATE + DAY50_dead_granular_agranular_combined$FAMILY:DAY50_dead_granular_agranular_combined$GATE, data=DAY50_dead_granular_agranular_combined)
Anova(DAY50_dead_granular_agranular_aov_interaction, type="II") #GATE is significant
summary(DAY50_dead_granular_agranular_aov_interaction)

DAY50_dead_granular_agranula_aov_gate_leastsquares <- lsmeans(DAY50_dead_granular_agranular_aov_interaction, "DAY50_dead_granular_agranular_combined$GATE", adjust="tukey")
cld(DAY50_dead_granular_agranula_aov_gate_leastsquares, alpha=0.05, Letters=letters) # the means of the two groups not different

DAY50_live_granular_agranula_aov_interaction_leastsquares_family <- lsmeans(DAY50_live_granular_agranular_aov_interaction, "DAY50_live_granular_agranular_combined$FAMILY", adjust="tukey")
cld(DAY50_live_granular_agranula_aov_interaction_leastsquares_family, alpha=0.05, Letters=letters) # the means of the groups are not significantly different 
```

### Plotting of Combined DAY 7 and DAY 50 for live and dead hemocytes

```{r dead_apop_7_50_plotting, echo=TRUE}

DAY50_dead_granular_agranular_combined$DAY <- "50" 
DAY50_live_granular_agranular_combined$DAY <- "50"
APOP_Live_apoptotic_combined_all$DAY <- "07" 
combined_dead_apoptotic_agranular_granular$DAY <- "07"

DAY50_dead_granular_agranular_combined_subset <- DAY50_dead_granular_agranular_combined[,c("SAMPLE_ID", "FAMILY","ASSAY","PERCENT_OF_THIS_PLOT", "GATE","DAY","GROUP", "PLOT")]
DAY50_live_granular_agranular_combined_subset <-DAY50_live_granular_agranular_combined[,c("SAMPLE_ID", "FAMILY","ASSAY","PERCENT_OF_THIS_PLOT", "GATE","DAY","GROUP","PLOT")]
APOP_Live_apoptotic_combined_all_subset <- APOP_Live_apoptotic_combined_all[,c("SAMPLE_ID", "FAMILY","ASSAY","PERCENT_OF_THIS_PLOT", "GATE","DAY","GROUP","PLOT")]
combined_dead_apoptotic_agranular_granular_subset <-combined_dead_apoptotic_agranular_granular[,c("SAMPLE_ID", "FAMILY","ASSAY","PERCENT_OF_THIS_PLOT", "GATE","DAY","GROUP","PLOT")]

all_apoptotic_DAY7_DAY50 <- rbind(DAY50_dead_granular_agranular_combined_subset,DAY50_live_granular_agranular_combined_subset, APOP_Live_apoptotic_combined_all_subset, combined_dead_apoptotic_agranular_granular_subset)


# Overall with all families included
#to change the labels in the plot below 

combined_families <- ggplot(all_apoptotic_DAY7_DAY50, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + geom_boxplot() + ggtitle("Percent of Granular and Agranular Live and Dead Apoptotic Hemocytes \n on Day 7 and Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + facet_grid(.~DAY+GROUP, scales="free") + scale_fill_manual(name="Hemocyte Type", labels=c("Live Apoptotic Granular","Dead Apoptotic Agranular", "Live Apoptotic Granular","Dead Apoptotic Granular"), values=c("Q1_LR"="#969e4a","Q1_UR"="#9250a2", "Q2_LR"="#b9515a", "Q2_UR"="#6785d7")) 

#BEST PLOT
#combined_families_bar <- 
  ggplot(all_apoptotic_DAY7_DAY50, aes(x=DAY, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + 
  geom_col(position=position_dodge()) + 
  ggtitle("Percent of Granular and Agranular Live and Dead Apoptotic Hemocytes \n on Day 7 and Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + 
  facet_grid(GROUP~FAMILY, scales="free") + 
  scale_fill_manual(name="Hemocyte Type", labels=c("Live Apoptotic Agranular","Dead Apoptotic Agranular", "Live Apoptotic Granular","Dead Apoptotic Granular"), 
                    values=c("Q1_LR"="#969e4a","Q1_UR"="#9250a2", "Q2_LR"="#b9515a", "Q2_UR"="#6785d7")) 

# By GATE and DAY and GROUP
gate_names <- c("Q1_LR"="Live Apoptotic Agranular", "Q1_UR"="Dead Apoptotic Agranular", "Q2_LR"="Live Apoptotic Granular", "Q2_UR"="Dead Apoptotic Granular")
families_separated <- ggplot(all_apoptotic_DAY7_DAY50, aes(x=DAY, y=PERCENT_OF_THIS_PLOT, fill=FAMILY)) + geom_boxplot() + ggtitle("Percent of Granular and Agranular Live and Dead Apoptotic Hemocytes \n on Day 7 and Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + facet_grid(.~GATE, scales="free", labeller = as_labeller((gate_names)))  + scale_fill_manual(name="Family", labels=c("A","B","D","E","J","L"), values=c("A"="#6971c9","B"="#86a542", "D"="#a24f99", "E"="#50b47b","J"="#ba4855","L"="#c07d37")) 

# Put the plots together
ggarrange(combined_families,families_separated, labels=c("A","B"), ncol=1,nrow=2)


```

#### Necrotic Granular Cells #### 

```{r necrotic_granular_day50, include=TRUE, echo=TRUE}
DAY50_necrotic_granular <- DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(GATE=="Q2_UL")

DAY50_APOP_necrotic_granular_BAD_NOT_REMOVED <- ggplot(data=DAY50_necrotic_granular, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Granular Hemocytes at Day 50 \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 

DAY50_necrotic_granular_BAD_REMOVED <- DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(GATE=="Q2_UL")
DAY50_APOP_necrotic_granular_BAD_REMOVED <- ggplot(data= DAY50_necrotic_granular_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Granular Hemocytes at Day 50 \nLow Quality Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 
DAY50_APOP_necrotic_granular_BAD_REMOVED
```

### FAMILY A 
```{r day50_necrotic_granularfamilyA, echo=TRUE}
DAY50_necrotic_granular_FAMILY_A <- DAY50_necrotic_granular %>% filter(FAMILY=="A")

DAY50_necrotic_granular_FAMILY_A_aov <- aov(DAY50_necrotic_granular_FAMILY_A$Arcsine ~ DAY50_necrotic_granular_FAMILY_A$GROUP, data=DAY50_necrotic_granular_FAMILY_A)
summary(DAY50_necrotic_granular_FAMILY_A_aov)

DAY50_necrotic_granular_BAD_REMOVED_FAMILY_A <- DAY50_necrotic_granular_BAD_REMOVED %>% filter(FAMILY=="A") 
DAY50_necrotic_granular_BAD_REMOVED_FAMILY_A_aov <- aov(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_A$Arcsine ~ DAY50_necrotic_granular_BAD_REMOVED_FAMILY_A$GROUP, data=DAY50_necrotic_granular_BAD_REMOVED_FAMILY_A)
summary(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_A_aov)
```

### FAMILY B
```{r day50_necrotic_granularfamilyB, echo=TRUE}
DAY50_necrotic_granular_FAMILY_B <- DAY50_necrotic_granular %>% filter(FAMILY=="B")

DAY50_necrotic_granular_FAMILY_B_aov <- aov(DAY50_necrotic_granular_FAMILY_B$Arcsine ~ DAY50_necrotic_granular_FAMILY_B$GROUP, data=DAY50_necrotic_granular_FAMILY_B)
summary(DAY50_necrotic_granular_FAMILY_B_aov)

DAY50_necrotic_granular_BAD_REMOVED_FAMILY_B <- DAY50_necrotic_granular_BAD_REMOVED %>% filter(FAMILY=="B") 
DAY50_necrotic_granular_BAD_REMOVED_FAMILY_B_aov <- aov(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_B$Arcsine ~ DAY50_necrotic_granular_BAD_REMOVED_FAMILY_B$GROUP, data=DAY50_necrotic_granular_BAD_REMOVED_FAMILY_B)
summary(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_B_aov)
```

### FAMILY D
```{r day50_necrotic_granularfamilyD, echo=TRUE}
DAY50_necrotic_granular_FAMILY_D <- DAY50_necrotic_granular %>% filter(FAMILY=="D")

DAY50_necrotic_granular_FAMILY_D_aov <- aov(DAY50_necrotic_granular_FAMILY_D$Arcsine ~ DAY50_necrotic_granular_FAMILY_D$GROUP, data=DAY50_necrotic_granular_FAMILY_D)
summary(DAY50_necrotic_granular_FAMILY_D_aov)

DAY50_necrotic_granular_BAD_REMOVED_FAMILY_D <- DAY50_necrotic_granular_BAD_REMOVED %>% filter(FAMILY=="D") 
DAY50_necrotic_granular_BAD_REMOVED_FAMILY_D_aov <- aov(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_D$Arcsine ~ DAY50_necrotic_granular_BAD_REMOVED_FAMILY_D$GROUP, data=DAY50_necrotic_granular_BAD_REMOVED_FAMILY_D)
summary(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_D_aov)
```

### FAMILY E
```{r day50_necrotic_granularfamilyE, echo=TRUE}
DAY50_necrotic_granular_FAMILY_E <- DAY50_necrotic_granular %>% filter(FAMILY=="E")

DAY50_necrotic_granular_FAMILY_E_aov <- aov(DAY50_necrotic_granular_FAMILY_E$Arcsine ~ DAY50_necrotic_granular_FAMILY_E$GROUP, data=DAY50_necrotic_granular_FAMILY_E)
summary(DAY50_necrotic_granular_FAMILY_E_aov)

DAY50_necrotic_granular_BAD_REMOVED_FAMILY_E <- DAY50_necrotic_granular_BAD_REMOVED %>% filter(FAMILY=="E") 
DAY50_necrotic_granular_BAD_REMOVED_FAMILY_E_aov <- aov(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_E$Arcsine ~ DAY50_necrotic_granular_BAD_REMOVED_FAMILY_E$GROUP, data=DAY50_necrotic_granular_BAD_REMOVED_FAMILY_E)
summary(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_E_aov)
```

### FAMILY J
```{r day50_necrotic_granularfamilyJ, echo=TRUE}
DAY50_necrotic_granular_FAMILY_J <- DAY50_necrotic_granular %>% filter(FAMILY=="J")

DAY50_necrotic_granular_FAMILY_J_aov <- aov(DAY50_necrotic_granular_FAMILY_J$Arcsine ~ DAY50_necrotic_granular_FAMILY_J$GROUP, data=DAY50_necrotic_granular_FAMILY_J)
summary(DAY50_necrotic_granular_FAMILY_J_aov)

DAY50_necrotic_granular_BAD_REMOVED_FAMILY_J <- DAY50_necrotic_granular_BAD_REMOVED %>% filter(FAMILY=="J") 
DAY50_necrotic_granular_BAD_REMOVED_FAMILY_J_aov <- aov(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_J$Arcsine ~ DAY50_necrotic_granular_BAD_REMOVED_FAMILY_J$GROUP, data=DAY50_necrotic_granular_BAD_REMOVED_FAMILY_J)
summary(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_J_aov)
```

### FAMILY L
```{r day50_necrotic_granularfamilyL, echo=TRUE}
DAY50_necrotic_granular_FAMILY_L <- DAY50_necrotic_granular %>% filter(FAMILY=="L")

DAY50_necrotic_granular_FAMILY_L_aov <- aov(DAY50_necrotic_granular_FAMILY_L$Arcsine ~ DAY50_necrotic_granular_FAMILY_L$GROUP, data=DAY50_necrotic_granular_FAMILY_L)
summary(DAY50_necrotic_granular_FAMILY_L_aov)

DAY50_necrotic_granular_BAD_REMOVED_FAMILY_L <- DAY50_necrotic_granular_BAD_REMOVED %>% filter(FAMILY=="L") 
DAY50_necrotic_granular_BAD_REMOVED_FAMILY_L_aov <- aov(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_L$Arcsine ~ DAY50_necrotic_granular_BAD_REMOVED_FAMILY_L$GROUP, data=DAY50_necrotic_granular_BAD_REMOVED_FAMILY_L)
summary(DAY50_necrotic_granular_BAD_REMOVED_FAMILY_L_aov)
```

### Two Way ANOVA of Necrotic Granular ###

```{r day50_twoway_necrotic_granular, echo=TRUE}
DAY50_necrotic_granular_twoway_BAD_REMOVED_lm <- lm(DAY50_necrotic_granular_BAD_REMOVED$Arcsine ~ DAY50_necrotic_granular_BAD_REMOVED$GROUP + DAY50_necrotic_granular_BAD_REMOVED$FAMILY, data=DAY50_necrotic_granular_BAD_REMOVED)
Anova(DAY50_necrotic_granular_twoway_BAD_REMOVED_lm, type="II")
summary(DAY50_necrotic_granular_twoway_BAD_REMOVED_lm)

```

### One Way ANOVA of Necrotic Granular Just Challenged


```{r Day50_necrotic_granular_oneway, echo=TRUE}
DAY50_necrotic_granular_BAD_REMOVED_CHALLENGE <- DAY50_necrotic_granular_BAD_REMOVED[!grepl("control", DAY50_necrotic_granular_BAD_REMOVED$GROUP),]

DAY50_necrotic_granular_BAD_REMOVED_CHALLENGE_aov <- aov(DAY50_necrotic_granular_BAD_REMOVED_CHALLENGE$Arcsine ~ DAY50_necrotic_granular_BAD_REMOVED_CHALLENGE$FAMILY, data=DAY50_necrotic_granular_BAD_REMOVED_CHALLENGE)
summary(DAY50_necrotic_granular_BAD_REMOVED_CHALLENGE_aov) # significantly different between families 
```

#### Necrotic Agranular Cells #### 

```{r necrotic_agranular_day50, echo=TRUE}
DAY50_necrotic_agranular <- DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(GATE=="Q1_UL")

DAY50_necrotic_agranular_BAD_NOT_REMOVED <- ggplot(data=DAY50_necrotic_agranular, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Agranular Hemocytes at Day 50 \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 

DAY50_necrotic_agranular_BAD_REMOVED <- DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(GATE=="Q1_UL")
DAY50_APOP_necrotic_agranular_BAD_REMOVED <- ggplot(data= DAY50_necrotic_agranular_BAD_REMOVED , aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Necrotic Agranular Hemocytes at Day 50 \nLow Quality Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 
DAY50_APOP_necrotic_agranular_BAD_REMOVED
```

### FAMILY A
```{r day50_necrotic_agranularfamilyA, echo=TRUE}
DAY50_necrotic_agranular_FAMILY_A <- DAY50_necrotic_agranular %>% filter(FAMILY=="A")

DAY50_necrotic_agranular_FAMILY_A_aov <- aov(DAY50_necrotic_agranular_FAMILY_A$Arcsine ~ DAY50_necrotic_agranular_FAMILY_A$GROUP, data=DAY50_necrotic_agranular_FAMILY_A)
summary(DAY50_necrotic_agranular_FAMILY_A_aov)

DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_A <- DAY50_necrotic_agranular_BAD_REMOVED %>% filter(FAMILY=="A") 
DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_A_aov <- aov(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_A$Arcsine ~ DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_A$GROUP, data=DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_A)
summary(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_A_aov)
```

### FAMILY B
```{r day50_necrotic_agranularfamilyB, echo=TRUE}
DAY50_necrotic_agranular_FAMILY_B <- DAY50_necrotic_agranular %>% filter(FAMILY=="B")

DAY50_necrotic_agranular_FAMILY_B_aov <- aov(DAY50_necrotic_agranular_FAMILY_B$Arcsine ~ DAY50_necrotic_agranular_FAMILY_B$GROUP, data=DAY50_necrotic_agranular_FAMILY_B)
summary(DAY50_necrotic_agranular_FAMILY_B_aov)

DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_B <- DAY50_necrotic_agranular_BAD_REMOVED %>% filter(FAMILY=="B") 
DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_B_aov <- aov(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_B$Arcsine ~ DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_B$GROUP, data=DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_B)
summary(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_B_aov)
```

### FAMILY D
```{r day50_necrotic_agranularfamilyD, echo=TRUE}
DAY50_necrotic_agranular_FAMILY_D <- DAY50_necrotic_agranular %>% filter(FAMILY=="D")

DAY50_necrotic_agranular_FAMILY_D_aov <- aov(DAY50_necrotic_agranular_FAMILY_D$Arcsine ~ DAY50_necrotic_agranular_FAMILY_D$GROUP, data=DAY50_necrotic_agranular_FAMILY_D)
summary(DAY50_necrotic_agranular_FAMILY_D_aov)

DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_D <- DAY50_necrotic_agranular_BAD_REMOVED %>% filter(FAMILY=="D") 
DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_D_aov <- aov(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_D$Arcsine ~ DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_D$GROUP, data=DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_D)
summary(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_D_aov)
```

### FAMILY E
```{r day50_necrotic_agranularfamilyE, echo=TRUE}
DAY50_necrotic_agranular_FAMILY_E <- DAY50_necrotic_agranular %>% filter(FAMILY=="E")

DAY50_necrotic_agranular_FAMILY_E_aov <- aov(DAY50_necrotic_agranular_FAMILY_E$Arcsine ~ DAY50_necrotic_agranular_FAMILY_E$GROUP, data=DAY50_necrotic_agranular_FAMILY_E)
summary(DAY50_necrotic_agranular_FAMILY_E_aov)

DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_E <- DAY50_necrotic_agranular_BAD_REMOVED %>% filter(FAMILY=="E") 
DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_E_aov <- aov(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_E$Arcsine ~ DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_E$GROUP, data=DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_E)
summary(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_E_aov)
```

### FAMILY J
```{r day50_necrotic_agranularfamilyJ, echo=TRUE}
DAY50_necrotic_agranular_FAMILY_J <- DAY50_necrotic_agranular %>% filter(FAMILY=="J")

DAY50_necrotic_agranular_FAMILY_J_aov <- aov(DAY50_necrotic_agranular_FAMILY_J$Arcsine ~ DAY50_necrotic_agranular_FAMILY_J$GROUP, data=DAY50_necrotic_agranular_FAMILY_J)
summary(DAY50_necrotic_agranular_FAMILY_J_aov)

DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_J <- DAY50_necrotic_agranular_BAD_REMOVED %>% filter(FAMILY=="J") 
DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_J_aov <- aov(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_J$Arcsine ~ DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_J$GROUP, data=DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_J)
summary(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_J_aov)
```

### FAMILY L
```{r day50_necrotic_agranularfamilyL, echo=TRUE}
DAY50_necrotic_agranular_FAMILY_L <- DAY50_necrotic_agranular %>% filter(FAMILY=="L")

DAY50_necrotic_agranular_FAMILY_L_aov <- aov(DAY50_necrotic_agranular_FAMILY_L$Arcsine ~ DAY50_necrotic_agranular_FAMILY_L$GROUP, data=DAY50_necrotic_agranular_FAMILY_L)
summary(DAY50_necrotic_agranular_FAMILY_L_aov)

DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_L <- DAY50_necrotic_agranular_BAD_REMOVED %>% filter(FAMILY=="L") 
DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_L_aov <- aov(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_L$Arcsine ~ DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_L$GROUP, data=DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_L)
summary(DAY50_necrotic_agranular_BAD_REMOVED_FAMILY_L_aov)
```

### Two Way ANOVA of Necrotic Agranular ###

```{r day50_twoway_necrotic_agranular, echo=TRUE}
DAY50_necrotic_agranular_twoway_BAD_REMOVED_lm <- lm(DAY50_necrotic_agranular_BAD_REMOVED$Arcsine ~ DAY50_necrotic_agranular_BAD_REMOVED$GROUP + DAY50_necrotic_agranular_BAD_REMOVED$FAMILY, data=DAY50_necrotic_agranular_BAD_REMOVED)
Anova(DAY50_necrotic_agranular_twoway_BAD_REMOVED_lm , type="II")
summary(DAY50_necrotic_agranular_twoway_BAD_REMOVED_lm)

```

### One Way ANOVA of Necrotic Agranular Just Challenged

```{r Day50_necrotic_agranular_oneway, echo=TRUE}
DAY50_necrotic_agranular_BAD_REMOVED_CHALLENGE <- DAY50_necrotic_agranular_BAD_REMOVED[!grepl("control", DAY50_necrotic_agranular_BAD_REMOVED$GROUP),]

DAY50_necrotic_agranular_BAD_REMOVED_CHALLENGE_aov <- aov(DAY50_necrotic_agranular_BAD_REMOVED_CHALLENGE$Arcsine ~ DAY50_necrotic_agranular_BAD_REMOVED_CHALLENGE$FAMILY, data=DAY50_necrotic_agranular_BAD_REMOVED_CHALLENGE)
summary(DAY50_necrotic_agranular_BAD_REMOVED_CHALLENGE_aov) # significantly different between families 
```

## Two Way ANOVA of Necrotic cells ###

```{r day50_necrotic_cells_twoway, echo=TRUE}

DAY50_necrotic_granular_agranular_combined <- rbind(DAY50_necrotic_granular_BAD_REMOVED,DAY50_necrotic_agranular_BAD_REMOVED)

ggplot(DAY50_necrotic_granular_agranular_combined, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + facet_grid(.~FAMILY+GROUP, scales="free") + geom_boxplot() + ggtitle("Percent of Granular and Agranular Necrotic Hemocytes at Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot")  +scale_fill_manual(name="Hemocyte Type", labels=c("Necrotic Granular", "Necrotic Agranular"), values=c("Q2_UL"="#99a765","Q1_UL"="#96578a")) 

# Two way ANOVA
DAY50_necrotic_granular_agranular_aov <- lm(DAY50_necrotic_granular_agranular_combined$Arcsine ~DAY50_necrotic_granular_agranular_combined$FAMILY + DAY50_necrotic_granular_agranular_combined$GATE, data=DAY50_necrotic_granular_agranular_combined)
Anova(DAY50_necrotic_granular_agranular_aov , type="II") #GATE is significant
summary(DAY50_necrotic_granular_agranular_aov )

# Two- Way ANOVA with interaction
DAY50_necrotic_granular_agranular_aov_interaction <- lm(DAY50_necrotic_granular_agranular_combined$Arcsine ~DAY50_necrotic_granular_agranular_combined$FAMILY + DAY50_necrotic_granular_agranular_combined$GATE + DAY50_necrotic_granular_agranular_combined$FAMILY:DAY50_necrotic_granular_agranular_combined$GATE, data=DAY50_necrotic_granular_agranular_combined)
Anova(DAY50_necrotic_granular_agranular_aov_interaction, type="II") #GATE is significant
summary(DAY50_necrotic_granular_agranular_aov_interaction)

DAY50_necrotic_granular_agranular_aov_gate_leastsquares <- lsmeans(DAY50_necrotic_granular_agranular_aov_interaction, "DAY50_necrotic_granular_agranular_combined$GATE", adjust="tukey")
cld(DAY50_necrotic_granular_agranular_aov_gate_leastsquares, alpha=0.05, Letters=letters) # the means of the two groups not different

```

#### Live Non-Apoptotic Granular cells ####

```{r live_non_apoptotic_granular_day50, include=TRUE, echo=TRUE}
DAY50_live_non_apoptotic_granular <- DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT %>% filter(GATE=="Q2_LL")

DAY50_live_non_apoptotic_granular_BAD_NOT_REMOVED_plot <- ggplot(data=DAY50_live_granular, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Non-Apoptotic Granular Hemocytes at Day 50 \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 

DAY50_live_non_apoptotic_granular_BAD_REMOVED <- DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED %>% filter(GATE=="Q2_LL")
DAY50_live_non_apoptotic_granular_BAD_REMOVED_plot <- ggplot(data= DAY50_live_non_apoptotic_granular_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Non-Apoptotic Granulr Hemocytes at Day 50 \nLow Quality Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 
DAY50_live_non_apoptotic_granular_BAD_REMOVED_plot
```

### FAMILY A 
```{r day50_live_non_apoptotic_granularfamilyA, echo=TRUE}
DAY50_live_non_apoptotic_granular_FAMILY_A <- DAY50_live_non_apoptotic_granular %>% filter(FAMILY=="A")

DAY50_live_non_apoptotic_granular_FAMILY_A_aov <- aov(DAY50_live_non_apoptotic_granular_FAMILY_A$Arcsine ~ DAY50_live_non_apoptotic_granular_FAMILY_A$GROUP, data=DAY50_live_non_apoptotic_granular_FAMILY_A)
summary(DAY50_live_non_apoptotic_granular_FAMILY_A_aov)

DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_A <- DAY50_live_non_apoptotic_granular_BAD_REMOVED %>% filter(FAMILY=="A") 
DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_A_aov <- aov(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_A$Arcsine ~ DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_A$GROUP, data=DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_A)
summary(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_A_aov)
```

### FAMILY B
```{r day50_live_non_apoptotic_granularfamilyB, echo=TRUE}
DAY50_live_non_apoptotic_granular_FAMILY_B <- DAY50_live_non_apoptotic_granular %>% filter(FAMILY=="B")

DAY50_live_non_apoptotic_granular_FAMILY_B_aov <- aov(DAY50_live_non_apoptotic_granular_FAMILY_B$Arcsine ~ DAY50_live_non_apoptotic_granular_FAMILY_B$GROUP, data=DAY50_live_non_apoptotic_granular_FAMILY_B)
summary(DAY50_live_non_apoptotic_granular_FAMILY_B_aov)

DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_B <- DAY50_live_non_apoptotic_granular_BAD_REMOVED %>% filter(FAMILY=="B") 
DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_B_aov <- aov(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_B$Arcsine ~ DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_B$GROUP, data=DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_B)
summary(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_B_aov)
```

### FAMILY D
```{r day50_live_non_apoptotic_granularfamilyD, echo=TRUE}
DAY50_live_non_apoptotic_granular_FAMILY_D <- DAY50_live_non_apoptotic_granular %>% filter(FAMILY=="D")

DAY50_live_non_apoptotic_granular_FAMILY_D_aov <- aov(DAY50_live_non_apoptotic_granular_FAMILY_D$Arcsine ~ DAY50_live_non_apoptotic_granular_FAMILY_D$GROUP, data=DAY50_live_non_apoptotic_granular_FAMILY_D)
summary(DAY50_live_non_apoptotic_granular_FAMILY_D_aov)

DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_D <- DAY50_live_non_apoptotic_granular_BAD_REMOVED %>% filter(FAMILY=="D") 
DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_D_aov <- aov(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_D$Arcsine ~ DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_D$GROUP, data=DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_D)
summary(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_D_aov)
```

### FAMILY E
```{r day50_live_granularfamilyE, echo=TRUE}
DAY50_live_non_apoptotic_granular_FAMILY_E <- DAY50_live_non_apoptotic_granular %>% filter(FAMILY=="E")

DAY50_live_non_apoptotic_granular_FAMILY_E_aov <- aov(DAY50_live_non_apoptotic_granular_FAMILY_E$Arcsine ~ DAY50_live_non_apoptotic_granular_FAMILY_E$GROUP, data=DAY50_live_non_apoptotic_granular_FAMILY_E)
summary(DAY50_live_non_apoptotic_granular_FAMILY_E_aov)

DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_E <- DAY50_live_non_apoptotic_granular_BAD_REMOVED %>% filter(FAMILY=="E") 
DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_E_aov <- aov(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_E$Arcsine ~ DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_E$GROUP, data=DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_E)
summary(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_E_aov)
```

### FAMILY J 
```{r day50_live_granularfamilyJ, echo=TRUE}
DAY50_live_non_apoptotic_granular_FAMILY_J <- DAY50_live_non_apoptotic_granular %>% filter(FAMILY=="J")

DAY50_live_non_apoptotic_granular_FAMILY_J_aov <- aov(DAY50_live_non_apoptotic_granular_FAMILY_J$Arcsine ~ DAY50_live_non_apoptotic_granular_FAMILY_J$GROUP, data=DAY50_live_non_apoptotic_granular_FAMILY_J)
summary(DAY50_live_non_apoptotic_granular_FAMILY_J_aov)

DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_J <- DAY50_live_non_apoptotic_granular_BAD_REMOVED %>% filter(FAMILY=="J") 
DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_J_aov <- aov(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_J$Arcsine ~ DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_J$GROUP, data=DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_J)
summary(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_J_aov)
```

### FAMILY L 
```{r day50_live_granularfamilyL, echo=TRUE}
DAY50_live_non_apoptotic_granular_FAMILY_L <- DAY50_live_non_apoptotic_granular %>% filter(FAMILY=="L")

DAY50_live_non_apoptotic_granular_FAMILY_L_aov <- aov(DAY50_live_non_apoptotic_granular_FAMILY_L$Arcsine ~ DAY50_live_non_apoptotic_granular_FAMILY_L$GROUP, data=DAY50_live_non_apoptotic_granular_FAMILY_L)
summary(DAY50_live_non_apoptotic_granular_FAMILY_L_aov)

DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_L <- DAY50_live_non_apoptotic_granular_BAD_REMOVED %>% filter(FAMILY=="L") 
DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_L_aov <- aov(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_L$Arcsine ~ DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_L$GROUP, data=DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_L)
summary(DAY50_live_non_apoptotic_granular_BAD_REMOVED_FAMILY_L_aov)
```

### Two Way ANOVA of Live Non-Apoptotic Granular ###

```{r day50_twoway_live_non_apoptotic_granular, echo=TRUE}
DAY50_live_non_apoptotic_granular_twoway_BAD_REMOVED_lm <- lm(DAY50_live_non_apoptotic_granular_BAD_REMOVED$Arcsine ~ DAY50_live_non_apoptotic_granular_BAD_REMOVED$GROUP + DAY50_live_granular_BAD_REMOVED$FAMILY, data=DAY50_live_non_apoptotic_granular_BAD_REMOVED)
Anova(DAY50_live_non_apoptotic_granular_twoway_BAD_REMOVED_lm, type="II")
summary(DAY50_live_non_apoptotic_granular_twoway_BAD_REMOVED_lm)

```

### One Way ANOVA of Live Non-Apoptotic Granular Just Challenged


```{r Day50_live_non_apoptotic_granular_oneway, echo=TRUE}
DAY50_live_non_apoptotic_granular_BAD_REMOVED_CHALLENGE <- DAY50_live_non_apoptotic_granular_BAD_REMOVED[!grepl("control", DAY50_live_non_apoptotic_granular_BAD_REMOVED$GROUP),]

DAY50_live_non_apoptotic_granular_BAD_REMOVED_CHALLENGE_aov <- aov(DAY50_live_non_apoptotic_granular_BAD_REMOVED_CHALLENGE$Arcsine ~ DAY50_live_non_apoptotic_granular_BAD_REMOVED_CHALLENGE$FAMILY, data=DAY50_live_non_apoptotic_granular_BAD_REMOVED_CHALLENGE)
summary(DAY50_live_non_apoptotic_granular_BAD_REMOVED_CHALLENGE_aov) # significantly different between families 
```

## Live Non-Apoptotic Agranular ####

```{r live_non_apoptotic_agranular_day50, include=TRUE, echo=TRUE}
DAY50_live_non_apoptotic_agranular <- DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(GATE=="Q1_LL")

DAY50_live_non_apoptotic_agranular_BAD_NOT_REMOVED_plot <- ggplot(data=DAY50_live_non_apoptotic_agranular, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Non-Apoptotic Agranular Hemocytes at Day 50 \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 

DAY50_live_non_apoptotic_agranular_BAD_REMOVED <- DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT %>% filter(GATE=="Q1_LL")

DAY50_live_non_apoptotic_agranular_BAD_REMOVED_plot <- ggplot(data=DAY50_live_non_apoptotic_agranular_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Non-Apoptotic Agranular Hemocytes at Day 50 \nLow Quality Removed") + xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)+ facet_grid(.~FAMILY+GROUP, scales="free") 
DAY50_live_non_apoptotic_agranular_BAD_REMOVED_plot
```

### FAMILY A 
```{r day50_live_non_apoptotic_agranularfamilyA, echo=TRUE}
DAY50_live_non_apoptotic_agranular_FAMILY_A <- DAY50_live_non_apoptotic_agranular %>% filter(FAMILY=="A")

DAY50_live_non_apoptotic_agranular_FAMILY_A_aov <- aov(DAY50_live_non_apoptotic_agranular_FAMILY_A$Arcsine ~ DAY50_live_non_apoptotic_agranular_FAMILY_A$GROUP, data=DAY50_live_non_apoptotic_agranular_FAMILY_A)
summary(DAY50_live_non_apoptotic_agranular_FAMILY_A_aov)

DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_A <- DAY50_live_non_apoptotic_agranular_BAD_REMOVED %>% filter(FAMILY=="A") 
DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_A_aov <- aov(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_A$Arcsine ~ DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_A$GROUP, data=DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_A)
summary(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_A_aov)
```

### FAMILY B 
```{r day50_live_non_apoptotic_agranularfamilyB, echo=TRUE}
DAY50_live_non_apoptotic_agranular_FAMILY_B <- DAY50_live_non_apoptotic_agranular %>% filter(FAMILY=="B")

DAY50_live_non_apoptotic_agranular_FAMILY_B_aov <- aov(DAY50_live_non_apoptotic_agranular_FAMILY_B$Arcsine ~ DAY50_live_non_apoptotic_agranular_FAMILY_B$GROUP, data=DAY50_live_non_apoptotic_agranular_FAMILY_B)
summary(DAY50_live_non_apoptotic_agranular_FAMILY_B_aov)

DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_B <- DAY50_live_non_apoptotic_agranular_BAD_REMOVED %>% filter(FAMILY=="B") 
DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_B_aov <- aov(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_B$Arcsine ~ DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_B$GROUP, data=DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_B)
summary(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_B_aov)
```

### FAMILY D
```{r day50_live_non_apoptotic_agranularfamilyD, echo=TRUE}
DAY50_live_non_apoptotic_agranular_FAMILY_D <- DAY50_live_non_apoptotic_agranular %>% filter(FAMILY=="D")

DAY50_live_non_apoptotic_agranular_FAMILY_D_aov <- aov(DAY50_live_non_apoptotic_agranular_FAMILY_D$Arcsine ~ DAY50_live_non_apoptotic_agranular_FAMILY_D$GROUP, data=DAY50_live_non_apoptotic_agranular_FAMILY_D)
summary(DAY50_live_non_apoptotic_agranular_FAMILY_D_aov)

DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_D <- DAY50_live_non_apoptotic_agranular_BAD_REMOVED %>% filter(FAMILY=="D") 
DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_D_aov <- aov(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_D$Arcsine ~ DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_D$GROUP, data=DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_D)
summary(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_D_aov)
```

### FAMILY E
```{r day50_live_non_apoptotic_agranularfamilyE, echo=TRUE}
DAY50_live_non_apoptotic_agranular_FAMILY_E <- DAY50_live_non_apoptotic_agranular %>% filter(FAMILY=="E")

DAY50_live_non_apoptotic_agranular_FAMILY_E_aov <- aov(DAY50_live_non_apoptotic_agranular_FAMILY_E$Arcsine ~ DAY50_live_non_apoptotic_agranular_FAMILY_E$GROUP, data=DAY50_live_non_apoptotic_agranular_FAMILY_E)
summary(DAY50_live_non_apoptotic_agranular_FAMILY_E_aov)

DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_E <- DAY50_live_non_apoptotic_agranular_BAD_REMOVED %>% filter(FAMILY=="E") 
DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_E_aov <- aov(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_E$Arcsine ~ DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_E$GROUP, data=DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_E)
summary(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_E_aov)
```

### FAMILY J
```{r day50_live_non_apoptotic_agranularfamilyJ, echo=TRUE}
DAY50_live_non_apoptotic_agranular_FAMILY_J <- DAY50_live_non_apoptotic_agranular %>% filter(FAMILY=="J")

DAY50_live_non_apoptotic_agranular_FAMILY_J_aov <- aov(DAY50_live_non_apoptotic_agranular_FAMILY_J$Arcsine ~ DAY50_live_non_apoptotic_agranular_FAMILY_J$GROUP, data=DAY50_live_non_apoptotic_agranular_FAMILY_J)
summary(DAY50_live_non_apoptotic_agranular_FAMILY_J_aov)

DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_J <- DAY50_live_non_apoptotic_agranular_BAD_REMOVED %>% filter(FAMILY=="J") 
DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_J_aov <- aov(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_J$Arcsine ~ DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_J$GROUP, data=DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_J)
summary(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_J_aov)
```

### FAMILY L
```{r day50_live_non_apoptotic_agranularfamilyL, echo=TRUE}
DAY50_live_non_apoptotic_agranular_FAMILY_L <- DAY50_live_non_apoptotic_agranular %>% filter(FAMILY=="L")

DAY50_live_non_apoptotic_agranular_FAMILY_L_aov <- aov(DAY50_live_non_apoptotic_agranular_FAMILY_L$Arcsine ~ DAY50_live_non_apoptotic_agranular_FAMILY_L$GROUP, data=DAY50_live_non_apoptotic_agranular_FAMILY_L)
summary(DAY50_live_non_apoptotic_agranular_FAMILY_L_aov)

DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_L <- DAY50_live_non_apoptotic_agranular_BAD_REMOVED %>% filter(FAMILY=="L") 
DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_L_aov <- aov(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_L$Arcsine ~ DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_L$GROUP, data=DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_L)
summary(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_FAMILY_L_aov)
```

### Two Way ANOVA of Live Agranular ###

```{r day50_twoway_live_non_apoptotic_agranular, echo=TRUE}
DAY50_live_non_apoptotic_agranular_twoway_BAD_REMOVED_lm <- lm(DAY50_live_non_apoptotic_agranular_BAD_REMOVED$Arcsine ~ DAY50_live_non_apoptotic_agranular_BAD_REMOVED$GROUP + DAY50_live_non_apoptotic_agranular_BAD_REMOVED$FAMILY, data=DAY50_live_non_apoptotic_agranular_BAD_REMOVED)
Anova(DAY50_live_non_apoptotic_agranular_twoway_BAD_REMOVED_lm , type="II")
summary(DAY50_live_non_apoptotic_agranular_twoway_BAD_REMOVED_lm)

```

### One Way ANOVA of Live Non-Apoptotic Agranular Just Challenged

```{r Day50_live_non_apoptotic_agranular_oneway, echo=TRUE}
DAY50_live_non_apoptotic_agranular_BAD_REMOVED_CHALLENGE <- DAY50_live_non_apoptotic_agranular_BAD_REMOVED[!grepl("control", DAY50_live_non_apoptotic_agranular_BAD_REMOVED$GROUP),]

DAY50_live_non_apoptotic_agranular_BAD_REMOVED_CHALLENGE_aov <- aov(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_CHALLENGE$Arcsine ~ DAY50_live_non_apoptotic_agranular_BAD_REMOVED_CHALLENGE$FAMILY, data=DAY50_live_non_apoptotic_agranular_BAD_REMOVED_CHALLENGE)
summary(DAY50_live_non_apoptotic_agranular_BAD_REMOVED_CHALLENGE_aov) # significantly different between families 
```

## Two Way ANOVA of Live Non-Apoptotic cells ###

```{r day50_live_non_apoptotic_cells_twoway, echo=TRUE}

DAY50_live_non_apoptotic_granular_agranular_combined <- rbind(DAY50_live_non_apoptotic_granular_BAD_REMOVED,DAY50_live_non_apoptotic_agranular_BAD_REMOVED)

ggplot(DAY50_live_non_apoptotic_granular_agranular_combined, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + facet_grid(.~FAMILY+GROUP, scales="free") + geom_boxplot() + ggtitle("Percent of Granular and Agranular Live Non-apoptotic Hemocytes at Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot")+ scale_fill_manual(name="Hemocyte Type", labels=c("Necrotic Granular", "Necrotic Agranular"), values=c("Q2_LL"="#99a765","Q1_LL"="#96578a")) 

# Two way ANOVA
DAY50_live_non_apoptotic_granular_agranular_aov <- lm(DAY50_live_non_apoptotic_granular_agranular_combined$Arcsine ~DAY50_live_non_apoptotic_granular_agranular_combined$FAMILY + DAY50_live_non_apoptotic_granular_agranular_combined$GATE, data=DAY50_live_non_apoptotic_granular_agranular_combined)
Anova(DAY50_live_non_apoptotic_granular_agranular_aov , type="II") #GATE is significant
summary(DAY50_live_non_apoptotic_granular_agranular_aov)

# Two- Way ANOVA with interaction
DAY50_live_non_apoptotic_granular_agranular_aov_interaction <- lm(DAY50_live_non_apoptotic_granular_agranular_combined$Arcsine ~DAY50_live_non_apoptotic_granular_agranular_combined$FAMILY + DAY50_live_non_apoptotic_granular_agranular_combined$GATE + DAY50_live_non_apoptotic_granular_agranular_combined$FAMILY:DAY50_live_non_apoptotic_granular_agranular_combined$GATE, data=DAY50_live_non_apoptotic_granular_agranular_combined)
Anova(DAY50_live_non_apoptotic_granular_agranular_aov_interaction, type="II") #GATE is significant
summary(DAY50_live_non_apoptotic_granular_agranular_aov_interaction)

DAY50_live_non_apoptotic_granular_agranular_aov_gate_leastsquares <- lsmeans(DAY50_live_non_apoptotic_granular_agranular_aov_interaction, "DAY50_live_non_apoptotic_granular_agranular_combined$GATE", adjust="tukey")
cld(DAY50_live_non_apoptotic_granular_agranular_aov_gate_leastsquares, alpha=0.05, Letters=letters) # the means of the two groups not different

```

#### Combined Plotting ####

```{r granular_agranular_plotting, echo=TRUE}

DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$DAY <- "50"
DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED$CELL <- "granular"
DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$DAY <- "50"
DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED$CELL <- "agranular"
APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED$DAY <- "07"
APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED$CELL <- "granular"
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED$DAY <- "07"
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED$CELL <- "agranular"


DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED_subset <- DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED[,c("SAMPLE_ID", "FAMILY","ASSAY","PERCENT_OF_THIS_PLOT", "GATE","DAY","GROUP", "PLOT","CELL","Arcsine")]
DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED_subset<- DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED[,c("SAMPLE_ID", "FAMILY","ASSAY","PERCENT_OF_THIS_PLOT", "GATE","DAY","GROUP", "PLOT","CELL","Arcsine")]
APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED_subset <- APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED[,c("SAMPLE_ID", "FAMILY","ASSAY","PERCENT_OF_THIS_PLOT", "GATE","DAY","GROUP", "PLOT","CELL","Arcsine")]
APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED_subset <- APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED[,c("SAMPLE_ID", "FAMILY","ASSAY","PERCENT_OF_THIS_PLOT", "GATE","DAY","GROUP", "PLOT","CELL","Arcsine")]

all_granular_agranular_DAY7_DAY50 <- rbind(DAY50_APOP_PLOT4_GRANULAR_QUAD_PLOT_BAD_REMOVED_subset,DAY50_APOP_PLOT7_AGRANULAR_QUAD_PLOT_BAD_REMOVED_subset,APOP_PLOT4_GRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED_subset,APOP_PLOT7_AGRANULAR_QUAD_PLOT_GATE_ADDED_BAD_REMOVED_subset)

all_granular_agranular_DAY7_DAY50_challenge <- all_granular_agranular_DAY7_DAY50[grepl("treatment", all_granular_agranular_DAY7_DAY50$GROUP),]

#BEST PLOT 
  control_and_challenge <- ggplot(all_granular_agranular_DAY7_DAY50, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + 
  geom_col(position=position_fill()) + 
  ggtitle("Percent of Granular and Agranular Hemocytes \n on Day 7 and Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + 
  facet_grid(DAY~CELL+FAMILY, scales="free") + scale_fill_manual(name="Hemocyte Type", labels=c("Live Non-Apoptotic Granular","Live Apoptotic Granular", "Dead Apoptotic Granular", "Necrotic Granular", "Live Non-Apoptotic Agranular", "Live Apoptotic Agranular", "Dead Apoptotic Agranular", "Necrotic Agranular"), values=c("Q2_LL"="#7d7f77","Q2_LR"="#33362f", "Q2_UL"="#d1c9b8","Q2_UR"="#accccf","Q1_LL"="#488772", "Q1_LR"="#52d79b","Q1_UL"="#a5d4c1","Q1_UR"="#62dccc")) 

#just_challenge<-
  ggplot(all_granular_agranular_DAY7_DAY50_challenge, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + 
  geom_col(position=position_fill()) + 
  ggtitle("Percent of Granular and Agranular Hemocytes from Challenged Oysters \n on Day 7 and Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + 
  facet_grid(DAY~CELL+FAMILY, scales="free") + scale_fill_manual(name="Hemocyte Type", labels=c("Live Non-Apoptotic Granular","Live Apoptotic Granular", "Dead Apoptotic Granular", "Necrotic Granular", "Live Non-Apoptotic Agranular", "Live Apoptotic Agranular", "Dead Apoptotic Agranular", "Necrotic Agranular"), values=c("Q2_LL"="#7d7f77","Q2_LR"="#33362f", "Q2_UL"="#d1c9b8","Q2_UR"="#accccf","Q1_LL"="#488772", "Q1_LR"="#52d79b","Q1_UL"="#a5d4c1","Q1_UR"="#62dccc")) 
  
```

#### Two-Way ANOVA of GATE and DAY ####
```{r gate_day_anova, echo=TRUE}

all_granular_agranular_DAY7_DAY50_lm <- lm(all_granular_agranular_DAY7_DAY50$Arcsine ~ all_granular_agranular_DAY7_DAY50$GATE + all_granular_agranular_DAY7_DAY50$DAY + all_granular_agranular_DAY7_DAY50$GATE:all_granular_agranular_DAY7_DAY50$DAY, data=all_granular_agranular_DAY7_DAY50)
Anova(all_granular_agranular_DAY7_DAY50_lm, type="II")
```

### Summary Statistics Day 50 ###

```{r summary_stats_day50, echo=TRUE}

# Summary Statistics for Percentages 
total_apoptosis_statistics_day50 <- summarySE(data=all_granular_agranular_DAY7_DAY50, "PERCENT_OF_THIS_PLOT", groupvars=c("GROUP", "GATE","FAMILY"))
total_apoptosis_statistics_day50 
```


### Modeling with Dirichlet Multinomial Regression 

# Have to wait until I have the load data and the survival data over time

