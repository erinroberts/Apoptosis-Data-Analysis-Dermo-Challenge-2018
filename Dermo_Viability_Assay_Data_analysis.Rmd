---
title: "Dermo Viability Assay Data Analysis"
author: "Erin Roberts"
date: "7/27/2018"
output: github_document

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load Packages
R version being used is 3.4.1
```{r packages, echo=FALSE}
library(ggplot2)
library(metafor)
library(dplyr)
library(car)
library(lsmeans)
library(rgr)
library(multcompView)
library(Rmisc)
library(knitr)
```

# VIABILITY ASSAY ANALYSIS 

## Key for GATE Names used in Analysis 

### Load in Data for GATE_KEY
```{r load_ley, echo=TRUE}
Viability_assay_GATE_KEY <- read.csv("../ANALYSIS_CSVs/VIABILITY_ASSAY/Viability_assay_GATE_KEY.csv",header=TRUE, stringsAsFactors = FALSE)
Viability_assay_GATE_KEY <- as.data.frame(Viability_assay_GATE_KEY)
kable(Viability_assay_GATE_KEY, caption = "Table of Gate Key")
```


## Load in data for each plot

```{r load, echo=TRUE}
#Load in the Data for each plot on a separate spreadsheet

VI_PLOT2_hemocytes <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT2.csv", header=TRUE)
VI_PLOT3_P1_GATE <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT3.csv", header=TRUE)
VI_PLOT4_E1_E3_GATE <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT4.csv", header=TRUE)
VI_PLOT5_P1_MINUS_V1R <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT5.csv", header=TRUE)
VI_PLOT9_E1_MINUS_V1R <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT9.csv", header=TRUE)
VI_PLOT10_E3_MINUS_V1R <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT10.csv", header=TRUE)
VI_PLOT12_P1_PerCP <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT12.csv", header=TRUE)
VI_PLOT4_restructured <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/PLOT4_RESTRUCTURED.csv", header=TRUE)

# Remove rows with na's with the remove.na function from rgr
VI_PLOT2_hemocytes <- na.omit(VI_PLOT2_hemocytes)
VI_PLOT3_P1_GATE <- na.omit(VI_PLOT3_P1_GATE)
VI_PLOT4_E1_E3_GATE <- na.omit(VI_PLOT4_E1_E3_GATE)
VI_PLOT5_P1_MINUS_V1R <- na.omit(VI_PLOT5_P1_MINUS_V1R)
VI_PLOT9_E1_MINUS_V1R <- na.omit(VI_PLOT9_E1_MINUS_V1R)
VI_PLOT10_E3_MINUS_V1R <- na.omit(VI_PLOT10_E3_MINUS_V1R)
VI_PLOT12_P1_PerCP <- na.omit(VI_PLOT12_P1_PerCP)
VI_PLOT4_restructured <- na.omit(VI_PLOT4_restructured)

## Remove percent symbol from columns 
VI_PLOT2_hemocytes$M4_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT2_hemocytes$M4_PERCENT_OF_THIS_PLOT))
VI_PLOT3_P1_GATE$P1_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT3_P1_GATE$P1_PERCENT_OF_THIS_PLOT))
VI_PLOT4_E1_E3_GATE$E1_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT4_E1_E3_GATE$E1_PERCENT_OF_THIS_PLOT))
VI_PLOT4_E1_E3_GATE$E3_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT4_E1_E3_GATE$E3_PERCENT_OF_THIS_PLOT))
VI_PLOT12_P1_PerCP$V1_L_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT12_P1_PerCP$V1_L_PERCENT_OF_THIS_PLOT))
VI_PLOT12_P1_PerCP$V1_R_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT12_P1_PerCP$V1_R_PERCENT_OF_THIS_PLOT))
VI_PLOT4_restructured$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_PLOT4_restructured$PERCENT_OF_THIS_PLOT))

# Load in Data for the samples to remove (these were samples with lots of bacterial contamination and/or few hemocytes)
Viability_Samples_Remove <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/VIABILITY_SAMPLES_REMOVE.csv", header=TRUE)

# Data Frame with bad samples removed
VI_PLOT2_hemocytes_BAD_REMOVED <- VI_PLOT2_hemocytes[!VI_PLOT2_hemocytes$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT3_P1_GATE_BAD_REMOVED <- VI_PLOT3_P1_GATE[!VI_PLOT3_P1_GATE$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT4_E1_E3_GATE_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE[!VI_PLOT4_E1_E3_GATE$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT5_P1_MINUS_V1R_BAD_REMOVED <- VI_PLOT5_P1_MINUS_V1R[!VI_PLOT5_P1_MINUS_V1R$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R[!VI_PLOT9_E1_MINUS_V1R$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R[!VI_PLOT10_E3_MINUS_V1R$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT12_P1_PerCP_BAD_REMOVED <- VI_PLOT12_P1_PerCP[!VI_PLOT12_P1_PerCP$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
VI_PLOT4_restructured_BAD_REMOVED <- VI_PLOT4_restructured[!VI_PLOT4_restructured$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]

```

# Arc sine Percentage data

```{r arcsine_1, echo=TRUE}
# Calculate Percent Live Granulocytes 
  # Take cells here and make a percentage out of GRANULAR hemocyte count from VI_PLOT3_P1_GATE P1_COUNT
  # These commands only work correctly if the csv has all the commas removed from the numbers for the thousands separator
VI_PLOT9_E1_MINUS_V1R$COUNT_THIS_PLOT<- as.numeric(VI_PLOT9_E1_MINUS_V1R$COUNT_THIS_PLOT)

VI_PLOT3_P1_GATE$P1_COUNT <- as.numeric(VI_PLOT3_P1_GATE$P1_COUNT)
VI_PLOT4_E1_E3_GATE$E1_COUNT <- as.numeric(VI_PLOT4_E1_E3_GATE$E1_COUNT) 
VI_PLOT9_E1_MINUS_V1R$PERCENT_LIVE <- (VI_PLOT9_E1_MINUS_V1R$COUNT_THIS_PLOT / VI_PLOT4_E1_E3_GATE$E1_COUNT)*100

VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT <- as.numeric(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT)
VI_PLOT3_P1_GATE_BAD_REMOVED$P1_COUNT <- as.numeric(VI_PLOT3_P1_GATE_BAD_REMOVED$P1_COUNT)
VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_COUNT <- as.numeric(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_COUNT)
VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE <- (VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT / VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_COUNT)*100 

# Calculate Percent Live Agranulocytes 
VI_PLOT10_E3_MINUS_V1R$COUNT_THIS_PLOT <- as.numeric(VI_PLOT10_E3_MINUS_V1R$COUNT_THIS_PLOT)
VI_PLOT4_E1_E3_GATE$E3_COUNT <- as.numeric(VI_PLOT4_E1_E3_GATE$E3_COUNT)
VI_PLOT10_E3_MINUS_V1R$PERCENT_LIVE <- (VI_PLOT10_E3_MINUS_V1R$COUNT_THIS_PLOT / VI_PLOT4_E1_E3_GATE$E3_COUNT)*100

VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT <- as.numeric(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT)
VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_COUNT <- as.numeric(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_COUNT)
VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE <- (VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT / VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_COUNT)*100 

# Use transf.arcsine to arcsine transform the percentages
VI_PLOT2_hemocytes$Arcsine <- transf.arcsin(VI_PLOT2_hemocytes$M4_PERCENT_OF_THIS_PLOT*.01)
VI_PLOT4_E1_E3_GATE$E1_Arcsine <- transf.arcsin(VI_PLOT4_E1_E3_GATE$E1_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT4_E1_E3_GATE$E3_Arcsine <- transf.arcsin(VI_PLOT4_E1_E3_GATE$E3_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT4_restructured$Arcsine <- transf.arcsin(VI_PLOT4_restructured$PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT9_E1_MINUS_V1R$Arcsine <- transf.arcsin(VI_PLOT9_E1_MINUS_V1R$PERCENT_LIVE*0.01)
VI_PLOT10_E3_MINUS_V1R$Arcsine <- transf.arcsin(VI_PLOT10_E3_MINUS_V1R$PERCENT_LIVE*0.01)
VI_PLOT12_P1_PerCP$V1_L_Arcsine <- transf.arcsin(VI_PLOT12_P1_PerCP$V1_L_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT12_P1_PerCP$V1_R_Arcsine <- transf.arcsin(VI_PLOT12_P1_PerCP$V1_R_PERCENT_OF_THIS_PLOT*0.01)

# Use transf.arcsine to arcsine transform the percentages for the "BAD REMOVED" samples
VI_PLOT2_hemocytes_BAD_REMOVED$Arcsine <- transf.arcsin(VI_PLOT2_hemocytes_BAD_REMOVED$M4_PERCENT_OF_THIS_PLOT*.01)
VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_Arcsine <- transf.arcsin(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_Arcsine <- transf.arcsin(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$Arcsine <- transf.arcsin(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE*0.01)
VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$Arcsine <- transf.arcsin(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE*0.01)
VI_PLOT12_P1_PerCP_BAD_REMOVED$V1_L_Arcsine <- transf.arcsin(VI_PLOT12_P1_PerCP_BAD_REMOVED$V1_L_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT12_P1_PerCP_BAD_REMOVED$V1_R_Arcsine <- transf.arcsin(VI_PLOT12_P1_PerCP_BAD_REMOVED$V1_R_PERCENT_OF_THIS_PLOT*0.01)
VI_PLOT4_restructured_BAD_REMOVED$Arcsine <- transf.arcsin(VI_PLOT4_restructured_BAD_REMOVED$PERCENT_OF_THIS_PLOT*0.01)
```


## Basic plots showing the data by Family and then across families

## Percent Total Hemocytes out of all events
```{r percent_total_hemocytes, echo=TRUE, }
 
VI_Percent_total_hemocytes_BAD_NOT_REMOVED <- ggplot(data= VI_PLOT2_hemocytes, aes(x=FAMILY, y=M4_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Hemocyte Events in Total Sample Events \n Low Quality Not Removed") +
    xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
ggsave(filename = "./Figures/VI_Percent_total_hemocytes_BAD_NOT_REMOVED.png", plot = VI_Percent_total_hemocytes_BAD_NOT_REMOVED)
```
![Percent of Hemocyte Events in Total Sample Events Low Quality Not Removed](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_Percent_total_hemocytes_BAD_NOT_REMOVED.png "Percent of Hemocyte Events in Total Sample Events Low Quality Not Removed")

```{r Percent_total_hemocytes_continued, echo=TRUE}
VI_Percent_total_hemocytes_BAD_REMOVED <- ggplot(data= VI_PLOT2_hemocytes_BAD_REMOVED, aes(x=FAMILY, y=M4_PERCENT_OF_THIS_PLOT, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Hemocyte Events in Total Sample Events \nLow Quality Removed") +
  xlab("Family") + ylab("Percent of Hemocyte Events") + ylim(0,100)
ggsave(filename = "./Figures/VI_Percent_total_hemocytes_BAD_REMOVED.png", plot=VI_Percent_total_hemocytes_BAD_REMOVED)
```
![Percent of Hemocyte Events in Total Sample Events Low Quality Removed](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_Percent_total_hemocytes_BAD_REMOVED.png "Percent of Hemocyte Events in Total Sample Events Low Quality Removed")

### Comparing Total hemocytes in control and treated 
```{r total_compared_day7, echo=TRUE}
VI_PLOT2_hemocytes_BAD_REMOVED_anova <- aov(VI_PLOT2_hemocytes_BAD_REMOVED$Arcsine ~ VI_PLOT2_hemocytes_BAD_REMOVED$GROUP, data=VI_PLOT2_hemocytes_BAD_REMOVED)
summary(VI_PLOT2_hemocytes_BAD_REMOVED_anova)
```

### FAMILY A
```{r total_A, echo=TRUE}
VI_PLOT2_FAMILY_A <- VI_PLOT2_hemocytes %>% filter(FAMILY=="A")
VI_PLOT2_AOV_FAMILY_A <- aov(VI_PLOT2_FAMILY_A$Arcsine ~ VI_PLOT2_FAMILY_A$GROUP, data=VI_PLOT2_FAMILY_A)
summary(VI_PLOT2_AOV_FAMILY_A)

VI_PLOT2_FAMILY_A_BAD_REMOVED <- VI_PLOT2_hemocytes_BAD_REMOVED %>% filter(FAMILY =="A")
VI_PLOT2_FAMILY_A_BAD_REMOVED_aov <- aov(VI_PLOT2_FAMILY_A_BAD_REMOVED$Arcsine ~ VI_PLOT2_FAMILY_A_BAD_REMOVED$GROUP, data=VI_PLOT2_FAMILY_A_BAD_REMOVED)
summary(VI_PLOT2_FAMILY_A_BAD_REMOVED_aov)
```

### FAMILY B
```{r total_B, echo=TRUE}
VI_PLOT2_FAMILY_B <- VI_PLOT2_hemocytes %>% filter(FAMILY=="B")
VI_PLOT2_AOV_FAMILY_B <- aov(VI_PLOT2_FAMILY_B$Arcsine ~ VI_PLOT2_FAMILY_B$GROUP, data=VI_PLOT2_FAMILY_B)
summary(VI_PLOT2_AOV_FAMILY_B)

VI_PLOT2_FAMILY_B_BAD_REMOVED <- VI_PLOT2_hemocytes_BAD_REMOVED %>% filter(FAMILY =="B")
VI_PLOT2_FAMILY_B_BAD_REMOVED_aov <- aov(VI_PLOT2_FAMILY_B_BAD_REMOVED$Arcsine ~ VI_PLOT2_FAMILY_B_BAD_REMOVED$GROUP, data=VI_PLOT2_FAMILY_B_BAD_REMOVED)
summary(VI_PLOT2_FAMILY_B_BAD_REMOVED_aov)
```

### FAMILY D
```{r total_D, echo=TRUE}
VI_PLOT2_FAMILY_D <- VI_PLOT2_hemocytes %>% filter(FAMILY=="D")
VI_PLOT2_AOV_FAMILY_D <- aov(VI_PLOT2_FAMILY_D$Arcsine ~ VI_PLOT2_FAMILY_D$GROUP, data=VI_PLOT2_FAMILY_D)
summary(VI_PLOT2_AOV_FAMILY_D)

VI_PLOT2_FAMILY_D_BAD_REMOVED <- VI_PLOT2_hemocytes_BAD_REMOVED %>% filter(FAMILY =="D")
VI_PLOT2_FAMILY_D_BAD_REMOVED_aov <- aov(VI_PLOT2_FAMILY_D_BAD_REMOVED$Arcsine ~ VI_PLOT2_FAMILY_D_BAD_REMOVED$GROUP, data=VI_PLOT2_FAMILY_D_BAD_REMOVED)
summary(VI_PLOT2_FAMILY_D_BAD_REMOVED_aov)
```

### FAMILY E
```{r total_E, echo=TRUE}
VI_PLOT2_FAMILY_E <- VI_PLOT2_hemocytes %>% filter(FAMILY=="E")
VI_PLOT2_AOV_FAMILY_E <- aov(VI_PLOT2_FAMILY_E$Arcsine ~ VI_PLOT2_FAMILY_E$GROUP, data=VI_PLOT2_FAMILY_E)
summary(VI_PLOT2_AOV_FAMILY_E)

VI_PLOT2_FAMILY_E_BAD_REMOVED <- VI_PLOT2_hemocytes_BAD_REMOVED %>% filter(FAMILY =="E")
VI_PLOT2_FAMILY_E_BAD_REMOVED_aov <- aov(VI_PLOT2_FAMILY_E_BAD_REMOVED$Arcsine ~ VI_PLOT2_FAMILY_E_BAD_REMOVED$GROUP, data=VI_PLOT2_FAMILY_E_BAD_REMOVED)
summary(VI_PLOT2_FAMILY_E_BAD_REMOVED_aov)
```

### FAMILY J
```{r total_J, echo=TRUE}
VI_PLOT2_FAMILY_J <- VI_PLOT2_hemocytes %>% filter(FAMILY=="J")
VI_PLOT2_AOV_FAMILY_J <- aov(VI_PLOT2_FAMILY_J$Arcsine ~ VI_PLOT2_FAMILY_J$GROUP, data=VI_PLOT2_FAMILY_J)
summary(VI_PLOT2_AOV_FAMILY_J)

VI_PLOT2_FAMILY_J_BAD_REMOVED <- VI_PLOT2_hemocytes_BAD_REMOVED %>% filter(FAMILY =="J")
VI_PLOT2_FAMILY_J_BAD_REMOVED_aov <- aov(VI_PLOT2_FAMILY_J_BAD_REMOVED$Arcsine ~ VI_PLOT2_FAMILY_J_BAD_REMOVED$GROUP, data=VI_PLOT2_FAMILY_J_BAD_REMOVED)
summary(VI_PLOT2_FAMILY_J_BAD_REMOVED_aov)
```

### FAMILY L
```{r total_L, echo=TRUE}
VI_PLOT2_FAMILY_L <- VI_PLOT2_hemocytes %>% filter(FAMILY=="L")
VI_PLOT2_AOV_FAMILY_L <- aov(VI_PLOT2_FAMILY_L$Arcsine ~ VI_PLOT2_FAMILY_L$GROUP, data=VI_PLOT2_FAMILY_L)
summary(VI_PLOT2_AOV_FAMILY_L)

VI_PLOT2_FAMILY_L_BAD_REMOVED <- VI_PLOT2_hemocytes_BAD_REMOVED %>% filter(FAMILY =="L")
VI_PLOT2_FAMILY_L_BAD_REMOVED_aov <- aov(VI_PLOT2_FAMILY_L_BAD_REMOVED$Arcsine ~ VI_PLOT2_FAMILY_L_BAD_REMOVED$GROUP, data=VI_PLOT2_FAMILY_L_BAD_REMOVED)
summary(VI_PLOT2_FAMILY_L_BAD_REMOVED_aov)
```

## Percent Granular Hemocytes out of all hemocytes
```{r percent_granular_hemocytes, echo=TRUE}
VI_Percent_Granular_Hemocytes_BAD_NOT_REMOVED <- ggplot(data=VI_PLOT4_E1_E3_GATE, aes(y=E1_PERCENT_OF_THIS_PLOT, x=FAMILY, by=GROUP, color=GROUP)) + geom_boxplot() + ggtitle("Percent of Granular Hemocyte \n Events Low Quality Not Removed") +xlab("Family") + ylab("Percent of Live and Dead Granular Hemocytes") + ylim(0,100)
ggsave(filename = "./Figures/VI_Percent_Granular_Hemocytes_BAD_NOT_REMOVED.png", plot=VI_Percent_Granular_Hemocytes_BAD_NOT_REMOVED)
```
![VI_Percent_Granular_Hemocytes_BAD_NOT_REMOVED](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_Percent_Granular_Hemocytes_BAD_NOT_REMOVED.png)

```{r r percent_granular_hemocytes_cont, echo=TRUE}
VI_Percent_Granular_Hemocytes_BAD_REMOVED <- ggplot(data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED, aes(y=E1_PERCENT_OF_THIS_PLOT, x=FAMILY, by=GROUP, color=GROUP)) + geom_boxplot() + ggtitle("Percent of Granular Hemocyte \n Events Low Quality Removed") +
  xlab("Family") + ylab("Percent of Live and Dead Granular Hemocytes") + ylim(0,100)
ggsave(filename = "./Figures/VI_Percent_Granular_Hemocytes_BAD_REMOVED.png", plot=VI_Percent_Granular_Hemocytes_BAD_REMOVED)
```
![VI_Percent_Granular_Hemocytes_BAD_REMOVED](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_Percent_Granular_Hemocytes_BAD_REMOVED.png)

## Percent of granular hemocytes (E1)

### FAMILY A
```{r granular_A, echo=TRUE}
VI_PLOT4_FAMILY_A <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="A")
VI_PLOT4_E1_AOV_FAMILY_A <- aov(VI_PLOT4_FAMILY_A$E1_Arcsine ~ VI_PLOT4_FAMILY_A$GROUP, data=VI_PLOT4_FAMILY_A)
summary(VI_PLOT4_E1_AOV_FAMILY_A)

VI_PLOT4_FAMILY_A_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="A")
VI_PLOT4_E1_AOV_FAMILY_A_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_A_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_FAMILY_A_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_A_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_A_BAD_REMOVED)
```

### FAMILY B

```{r granular_B, echo=TRUE}
V1_PLOT4_FAMILY_B <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="B")
VI_PLOT4_E1_AOV_FAMILY_B <- aov(V1_PLOT4_FAMILY_B$E1_Arcsine ~ V1_PLOT4_FAMILY_B$GROUP, data=V1_PLOT4_FAMILY_B)
summary(VI_PLOT4_E1_AOV_FAMILY_B)
V1_PLOT4_FAMILY_B_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY=="B")
VI_PLOT4_E1_AOV_FAMILY_B_BAD_REMOVED <- aov(V1_PLOT4_FAMILY_B_BAD_REMOVED$E1_Arcsine ~ V1_PLOT4_FAMILY_B_BAD_REMOVED$GROUP, data=V1_PLOT4_FAMILY_B_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_B_BAD_REMOVED)
```

### FAMILY D
```{r granular_D, echo=TRUE}
VI_PLOT4_FAMILY_D <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="D")
VI_PLOT4_E1_AOV_FAMILY_D <- aov(VI_PLOT4_FAMILY_D$E1_Arcsine ~ VI_PLOT4_FAMILY_D$GROUP, data=VI_PLOT4_FAMILY_D)
summary(VI_PLOT4_E1_AOV_FAMILY_D)
VI_PLOT4_FAMILY_D_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY=="D")
VI_PLOT4_E1_AOV_FAMILY_D_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_D_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_FAMILY_D_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_D_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_D_BAD_REMOVED)
```

### FAMILY E
```{r granular_E, echo=TRUE}
VI_PLOT4_FAMILY_E <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="E")
VI_PLOT4_E1_AOV_FAMILY_E <- aov(VI_PLOT4_FAMILY_E$E1_Arcsine ~ VI_PLOT4_FAMILY_E$GROUP, data=VI_PLOT4_FAMILY_E)
summary(VI_PLOT4_E1_AOV_FAMILY_E)
VI_PLOT4_FAMILY_E_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY=="E")
VI_PLOT4_E1_AOV_FAMILY_E_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_E_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_FAMILY_E_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_E_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_E_BAD_REMOVED)
```

### FAMILY J
```{r granular_J, echo=TRUE}
VI_PLOT4_FAMILY_J <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="J")
VI_PLOT4_E1_AOV_FAMILY_J <- aov(VI_PLOT4_FAMILY_J$E1_Arcsine ~ VI_PLOT4_FAMILY_J$GROUP, data=VI_PLOT4_FAMILY_J)
summary(VI_PLOT4_E1_AOV_FAMILY_J)
VI_PLOT4_FAMILY_J_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY=="J")
VI_PLOT4_E1_AOV_FAMILY_J_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_J_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_FAMILY_J_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_J_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_J_BAD_REMOVED)
```

### FAMILY L
```{r granular_L, echo=TRUE}
VI_PLOT4_FAMILY_L <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="L")
VI_PLOT4_E1_AOV_FAMILY_L <- aov(VI_PLOT4_FAMILY_L$E1_Arcsine ~ VI_PLOT4_FAMILY_L$GROUP, data=VI_PLOT4_FAMILY_L)
summary(VI_PLOT4_E1_AOV_FAMILY_L)
VI_PLOT4_FAMILY_L_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY=="L")
VI_PLOT4_E1_AOV_FAMILY_L_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_L_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_FAMILY_L_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_L_BAD_REMOVED)
summary(VI_PLOT4_E1_AOV_FAMILY_L_BAD_REMOVED)
```

### Two Way ANOVA of Granular Hemocytes

```{r granular_aov, echo=TRUE}
VI_PLOT4_Granular_hemocytes_AOV <- lm(VI_PLOT4_E1_E3_GATE$E1_Arcsine ~ VI_PLOT4_E1_E3_GATE$GROUP + VI_PLOT4_E1_E3_GATE$FAMILY, data=VI_PLOT4_E1_E3_GATE)
Anova(VI_PLOT4_Granular_hemocytes_AOV, type="II")
summary(VI_PLOT4_Granular_hemocytes_AOV)
VI_PLOT4_Granular_hemocytes_AOV_BAD_REMOVED <- lm(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E1_Arcsine ~ VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP + VI_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY, data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED)
Anova(VI_PLOT4_Granular_hemocytes_AOV_BAD_REMOVED, type="II")
summary(VI_PLOT4_Granular_hemocytes_AOV_BAD_REMOVED)
#NO significance, no interaction term added
```

### One Way ANOVA of Differences between Families

```{r oneway_granular, include=TRUE}

VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED[!grepl("control", VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP),]
VI_PLOT4_Granular_hemocytes_oneway_lm <- aov(VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE$E1_Arcsine ~ VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE)
summary(VI_PLOT4_Granular_hemocytes_oneway_lm)
```

# Percent of Agranular hemocytes (E3) #

## Percent Agranular Hemocytes out of all hemocytes
```{r percent_agranular_hemocytes, echo=TRUE}
VI_Percent_Agranular_Hemocytes_BAD_NOT_REMOVED <-  ggplot(data=VI_PLOT4_E1_E3_GATE, aes(y=E3_PERCENT_OF_THIS_PLOT, x=FAMILY, by=GROUP, color=GROUP)) + geom_boxplot() + ggtitle("Percent of Agranular Hemocyte Events \n Low Quality Not Removed") +
  xlab("Family") + ylab("Percent of Live and Dead Agranular Hemocytes") + ylim(0,100)
ggsave(filename="./Figures/VI_Percent_Agranular_Hemocytes_BAD_NOT_REMOVED.png", plot=VI_Percent_Agranular_Hemocytes_BAD_NOT_REMOVED)

```
![VI_Percent_Agranular_Hemocytes_BAD_NOT_REMOVED](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_Percent_Agranular_Hemocytes_BAD_NOT_REMOVED.png)

```{r percent_agranular_hemocytes_2, echo=TRUE}
VI_Percent_Agranular_Hemocytes_BAD_REMOVED <-  ggplot(data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED, aes(y=E3_PERCENT_OF_THIS_PLOT, x=FAMILY, by=GROUP, color=GROUP)) + geom_boxplot() + ggtitle("Percent of Agranular Hemocyte Events") +
  xlab("Family") + ylab("Percent of Live and Dead \n Agranular Hemocytes Low Quality Removed") + ylim(0,100)
ggsave(filename="./Figures/VI_Percent_Agranular_Hemocytes_BAD_REMOVED.png", plot=VI_Percent_Agranular_Hemocytes_BAD_NOT_REMOVED)
```
![VI_Percent_Agranular_Hemocytes_BAD_NOT_REMOVED](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_Percent_Agranular_Hemocytes_BAD_REMOVED.png)

### FAMILY A
```{r agranular_A, echo=FALSE}
VI_PLOT4_FAMILY_A_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="A")
VI_PLOT4_E3_AOV_FAMILY_A <- aov(VI_PLOT4_FAMILY_A_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_A_E3$GROUP, data=VI_PLOT4_FAMILY_A_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_A)
VI_PLOT4_FAMILY_A_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="A")
VI_PLOT4_E3_AOV_FAMILY_A_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_A_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_A_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_A_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_A_BAD_REMOVED)
```

### FAMILY B
```{r agranular_B, echo=FALSE}
VI_PLOT4_FAMILY_B_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="B")
VI_PLOT4_E3_AOV_FAMILY_B <- aov(VI_PLOT4_FAMILY_B_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_B_E3$GROUP, data=VI_PLOT4_FAMILY_B_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_B)
VI_PLOT4_FAMILY_B_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="B")
VI_PLOT4_E3_AOV_FAMILY_B_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_B_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_B_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_B_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_B_BAD_REMOVED)
```

### FAMILY D
```{r agranular D, echo=FALSE}
VI_PLOT4_FAMILY_D_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="D")
VI_PLOT4_E3_AOV_FAMILY_D <- aov(VI_PLOT4_FAMILY_D_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_D_E3$GROUP, data=VI_PLOT4_FAMILY_D_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_D)
VI_PLOT4_FAMILY_D_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="D")
VI_PLOT4_E3_AOV_FAMILY_D_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_D_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_D_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_D_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_D_BAD_REMOVED)
```

### FAMILY E
```{r agranular_E, echo=FALSE}
VI_PLOT4_FAMILY_E_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="E")
VI_PLOT4_E3_AOV_FAMILY_E <- aov(VI_PLOT4_FAMILY_E_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_E_E3$GROUP, data=VI_PLOT4_FAMILY_E_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_E)
VI_PLOT4_FAMILY_E_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="E")
VI_PLOT4_E3_AOV_FAMILY_E_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_E_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_E_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_E_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_E_BAD_REMOVED)
```

### FAMILY J
```{r agranular_J, echo=FALSE}
VI_PLOT4_FAMILY_J_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="J")
VI_PLOT4_E3_AOV_FAMILY_J <- aov(VI_PLOT4_FAMILY_J_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_J_E3$GROUP, data=VI_PLOT4_FAMILY_J_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_J)
VI_PLOT4_FAMILY_J_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="J")
VI_PLOT4_E3_AOV_FAMILY_J_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_J_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_J_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_J_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_J_BAD_REMOVED)
```

### FAMILY L 
```{r agrnaular_L, echo=FALSE}
VI_PLOT4_FAMILY_L_E3 <- VI_PLOT4_E1_E3_GATE %>% filter(FAMILY=="L")
VI_PLOT4_E3_AOV_FAMILY_L <- aov(VI_PLOT4_FAMILY_L_E3$E3_Arcsine ~ VI_PLOT4_FAMILY_L_E3$GROUP, data=VI_PLOT4_FAMILY_L_E3)
summary(VI_PLOT4_E3_AOV_FAMILY_L)
VI_PLOT4_FAMILY_L_E3_BAD_REMOVED <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="L")
VI_PLOT4_E3_AOV_FAMILY_L_BAD_REMOVED <- aov(VI_PLOT4_FAMILY_L_E3_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_FAMILY_L_E3_BAD_REMOVED$GROUP, data=VI_PLOT4_FAMILY_L_E3_BAD_REMOVED)
summary(VI_PLOT4_E3_AOV_FAMILY_L_BAD_REMOVED)
```

### Two Way ANOVA of Agranular Hemocytes
```{r agrnaular_AOV, echo=TRUE}
VI_PLOT4_Agranular_hemocytes_AOV <- lm(VI_PLOT4_E1_E3_GATE$E3_Arcsine ~ VI_PLOT4_E1_E3_GATE$GROUP + VI_PLOT4_E1_E3_GATE$FAMILY, data=VI_PLOT4_E1_E3_GATE)
Anova(VI_PLOT4_Agranular_hemocytes_AOV, type="II")
summary(VI_PLOT4_Agranular_hemocytes_AOV)

VI_PLOT4_Agranular_hemocytes_AOV_BAD_REMOVED <- lm(VI_PLOT4_E1_E3_GATE_BAD_REMOVED$E3_Arcsine ~ VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP + VI_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY, data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED)
Anova(VI_PLOT4_Agranular_hemocytes_AOV_BAD_REMOVED, type="II")
summary(VI_PLOT4_Agranular_hemocytes_AOV_BAD_REMOVED)

```

### One Way ANOVA of Differences between Families

```{r oneway_Agranular, echo=TRUE}

VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE <- VI_PLOT4_E1_E3_GATE_BAD_REMOVED[!grepl("control", VI_PLOT4_E1_E3_GATE_BAD_REMOVED$GROUP),]
VI_PLOT4_Agranular_hemocytes_oneway_aov <- aov(VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE$E3_Arcsine ~ VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_PLOT4_E1_E3_GATE_BAD_REMOVED_CHALLENGE)
summary(VI_PLOT4_Agranular_hemocytes_oneway_aov)
```

## Two Way ANOVA of Granular vs. Agranular
```{r granular_agranular_percentage, echo=TRUE}
# Plotting
VI_PLOT4_restructured_BAD_REMOVED_plot <- ggplot(VI_PLOT4_restructured_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=E1_E3)) + geom_boxplot() + ggtitle("Percent of Granular and Agranular Hemocytes (low quality removed)") +
  ylab("Percent of Hemocyte Events in each quad plot") + scale_fill_manual(name="Hemocyte Type", labels=c("Granular Hemocytes", "Agranular Hemocytes"), values=c("E1"="#99a765","E3"="#96578a")) + facet_grid(.~FAMILY+GROUP, scales="free") 
VI_PLOT4_agranular_granular_lm <- lm(VI_PLOT4_restructured_BAD_REMOVED$Arcsine ~ VI_PLOT4_restructured_BAD_REMOVED$E1_E3 + VI_PLOT4_restructured_BAD_REMOVED$FAMILY, data=VI_PLOT4_restructured_BAD_REMOVED)
Anova(VI_PLOT4_agranular_granular_lm, type="II")
summary(VI_PLOT4_agranular_granular_lm)


VI_PLOT4_agranular_granular_lm_interaction <- lm(VI_PLOT4_restructured_BAD_REMOVED$Arcsine ~ VI_PLOT4_restructured_BAD_REMOVED$E1_E3 + VI_PLOT4_restructured_BAD_REMOVED$FAMILY + VI_PLOT4_restructured_BAD_REMOVED$FAMILY:VI_PLOT4_restructured_BAD_REMOVED$E1_E3, data=VI_PLOT4_restructured_BAD_REMOVED)
Anova(VI_PLOT4_agranular_granular_lm_interaction, type="II")
summary(VI_PLOT4_agranular_granular_lm_interaction)

VI_PLOT4_agranular_granular_lm_interaction_leastsquares <- lsmeans(VI_PLOT4_agranular_granular_lm_interaction, "VI_PLOT4_restructured_BAD_REMOVED$E1_E3", adjust="tukey")
cld(VI_PLOT4_agranular_granular_lm_interaction_leastsquares, alpha=0.05, Letters=letters)

ggsave(filename = "./Figures/VI_PLOT4_restructured_BAD_REMOVED_plot.png",plot= VI_PLOT4_restructured_BAD_REMOVED_plot)
```
![VI_PLOT4_restructured_BAD_REMOVED_plot](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_PLOT4_restructured_BAD_REMOVED_plot.png)

# Percent of Live Granular Hemocytes #

## Percent Live Granular Hemocytes out of all Granular hemocytes
```{r percent, echo=TRUE}
VI_Percent_Live_Granular_BAD_NOT_REMOVED_GRAPH <- ggplot(VI_PLOT9_E1_MINUS_V1R, aes(x=FAMILY, y=PERCENT_LIVE, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Granular Hemocyte Events \n Low Quality Not Removed") + xlab("Family") + ylab("Percent of Live Granular Hemocytes") + ylim(0,100)
ggsave(filename="./Figures/VI_Percent_Live_Granular_BAD_NOT_REMOVED_GRAPH.png", plot=VI_Percent_Live_Granular_BAD_NOT_REMOVED_GRAPH)
```
![Percent of Live Granular Hemocyte Events Low Quality Not Removed](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_Percent_Live_Granular_BAD_NOT_REMOVED_GRAPH.png)

```{r percent_live_2, echo=TRUE}
VI_Percent_Live_Granular_BAD_REMOVED_GRAPH <- ggplot(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED, aes(x=FAMILY, y=PERCENT_LIVE, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Granular Hemocyte \n Events Low Quality Removed") + xlab("Family") + ylab("Percent of Live Granular Hemocytes") + ylim(0,100)
ggsave(filename="./Figures/VI_Percent_Live_Granular_BAD_REMOVED_GRAPH.png",plot=VI_Percent_Live_Granular_BAD_REMOVED_GRAPH)
```
![Percent of Live Granular Hemocyte Events Low Quality Removed](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_Percent_Live_Granular_BAD_REMOVED_GRAPH.png)
### FAMILY A
```{r live_granular_A, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_A <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="A")
VI_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_A$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_A$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_A)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV)
VI_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="A")
VI_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED)
```

### FAMILY B
```{r live_granular_B, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_B <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="B")
VI_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_B$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_B$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_B)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV)
VI_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="B")
VI_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED)
```

### FAMILY D
```{r live_granula_D, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_D <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="D")
VI_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_D$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_D$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_D)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV)
VI_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="D")
VI_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED$GROUP, data=VI_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED)
```

### FAMILY E
```{r live_granular_E, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_E <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="E")
VI_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_E$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_E$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_E)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV)
VI_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="E")
VI_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED)
```

### FAMILY J
```{r live_granular_J, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_J <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="J")
VI_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_J$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_J$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_J)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV)
VI_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="J")
VI_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED)
```

### FAMILY L
```{r live_granular_L, echo=FALSE}
VI_PLOT9_E1_MINUS_V1R_FAMILY_L <- VI_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="L")
VI_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_L$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_L$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_L)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV) 
VI_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="L")
VI_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED <- aov(VI_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED$GROUP, data= VI_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED)
summary(VI_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED)
```

### Two Way ANOVA of LIVE Granular Hemocytes
```{r live_granular_aov, echo=TRUE}
VI_PLOT9_LIVE_granular_hemocytes_AOV <- lm(VI_PLOT9_E1_MINUS_V1R$Arcsine ~ VI_PLOT9_E1_MINUS_V1R$GROUP + VI_PLOT9_E1_MINUS_V1R$FAMILY, data=VI_PLOT9_E1_MINUS_V1R)
Anova(VI_PLOT9_LIVE_granular_hemocytes_AOV, type="II")
summary(VI_PLOT9_LIVE_granular_hemocytes_AOV)

VI_PLOT9_LIVE_granular_hemocytes_AOV_BAD_REMOVED <- lm(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP + VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY, data=VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED)
Anova(VI_PLOT9_LIVE_granular_hemocytes_AOV_BAD_REMOVED, type="II") #FAMILY is significantly different
summary(VI_PLOT9_LIVE_granular_hemocytes_AOV_BAD_REMOVED)


# INTERACTION TERM ADDED
VI_PLOT9_LIVE_granular_hemocytes_INTERACTION_aov <- lm(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY + VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP + VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY:VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP)
Anova(VI_PLOT9_LIVE_granular_hemocytes_INTERACTION_aov , type="II")
summary(VI_PLOT9_LIVE_granular_hemocytes_INTERACTION_aov)
VI_PLOT9_LIVE_granular_hemocytes_INTERACTION_aov_leastsquares <- lsmeans(VI_PLOT9_LIVE_granular_hemocytes_INTERACTION_aov, "VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY", adjust="tukey")
cld(VI_PLOT9_LIVE_granular_hemocytes_INTERACTION_aov_leastsquares, alpha=0.05, Letters=letters)

```

### One Way ANOVA of Differences between Families

```{r oneway_live-granular, echo=TRUE}

VI_PLOT9_LIVE_granular_hemocytes_BAD_REMOVED_CHALLENGE <- VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED[!grepl("control", VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP),]
VI_PLOT9_LIVE_granular_hemocytes_oneway_aov <- aov(VI_PLOT9_LIVE_granular_hemocytes_BAD_REMOVED_CHALLENGE$Arcsine ~ VI_PLOT9_LIVE_granular_hemocytes_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_PLOT9_LIVE_granular_hemocytes_BAD_REMOVED_CHALLENGE)
summary(VI_PLOT9_LIVE_granular_hemocytes_oneway_aov)
TukeyHSD(VI_PLOT9_LIVE_granular_hemocytes_oneway_aov)
```

# Percent of Live Agranular Hemocytes (E3) #

# Percent Live Agranular Hemocytes Plotting
```{r percent_live_agranular_hemocytes, echo=TRUE}
VI_Percent_Live_Agranular_BAD_NOT_REMOVED_GRAPH <- ggplot(VI_PLOT10_E3_MINUS_V1R, aes(x=FAMILY, y=PERCENT_LIVE, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Agranular Hemocyte \n Events Low Quality Not Removed") + xlab("Family") +   ylab("Percent of Live Agranular Hemocytes") + ylim(0,100)          
ggsave(filename="./Figures/VI_Percent_Live_Agranular_BAD_NOT_REMOVED_GRAPH.png", plot=VI_Percent_Live_Agranular_BAD_NOT_REMOVED_GRAPH)                                            
```
![VI_Percent_Live_Agranular_BAD_NOT_REMOVED_GRAPH](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_Percent_Live_Agranular_BAD_REMOVED_GRAPH.png)

```{r percent_live_agranular_hemocytes_2, echo=TRUE}
VI_Percent_Live_Agranular_BAD_REMOVED_GRAPH <- ggplot(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED, aes(x=FAMILY, y=PERCENT_LIVE, color=GROUP, by=GROUP)) + geom_boxplot() + ggtitle("Percent of Live Agranular Hemocyte \n Events Low Quality Removed") + xlab("Family") + ylab("Percent of Live Agranular Hemocytes") + ylim(0,100)
ggsave(filename="./Figures/VI_Percent_Live_Agranular_BAD_REMOVED_GRAPH.png", plot=VI_Percent_Live_Agranular_BAD_REMOVED_GRAPH)                                                  
```
![Percent of Live Agranular Hemocyte Events Low Quality Removed](https://github.com/erinroberts/Apoptosis-Data-Analysis-Dermo-Challenge-2018/blob/master/Figures/VI_Percent_Granular_Hemocytes_BAD_REMOVED.png)
### FAMILY A
```{r live_agranular_A, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_A <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="A")
VI_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_A$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_A$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_A)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="A")
VI_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED)
```

### FAMILY B
```{r live_agranular_B, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_B <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="B")
VI_PLOT10_E3_MINUS_V1R_FAMILY_B_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_B$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_B$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_B)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_B_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="B")
VI_PLOT10_E1_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED)
summary(VI_PLOT10_E1_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED)
```

### FAMILY D
```{r live_agranular_D, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_D <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="D")
VI_PLOT10_E3_MINUS_V1R_FAMILY_D_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_D$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_D$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_D)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_D_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="D")
VI_PLOT10_E1_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED)
summary(VI_PLOT10_E1_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED)
```

### FAMILY E
```{r live_agranular_E, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_E <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="E")
VI_PLOT10_E3_MINUS_V1R_FAMILY_E_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_E$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_E$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_E)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_E_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="E")
VI_PLOT10_E1_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED)
summary(VI_PLOT10_E1_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED)
```

### FAMILY J
```{r live_agranular_J, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_J <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="J")
VI_PLOT10_E3_MINUS_V1R_FAMILY_J_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_J$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_J$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_J)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_J_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="J")
VI_PLOT10_E1_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED)
summary(VI_PLOT10_E1_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED)
```

### FAMILY L
```{r live_agranular_L, echo=FALSE}
VI_PLOT10_E3_MINUS_V1R_FAMILY_L <- VI_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="L")
VI_PLOT10_E3_MINUS_V1R_FAMILY_L_AOV <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_L$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_L$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_L)
summary(VI_PLOT10_E3_MINUS_V1R_FAMILY_L_AOV)
VI_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="L")
VI_PLOT10_E1_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED <- aov(VI_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED$GROUP, data= VI_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED)
summary(VI_PLOT10_E1_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED)
```

### Two Way ANOVA of LIVE AGranular Hemocytes
```{r live_agranular_aov, echo=FALSE}
VI_PLOT10_LIVE_AGranular_hemocytes_AOV <- lm(VI_PLOT10_E3_MINUS_V1R$Arcsine ~ VI_PLOT10_E3_MINUS_V1R$GROUP + VI_PLOT10_E3_MINUS_V1R$FAMILY, data=VI_PLOT10_E3_MINUS_V1R)
Anova(VI_PLOT10_LIVE_AGranular_hemocytes_AOV, type="II")
summary(VI_PLOT10_LIVE_AGranular_hemocytes_AOV)

VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED <- lm(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP + VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$FAMILY, data=VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED)
Anova(VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED, type="II")
summary(VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED)

VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED_interaction <- lm(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP + VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$FAMILY + VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$FAMILY:VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP, data=VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED)
Anova(VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED_interaction, type="II")
summary(VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED_interaction)

VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED_leastsquares <- lsmeans(VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED_interaction, "VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$FAMILY", adjust="tukey")
cld(VI_PLOT10_LIVE_AGranular_hemocytes_AOV_BAD_REMOVED_leastsquares, alpha=0.05, Letters=letters)

```

### One Way ANOVA of Differences between Families

```{r oneway_live-agranular, include=FALSE}

VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED_CHALLENGE <- VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED[!grepl("control", VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP),]
VI_PLOT10_LIVE_AGranular_hemocytes_oneway_aov <- aov(VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED_CHALLENGE$Arcsine ~ VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED_CHALLENGE)
summary(VI_PLOT10_LIVE_AGranular_hemocytes_oneway_aov)
TukeyHSD(VI_PLOT10_LIVE_AGranular_hemocytes_oneway_aov)
```

## Analyzing difference between Live Agranular and Granular 
```{r difference_between_cells, include=TRUE}

## Statistical difference between Live agranular cells and granular cells 
VI_PLOT9_PLOT10_BAD_REMOVED_combined <-rbind(VI_PLOT9_E1_MINUS_V1R_BAD_REMOVED, VI_PLOT10_E3_MINUS_V1R_BAD_REMOVED)

VI_PLOT9_PLOT10_granular_vs_agranular_twoway_aov <- lm(VI_PLOT9_PLOT10_BAD_REMOVED_combined$Arcsine ~ VI_PLOT9_PLOT10_BAD_REMOVED_combined$PERCENT_LIVE +VI_PLOT9_PLOT10_BAD_REMOVED_combined$FAMILY, data=VI_PLOT9_PLOT10_BAD_REMOVED_combined)
Anova(VI_PLOT9_PLOT10_granular_vs_agranular_twoway_aov)
summary(VI_PLOT9_PLOT10_granular_vs_agranular_twoway_aov)

# Plus an interaction term
VI_PLOT9_PLOT10_granular_vs_agranular_twoway_interaction_aov <- lm(VI_PLOT9_PLOT10_BAD_REMOVED_combined$Arcsine ~ VI_PLOT9_PLOT10_BAD_REMOVED_combined$PERCENT_LIVE + VI_PLOT9_PLOT10_BAD_REMOVED_combined$FAMILY + VI_PLOT9_PLOT10_BAD_REMOVED_combined$PERCENT_LIVE:VI_PLOT9_PLOT10_BAD_REMOVED_combined$FAMILY, data=VI_PLOT9_PLOT10_BAD_REMOVED_combined)
Anova(VI_PLOT9_PLOT10_granular_vs_agranular_twoway_interaction_aov, type="II")
summary(VI_PLOT9_PLOT10_granular_vs_agranular_twoway_interaction_aov)

VI_PLOT9_PLOT10_granular_vs_agranular_twoway_interaction_aov_leastsquare_interaction <- lsmeans(VI_PLOT9_PLOT10_granular_vs_agranular_twoway_interaction_aov, pairwise ~ VI_PLOT9_PLOT10_BAD_REMOVED_combined$PERCENT_LIVE:VI_PLOT9_PLOT10_BAD_REMOVED_combined$FAMILY, adjust="tukey")
cld(VI_PLOT9_PLOT10_granular_vs_agranular_twoway_interaction_aov_leastsquare_interaction, alpha=0.05, Letters=letters)

#Plotting
ggplot(VI_PLOT9_PLOT10_BAD_REMOVED_combined, aes(x=GROUP, y=PERCENT_LIVE, fill=PLOT)) + geom_boxplot() + ggtitle("Percent of Live Granular and Agranular Hemocytes (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + scale_fill_manual(name="Hemocyte Type", labels=c("Live Granular Hemocytes", "Live Agranular Hemocytes"), values=c("E1"="#99a765","E3"="#96578a")) + facet_grid(.~FAMILY+GROUP, scales="free") 
```

#### Calculate Summary Statistics ####
```{r summary_stats, echo=TRUE}

# Summary Statistics for Percentages 
total_viabaility_statistics <- summarySE(data=VI_PLOT4_restructured_BAD_REMOVED, "PERCENT_OF_THIS_PLOT", groupvars=c("GROUP", "E1_E3","FAMILY"))

viability_statistics_live <- summarySE(data=VI_PLOT9_PLOT10_BAD_REMOVED_combined, "PERCENT_LIVE", groupvars=c("GROUP", "PERCENT_LIVE","FAMILY"), conf.interval= 0.95)

# Summary Statistics for size
mean_size <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/VIABILITY_ASSAY_MEAN_VALUES_CORRECTED_EDITED.csv", header=TRUE)
class(mean_size$MEAN)
mean_size_BAD_REMOVED <- mean_size[!mean_size$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
mean_size_statistics <- summarySE(data=mean_size_BAD_REMOVED, "MEAN", groupvars=c("GROUP","GATE","PLOT","FAMILY"), conf.interval = 0.95)

```

#### DAY 50 DATA ANALYSIS ####

# VIABILITY ASSAY ANALYSIS 

## Load in data for each plot

```{r load_data, echo=TRUE}
#Load in the Data for each plot on a separate spreadsheet

VI_DAY50_PLOT2_hemocytes <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY50/PLOT2.csv", header=TRUE)
VI_DAY50_PLOT3_P1_GATE <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY50/PLOT3.csv", header=TRUE)
VI_DAY50_PLOT4_E1_E3_GATE <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY50/PLOT4.csv", header=TRUE)
VI_DAY50_PLOT5_P1_MINUS_V1R <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY50/PLOT5.csv", header=TRUE)
VI_DAY50_PLOT9_E1_MINUS_V1R <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY50/PLOT9.csv", header=TRUE)
VI_DAY50_PLOT10_E3_MINUS_V1R <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY50/PLOT10.csv", header=TRUE)
VI_DAY50_PLOT12_P1_PerCP <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY50/PLOT12.csv", header=TRUE)

# Remove rows with na's with the remove.na function from rgr
VI_DAY50_PLOT2_hemocytes <- na.omit(VI_DAY50_PLOT2_hemocytes)
VI_DAY50_PLOT3_P1_GATE <- na.omit(VI_DAY50_PLOT3_P1_GATE)
VI_DAY50_PLOT4_E1_E3_GATE <- na.omit(VI_DAY50_PLOT4_E1_E3_GATE)
VI_DAY50_PLOT5_P1_MINUS_V1R <- na.omit(VI_DAY50_PLOT5_P1_MINUS_V1R)
VI_DAY50_PLOT9_E1_MINUS_V1R <- na.omit(VI_DAY50_PLOT9_E1_MINUS_V1R)
VI_DAY50_PLOT10_E3_MINUS_V1R <- na.omit(VI_DAY50_PLOT10_E3_MINUS_V1R)
VI_DAY50_PLOT12_P1_PerCP <- na.omit(VI_DAY50_PLOT12_P1_PerCP)

## Remove percent symbol from columns 
VI_DAY50_PLOT2_hemocytes$M4_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_DAY50_PLOT2_hemocytes$M4_PERCENT_OF_THIS_PLOT))
VI_DAY50_PLOT3_P1_GATE$P1_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_DAY50_PLOT3_P1_GATE$P1_PERCENT_OF_THIS_PLOT))
VI_DAY50_PLOT4_E1_E3_GATE$PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_DAY50_PLOT4_E1_E3_GATE$PERCENT_OF_THIS_PLOT))
VI_DAY50_PLOT12_P1_PerCP$V1_L_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_DAY50_PLOT12_P1_PerCP$V1_L_PERCENT_OF_THIS_PLOT))
VI_DAY50_PLOT12_P1_PerCP$V1_R_PERCENT_OF_THIS_PLOT <- as.numeric(gsub("\\%", "", VI_DAY50_PLOT12_P1_PerCP$V1_R_PERCENT_OF_THIS_PLOT))

# Load in Data for the samples to remove 
Viability_Samples_Remove_DAY50 <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY50/Viability_Assay_Remove_Day50.csv", header=TRUE)

# Data Frame with bad samples removed
VI_DAY50_PLOT2_hemocytes_BAD_REMOVED <- VI_DAY50_PLOT2_hemocytes[!VI_DAY50_PLOT2_hemocytes$SAMPLE_ID %in% Viability_Samples_Remove_DAY50$SAMPLE_ID, , drop=FALSE]

VI_DAY50_PLOT3_P1_GATE_BAD_REMOVED <- VI_DAY50_PLOT3_P1_GATE[!VI_DAY50_PLOT3_P1_GATE$SAMPLE_ID %in% Viability_Samples_Remove_DAY50$SAMPLE_ID, , drop=FALSE]
VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE[!VI_DAY50_PLOT4_E1_E3_GATE$SAMPLE_ID %in% Viability_Samples_Remove_DAY50$SAMPLE_ID, , drop=FALSE]
VI_DAY50_PLOT5_P1_MINUS_V1R_BAD_REMOVED <- VI_DAY50_PLOT5_P1_MINUS_V1R[!VI_DAY50_PLOT5_P1_MINUS_V1R$SAMPLE_ID %in% Viability_Samples_Remove_DAY50$SAMPLE_ID, , drop=FALSE]
VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED <- VI_DAY50_PLOT9_E1_MINUS_V1R[!VI_DAY50_PLOT9_E1_MINUS_V1R$SAMPLE_ID %in% Viability_Samples_Remove_DAY50$SAMPLE_ID, , drop=FALSE]
VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED <- VI_DAY50_PLOT10_E3_MINUS_V1R[!VI_DAY50_PLOT10_E3_MINUS_V1R$SAMPLE_ID %in% Viability_Samples_Remove_DAY50$SAMPLE_ID, , drop=FALSE]
VI_DAY50_PLOT12_P1_PerCP_BAD_REMOVED <- VI_DAY50_PLOT12_P1_PerCP[!VI_DAY50_PLOT12_P1_PerCP$SAMPLE_ID %in% Viability_Samples_Remove_DAY50$SAMPLE_ID, , drop=FALSE]
```

# Arc sine Percentage data

```{r arcsine, echo=TRUE}
# Calculate Percent Live Granulocytes 
  # Take cells here and make a percentage out of GRANULAR hemocyte count from VI_PLOT3_P1_GATE P1_COUNT
  # These commands only work correctly if the csv has all the commas removed from the numbers for the thousands separator
VI_DAY50_PLOT9_E1_MINUS_V1R$COUNT_THIS_PLOT<- as.numeric(VI_DAY50_PLOT9_E1_MINUS_V1R$COUNT_THIS_PLOT)
VI_DAY50_PLOT3_P1_GATE$P1_COUNT <- as.numeric(VI_DAY50_PLOT3_P1_GATE$P1_COUNT)
VI_DAY50_PLOT4_E1_E3_GATE$COUNT <- as.numeric(VI_DAY50_PLOT4_E1_E3_GATE$COUNT) 
VI_DAY50_PLOT4_E1_E3_GATE_E1 <- VI_DAY50_PLOT4_E1_E3_GATE %>% filter(GATE=="E1")
VI_DAY50_PLOT9_E1_MINUS_V1R$PERCENT_LIVE <- (VI_DAY50_PLOT9_E1_MINUS_V1R$COUNT_THIS_PLOT / VI_DAY50_PLOT4_E1_E3_GATE_E1$COUNT)*100

VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT <- as.numeric(VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT)
VI_DAY50_PLOT3_P1_GATE_BAD_REMOVED$P1_COUNT <- as.numeric(VI_DAY50_PLOT3_P1_GATE_BAD_REMOVED$P1_COUNT)
VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$COUNT <- as.numeric(VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$COUNT)
VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED_E1 <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(GATE=="E1")
VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE <- (VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT / VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED_E1$COUNT)*100 

# Calculate Percent Live Agranulocytes 
VI_DAY50_PLOT10_E3_MINUS_V1R$COUNT_THIS_PLOT <- as.numeric(VI_DAY50_PLOT10_E3_MINUS_V1R$COUNT_THIS_PLOT)
VI_DAY50_PLOT4_E1_E3_GATE$COUNT <- as.numeric(VI_DAY50_PLOT4_E1_E3_GATE$COUNT)
VI_DAY50_PLOT4_E1_E3_GATE_E3 <- VI_DAY50_PLOT4_E1_E3_GATE %>% filter(GATE=="E3")

VI_DAY50_PLOT10_E3_MINUS_V1R$PERCENT_LIVE <- (VI_DAY50_PLOT10_E3_MINUS_V1R$COUNT_THIS_PLOT / VI_DAY50_PLOT4_E1_E3_GATE_E3$COUNT)*100

VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT <- as.numeric(VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT)
VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$COUNT <- as.numeric(VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$COUNT)
VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED_E3 <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(GATE=="E3")
VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE <- (VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$COUNT_THIS_PLOT / VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED_E3$COUNT)*100 

# Use transf.arcsine to arcsine transform the percentages
VI_DAY50_PLOT2_hemocytes$Arcsine <- transf.arcsin(VI_DAY50_PLOT2_hemocytes$M4_PERCENT_OF_THIS_PLOT*.01)
VI_DAY50_PLOT4_E1_E3_GATE$Arcsine <- transf.arcsin(VI_DAY50_PLOT4_E1_E3_GATE$PERCENT_OF_THIS_PLOT*0.01)
VI_DAY50_PLOT9_E1_MINUS_V1R$Arcsine <- transf.arcsin(VI_DAY50_PLOT9_E1_MINUS_V1R$PERCENT_LIVE*0.01)
VI_DAY50_PLOT10_E3_MINUS_V1R$Arcsine <- transf.arcsin(VI_DAY50_PLOT10_E3_MINUS_V1R$PERCENT_LIVE*0.01)
VI_DAY50_PLOT12_P1_PerCP$V1_L_Arcsine <- transf.arcsin(VI_DAY50_PLOT12_P1_PerCP$V1_L_PERCENT_OF_THIS_PLOT*0.01)
VI_DAY50_PLOT12_P1_PerCP$V1_R_Arcsine <- transf.arcsin(VI_DAY50_PLOT12_P1_PerCP$V1_R_PERCENT_OF_THIS_PLOT*0.01)

# Use transf.arcsine to arcsine transform the percentages for the "BAD REMOVED" samples
VI_DAY50_PLOT2_hemocytes_BAD_REMOVED$Arcsine <- transf.arcsin(VI_DAY50_PLOT2_hemocytes_BAD_REMOVED$M4_PERCENT_OF_THIS_PLOT*.01)
VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$Arcsine <- transf.arcsin(VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$PERCENT_OF_THIS_PLOT*0.01)
VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$Arcsine <- transf.arcsin(VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE*0.01)
VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$Arcsine <- transf.arcsin(VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$PERCENT_LIVE*0.01)
VI_DAY50_PLOT12_P1_PerCP_BAD_REMOVED$V1_L_Arcsine <- transf.arcsin(VI_DAY50_PLOT12_P1_PerCP_BAD_REMOVED$V1_L_PERCENT_OF_THIS_PLOT*0.01)
VI_DAY50_PLOT12_P1_PerCP_BAD_REMOVED$V1_R_Arcsine <- transf.arcsin(VI_DAY50_PLOT12_P1_PerCP_BAD_REMOVED$V1_R_PERCENT_OF_THIS_PLOT*0.01)
```

## Plotting of Total Granular and Agranular Hemocytes 

```{r day50_plotting, echo=TRUE}
ggplot(VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED, aes(x=GROUP, y=PERCENT_OF_THIS_PLOT, fill=GATE)) + geom_boxplot() + ggtitle("Percent Total Granular and Agranular Hemocytes (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + scale_fill_manual(name="Hemocyte Type", labels=c("Granular Hemocytes", "Agranular Hemocytes"), values=c("E1"="#99a765","E3"="#96578a")) + facet_grid(.~FAMILY+GROUP, scales="free") 

```


## Percent of granular hemocytes (E1)

### FAMILY A
```{r DAY50_granular_A, echo=TRUE}
VI_DAY50_PLOT4_FAMILY_A_E1 <- VI_DAY50_PLOT4_E1_E3_GATE %>% filter(FAMILY=="A") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_A_E1 <- aov(VI_DAY50_PLOT4_FAMILY_A_E1$Arcsine ~ VI_DAY50_PLOT4_FAMILY_A_E1$GROUP, data=VI_DAY50_PLOT4_FAMILY_A_E1)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_A_E1)
VI_DAY50_PLOT4_FAMILY_A_E1_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="A") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_A_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_A_E1_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_A_E1_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_A_E1_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_A_BAD_REMOVED)
```

### FAMILY B

```{r DAY50_granular_B, echo=TRUE}
VI_DAY50_PLOT4_FAMILY_B_E1 <- VI_DAY50_PLOT4_E1_E3_GATE %>% filter(FAMILY=="B") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_B_E1 <- aov(VI_DAY50_PLOT4_FAMILY_B_E1$Arcsine ~ VI_DAY50_PLOT4_FAMILY_B_E1$GROUP, data=VI_DAY50_PLOT4_FAMILY_B_E1)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_B_E1)
VI_DAY50_PLOT4_FAMILY_B_E1_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="B") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_B_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_B_E1_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_B_E1_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_B_E1_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_B_BAD_REMOVED)
```

### FAMILY D
```{r DAY50_granular_D, echo=TRUE}
VI_DAY50_PLOT4_FAMILY_D_E1 <- VI_DAY50_PLOT4_E1_E3_GATE %>% filter(FAMILY=="D") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_D_E1 <- aov(VI_DAY50_PLOT4_FAMILY_D_E1$Arcsine ~ VI_DAY50_PLOT4_FAMILY_D_E1$GROUP, data=VI_DAY50_PLOT4_FAMILY_D_E1)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_D_E1)
VI_DAY50_PLOT4_FAMILY_D_E1_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="D") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_D_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_D_E1_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_D_E1_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_D_E1_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_D_BAD_REMOVED)
```

### FAMILY E
```{r DAY50_granular_E, echo=TRUE}
VI_DAY50_PLOT4_FAMILY_E_E1 <- VI_DAY50_PLOT4_E1_E3_GATE %>% filter(FAMILY=="E") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_E_E1 <- aov(VI_DAY50_PLOT4_FAMILY_E_E1$Arcsine ~ VI_DAY50_PLOT4_FAMILY_E_E1$GROUP, data=VI_DAY50_PLOT4_FAMILY_E_E1)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_E_E1)
VI_DAY50_PLOT4_FAMILY_E_E1_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="E") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_E_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_E_E1_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_E_E1_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_E_E1_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_E_BAD_REMOVED)
```

### FAMILY J
```{r DAY50_granular_J, echo=TRUE}
VI_DAY50_PLOT4_FAMILY_J_E1 <- VI_DAY50_PLOT4_E1_E3_GATE %>% filter(FAMILY=="J") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_J_E1 <- aov(VI_DAY50_PLOT4_FAMILY_J_E1$Arcsine ~ VI_DAY50_PLOT4_FAMILY_J_E1$GROUP, data=VI_DAY50_PLOT4_FAMILY_J_E1)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_J_E1)
VI_DAY50_PLOT4_FAMILY_J_E1_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="J") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_J_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_J_E1_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_J_E1_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_J_E1_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_J_BAD_REMOVED)
```

### FAMILY L
```{r DAY50_granular_L, echo=TRUE}
VI_DAY50_PLOT4_FAMILY_L_E1 <- VI_DAY50_PLOT4_E1_E3_GATE %>% filter(FAMILY=="L") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_L_E1 <- aov(VI_DAY50_PLOT4_FAMILY_L_E1$Arcsine ~ VI_DAY50_PLOT4_FAMILY_L_E1$GROUP, data=VI_DAY50_PLOT4_FAMILY_L_E1)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_L_E1)
VI_DAY50_PLOT4_FAMILY_L_E1_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(FAMILY =="L") %>% filter(GATE=="E1")
VI_DAY50_PLOT4_E1_AOV_FAMILY_L_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_L_E1_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_L_E1_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_L_E1_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E1_AOV_FAMILY_L_BAD_REMOVED)
```

### Two Way ANOVA of Granular Hemocytes

```{r DAY50_granular_aov, echo=TRUE}
VI_DAY50_PLOT4_E1_E3_GATE_E1 <- VI_DAY50_PLOT4_E1_E3_GATE %>% filter(GATE=="E1")
VI_DAY50_PLOT4_Granular_hemocytes_AOV <- lm(VI_DAY50_PLOT4_E1_E3_GATE_E1$Arcsine ~ VI_DAY50_PLOT4_E1_E3_GATE_E1$GROUP + VI_DAY50_PLOT4_E1_E3_GATE_E1$FAMILY, data=VI_DAY50_PLOT4_E1_E3_GATE_E1)
Anova(VI_DAY50_PLOT4_Granular_hemocytes_AOV, type="II")
summary(VI_DAY50_PLOT4_Granular_hemocytes_AOV)

VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(GATE=="E1")
VI_DAY50_PLOT4_Granular_hemocytes_AOV_BAD_REMOVED <- lm(VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED$GROUP +VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED$FAMILY, data=VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED)
Anova(VI_DAY50_PLOT4_Granular_hemocytes_AOV_BAD_REMOVED, type="II")
summary(VI_DAY50_PLOT4_Granular_hemocytes_AOV_BAD_REMOVED)
#NO significance, no interaction term added
```

### One Way ANOVA of Differences between Families

```{r DAY50_oneway_granular, include=TRUE}
VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED_CHALLENGE <- VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED[!grepl("control", VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED$GROUP),]
VI_DAY50_PLOT4_Granular_hemocytes_oneway_lm <- aov(VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED_CHALLENGE$Arcsine ~ VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_DAY50_PLOT4_E1_E3_GATE_E1_BAD_REMOVED_CHALLENGE)
summary(VI_DAY50_PLOT4_Granular_hemocytes_oneway_lm)
```

# Percent of Agranular hemocytes (E3) #

## Percent Agranular Hemocytes out of all hemocytes

### FAMILY A
```{r DAY50_agranular_A, echo=TRUE}
VI_DAY50_PLOT4_E1_E3_GATE_E3 <- VI_DAY50_PLOT4_E1_E3_GATE %>% filter(GATE=="E3")
VI_DAY50_PLOT4_FAMILY_A_E3 <- VI_DAY50_PLOT4_E1_E3_GATE_E3 %>% filter(FAMILY=="A")
VI_DAY50_PLOT4_E3_AOV_FAMILY_A <- aov(VI_DAY50_PLOT4_FAMILY_A_E3$Arcsine ~ VI_DAY50_PLOT4_FAMILY_A_E3$GROUP, data=VI_DAY50_PLOT4_FAMILY_A_E3)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_A)

VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(GATE=="E3")
VI_DAY50_PLOT4_FAMILY_A_E3_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED %>% filter(FAMILY =="A") 
VI_DAY50_PLOT4_E3_AOV_FAMILY_A_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_A_E3_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_A_E3_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_A_E3_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_A_BAD_REMOVED)
```

### FAMILY B
```{r DAY50_agranular_B, echo=FALSE}
VI_DAY50_PLOT4_FAMILY_B_E3 <- VI_DAY50_PLOT4_E1_E3_GATE_E3 %>% filter(FAMILY=="B")
VI_DAY50_PLOT4_E3_AOV_FAMILY_B <- aov(VI_DAY50_PLOT4_FAMILY_B_E3$Arcsine ~ VI_DAY50_PLOT4_FAMILY_B_E3$GROUP, data=VI_DAY50_PLOT4_FAMILY_B_E3)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_B)

VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED %>% filter(GATE=="E3")
VI_DAY50_PLOT4_FAMILY_B_E3_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED %>% filter(FAMILY =="B") 
VI_DAY50_PLOT4_E3_AOV_FAMILY_B_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_B_E3_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_B_E3_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_B_E3_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_B_BAD_REMOVED)
```

### FAMILY D
```{r DAY50_agranular D, echo=FALSE}
VI_DAY50_PLOT4_FAMILY_D_E3 <- VI_DAY50_PLOT4_E1_E3_GATE_E3 %>% filter(FAMILY=="D")
VI_DAY50_PLOT4_E3_AOV_FAMILY_D <- aov(VI_DAY50_PLOT4_FAMILY_D_E3$Arcsine ~ VI_DAY50_PLOT4_FAMILY_D_E3$GROUP, data=VI_DAY50_PLOT4_FAMILY_D_E3)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_D)

VI_DAY50_PLOT4_FAMILY_D_E3_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED %>% filter(FAMILY =="D") 
VI_DAY50_PLOT4_E3_AOV_FAMILY_D_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_D_E3_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_D_E3_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_D_E3_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_D_BAD_REMOVED)
```

### FAMILY E
```{r DAY50_agranular_E, echo=FALSE}
VI_DAY50_PLOT4_FAMILY_E_E3 <- VI_DAY50_PLOT4_E1_E3_GATE_E3 %>% filter(FAMILY=="E")
VI_DAY50_PLOT4_E3_AOV_FAMILY_E <- aov(VI_DAY50_PLOT4_FAMILY_E_E3$Arcsine ~ VI_DAY50_PLOT4_FAMILY_E_E3$GROUP, data=VI_DAY50_PLOT4_FAMILY_E_E3)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_E)

VI_DAY50_PLOT4_FAMILY_E_E3_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED %>% filter(FAMILY =="E") 
VI_DAY50_PLOT4_E3_AOV_FAMILY_E_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_E_E3_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_E_E3_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_E_E3_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_E_BAD_REMOVED)
```

### FAMILY J
```{r DAY50_agranular_J, echo=FALSE}
VI_DAY50_PLOT4_FAMILY_J_E3 <- VI_DAY50_PLOT4_E1_E3_GATE_E3 %>% filter(FAMILY=="J")
VI_DAY50_PLOT4_E3_AOV_FAMILY_J <- aov(VI_DAY50_PLOT4_FAMILY_J_E3$Arcsine ~ VI_DAY50_PLOT4_FAMILY_J_E3$GROUP, data=VI_DAY50_PLOT4_FAMILY_J_E3)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_J)

VI_DAY50_PLOT4_FAMILY_J_E3_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED %>% filter(FAMILY =="J") 
VI_DAY50_PLOT4_E3_AOV_FAMILY_J_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_J_E3_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_J_E3_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_J_E3_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_J_BAD_REMOVED)
```

### FAMILY L 
```{r DAY50_agrnaular_L, echo=FALSE}
VI_DAY50_PLOT4_FAMILY_L_E3 <- VI_DAY50_PLOT4_E1_E3_GATE_E3 %>% filter(FAMILY=="L")
VI_DAY50_PLOT4_E3_AOV_FAMILY_L <- aov(VI_DAY50_PLOT4_FAMILY_L_E3$Arcsine ~ VI_DAY50_PLOT4_FAMILY_L_E3$GROUP, data=VI_DAY50_PLOT4_FAMILY_L_E3)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_L)

VI_DAY50_PLOT4_FAMILY_L_E3_BAD_REMOVED <- VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED %>% filter(FAMILY =="L") 
VI_DAY50_PLOT4_E3_AOV_FAMILY_L_BAD_REMOVED <- aov(VI_DAY50_PLOT4_FAMILY_L_E3_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_FAMILY_L_E3_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT4_FAMILY_L_E3_BAD_REMOVED)
summary(VI_DAY50_PLOT4_E3_AOV_FAMILY_L_BAD_REMOVED)
```

### Two Way ANOVA of Agranular Hemocytes
```{r DAY50_agrnaular_AOV, echo=FALSE}

VI_DAY50_PLOT4_Agranular_hemocytes_AOV_E3 <- lm(VI_DAY50_PLOT4_E1_E3_GATE_E3$Arcsine ~ VI_DAY50_PLOT4_E1_E3_GATE_E3$GROUP + VI_DAY50_PLOT4_E1_E3_GATE_E3$FAMILY, data=VI_DAY50_PLOT4_E1_E3_GATE_E3)
Anova(VI_DAY50_PLOT4_Agranular_hemocytes_AOV_E3, type="II")
summary(VI_DAY50_PLOT4_Agranular_hemocytes_AOV_E3)

VI_DAY50_PLOT4_Agranular_hemocytes_AOV_BAD_REMOVED <- lm(VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED$GROUP + VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED$FAMILY, data=VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED)
Anova(VI_DAY50_PLOT4_Agranular_hemocytes_AOV_BAD_REMOVED, type="II")
summary(VI_DAY50_PLOT4_Agranular_hemocytes_AOV_BAD_REMOVED)
#NO significance, no interaction term added
```

### One Way ANOVA of Differences between Families

```{r DAY50_oneway_Agranular, echo=TRUE}

VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED_CHALLENGE <- VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED[!grepl("control", VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED$GROUP),]

VI_DAY50_PLOT4_Agranular_hemocytes_oneway_lm <- aov(VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED_CHALLENGE$Arcsine ~ VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_DAY50_PLOT4_E1_E3_GATE_E3_BAD_REMOVED_CHALLENGE)
summary(VI_DAY50_PLOT4_Agranular_hemocytes_oneway_lm)
```

## Two Way ANOVA of Granular vs. Agranular
```{r DAY50_granular_agranular_percentage, echo=TRUE}
VI_DAY50_PLOT4_agranular_granular_lm <- lm(VI_DAY50_PLOT4_E1_E3_GATE$Arcsine ~ VI_DAY50_PLOT4_E1_E3_GATE$GATE + VI_DAY50_PLOT4_E1_E3_GATE$FAMILY, data=VI_DAY50_PLOT4_E1_E3_GATE)
Anova(VI_DAY50_PLOT4_agranular_granular_lm, type="II")
summary(VI_DAY50_PLOT4_agranular_granular_lm)

VI_DAY50_PLOT4_agranular_granular_BAD_REMOVED_lm <- lm(VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$GATE + VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY, data=VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED)
Anova(VI_DAY50_PLOT4_agranular_granular_BAD_REMOVED_lm, type="II")
summary(VI_DAY50_PLOT4_agranular_granular_BAD_REMOVED_lm) # significance for GATE

VI_DAY50_PLOT4_agranular_granular_lm_interaction_leastsquares <- lsmeans(VI_DAY50_PLOT4_agranular_granular_BAD_REMOVED_lm, "VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$GATE", adjust="tukey")
cld(VI_DAY50_PLOT4_agranular_granular_lm_interaction_leastsquares, alpha=0.05, Letters=letters)

VI_DAY50_PLOT4_agranular_granular_BAD_REMOVED_lm_interaction <- lm(VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$GATE + VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY + VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$FAMILY:VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED$GATE, data=VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED)
Anova(VI_DAY50_PLOT4_agranular_granular_BAD_REMOVED_lm_interaction, type="II")
summary(VI_DAY50_PLOT4_agranular_granular_BAD_REMOVED_lm_interaction)

```

## Plotting of Live Granular and Agranular Hemocytes 

```{r day50_plotting_live, echo=TRUE}
VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GATE <- "agranular"
VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GATE<- "granular"

VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED <- rbind(VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED,VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED)

ggplot(VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED, aes(x=GROUP, y=PERCENT_LIVE, fill=GATE)) + geom_boxplot() + ggtitle("Percent Live Granular and Agranular Hemocytes (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot")+ scale_fill_manual(name="Hemocyte Type", labels=c("Agranular Hemocytes", "Granular Hemocytes"), values=c("agranular"="#99a765","granular"="#96578a")) + facet_grid(.~FAMILY+GROUP, scales="free") 

```

### Percent Live Granular Hemocytes

### FAMILY A
```{r DAY50_live_granular_A, echo=FALSE}
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A <- VI_DAY50_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="A")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV)

VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED <- VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="A")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A_BAD_REMOVED)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED)
```

### FAMILY B
```{r DAY50_live_granular_B, echo=FALSE}
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B <- VI_DAY50_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="B")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV)

VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED <- VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="B")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B_BAD_REMOVED)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED)
```

### FAMILY D
```{r DAY50_live_granular_D, echo=FALSE}
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D <- VI_DAY50_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="D")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV)

VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED <- VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="D")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D_BAD_REMOVED)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED)
```

### FAMILY E
```{r DAY50_live_granular_E, echo=FALSE}
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E <- VI_DAY50_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="E")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV)

VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED <- VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="E")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E_BAD_REMOVED)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED)
```

### FAMILY J
```{r DAY50_live_granular_J, echo=FALSE}
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J <- VI_DAY50_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="J")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV)

VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED <- VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="J")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J_BAD_REMOVED)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED)
```

### FAMILY L
```{r DAY50_live_granular_L, echo=FALSE}
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L <- VI_DAY50_PLOT9_E1_MINUS_V1R %>% filter(FAMILY=="L")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV)

VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED <- VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="L")
VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L_BAD_REMOVED)
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED)
```

### Two Way ANOVA of LIVE Granular Hemocytes
```{r DAY50_live_grnaular_AOV, echo=FALSE}

VI_DAY50_PLOT9_Granular_hemocytes_AOV <- lm(VI_DAY50_PLOT9_E1_MINUS_V1R$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R$GROUP + VI_DAY50_PLOT9_E1_MINUS_V1R$FAMILY, data=VI_DAY50_PLOT9_E1_MINUS_V1R)
Anova(VI_DAY50_PLOT9_Granular_hemocytes_AOV, type="II")
summary(VI_DAY50_PLOT9_Granular_hemocytes_AOV)

VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED <- lm(VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP + VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY, data=VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED)
Anova(VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED, type="II")
summary(VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED) # significant difference between FAMILY

VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED_leastsquares <- lsmeans(VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED, "VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY", adjust="tukey")
cld(VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED_leastsquares, alpha=005, Letters=letters)

# Adding the Interaction Term

VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED_interaction <- lm(VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP + VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY + VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY:VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED)
Anova(VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED_interaction, type="II")
summary(VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED) # significant difference between FAMILY

VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED_interaction_leastsquares <- lsmeans(VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED_interaction, "VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$FAMILY", adjust="tukey")
cld(VI_DAY50_PLOT9_Granular_hemocytes_AOV_BAD_REMOVED_interaction_leastsquares, alpha=005, Letters=letters)
```

### One Way ANOVA of Differences between Families

```{r DAY50_oneway_live_granular_diff, echo=TRUE}

VI_DAY50_PLOT9_V1R_BAD_REMOVED_CHALLENGE <- VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED[!grepl("control", VI_DAY50_PLOT9_E1_MINUS_V1R_BAD_REMOVED$GROUP),]

VI_DAY50_PLOT9_Granular_hemocytes_oneway_lm <- aov(VI_DAY50_PLOT9_V1R_BAD_REMOVED_CHALLENGE$Arcsine ~ VI_DAY50_PLOT9_V1R_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_DAY50_PLOT9_V1R_BAD_REMOVED_CHALLENGE)
summary(VI_DAY50_PLOT9_Granular_hemocytes_oneway_lm)
```

### Live Agranular Hemocytes

### FAMILY A
```{r DAY50_live_agranular_A, echo=FALSE}
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A <- VI_DAY50_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="A")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV)

VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED <- VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="A")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A_BAD_REMOVED)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_A_AOV_BAD_REMOVED)
```

### FAMILY B
```{r DAY50_live_agranular_B, echo=FALSE}
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B <- VI_DAY50_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="B")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B_AOV <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B_AOV)

VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED <- VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="B")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B_BAD_REMOVED)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_B_AOV_BAD_REMOVED)
```

### FAMILY D
```{r DAY50_live_agranular_D, echo=FALSE}
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D <- VI_DAY50_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="D")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D_AOV <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D_AOV)

VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED <- VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="D")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D_BAD_REMOVED)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_D_AOV_BAD_REMOVED)
```

### FAMILY E
```{r DAY50_live_agranular_E, echo=FALSE}
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E <- VI_DAY50_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="E")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E_AOV <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E_AOV)

VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED <- VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="E")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E_BAD_REMOVED)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_E_AOV_BAD_REMOVED)
```

### FAMILY J
```{r DAY50_live_agranular_J, echo=FALSE}
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J <- VI_DAY50_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="J")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J_AOV <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J_AOV)

VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED <- VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="J")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J_BAD_REMOVED)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_J_AOV_BAD_REMOVED)
```

### FAMILY L
```{r DAY50_live_agranular_L, echo=FALSE}
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L <- VI_DAY50_PLOT10_E3_MINUS_V1R %>% filter(FAMILY=="L")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L_AOV <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L_AOV)

VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED <- VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED %>% filter(FAMILY=="L")
VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED <- aov(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED$GROUP, data= VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L_BAD_REMOVED)
summary(VI_DAY50_PLOT10_E3_MINUS_V1R_FAMILY_L_AOV_BAD_REMOVED)
```

### Two Way ANOVA of LIVE Agranular Hemocytes
```{r DAY50_live_agranular_AOV, echo=FALSE}

VI_DAY50_PLOT10_Agranular_hemocytes_AOV <- lm(VI_DAY50_PLOT10_E3_MINUS_V1R$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R$GROUP + VI_DAY50_PLOT9_E1_MINUS_V1R$FAMILY, data=VI_DAY50_PLOT9_E1_MINUS_V1R)
Anova(VI_DAY50_PLOT10_Agranular_hemocytes_AOV, type="II")
summary(VI_DAY50_PLOT10_Agranular_hemocytes_AOV)

VI_DAY50_PLOT10_Agranular_hemocytes_AOV_BAD_REMOVED <- lm(VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP + VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$FAMILY, data=VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED)
Anova(VI_DAY50_PLOT10_Agranular_hemocytes_AOV_BAD_REMOVED, type="II")
summary(VI_DAY50_PLOT10_Agranular_hemocytes_AOV_BAD_REMOVED) 

# Adding the Interaction Term
VI_DAY50_PLOT10_Agranular_hemocytes_AOV_BAD_REMOVED_interaction <- lm(VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP + VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$FAMILY + VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$FAMILY:VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP, data=VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED)
Anova(VI_DAY50_PLOT10_Agranular_hemocytes_AOV_BAD_REMOVED_interaction, type="II")
summary(VI_DAY50_PLOT10_Agranular_hemocytes_AOV_BAD_REMOVED_interaction) # No significant differences

```

## One Way ANOVA of Challenged Families
```{r DAY50_oneway_live_granular, echo=TRUE}

VI_DAY50_PLOT10_V1R_BAD_REMOVED_CHALLENGE <- VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED[!grepl("control", VI_DAY50_PLOT10_E3_MINUS_V1R_BAD_REMOVED$GROUP),]

VI_DAY50_PLOT10_V1R_BAD_REMOVED_CHALLENGE_oneway_lm <- aov(VI_DAY50_PLOT10_V1R_BAD_REMOVED_CHALLENGE$Arcsine ~ VI_DAY50_PLOT10_V1R_BAD_REMOVED_CHALLENGE$FAMILY, data=VI_DAY50_PLOT10_V1R_BAD_REMOVED_CHALLENGE)
summary(VI_DAY50_PLOT10_V1R_BAD_REMOVED_CHALLENGE_oneway_lm)
```

### Two Way ANOVA of GATE and FAMILY for Live Hemocytes

```{r twoway_gate_family, echo=TRUE}
VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV <- lm(VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED$FAMILY + VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED$GATE, data=VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED)
Anova(VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV, type="II")
summary(VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV)

# Adding an Interaction term
VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV_interaction <- lm(VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED$Arcsine ~ VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED$FAMILY + VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED$GATE + VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED$FAMILY:VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED$GATE, data=VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED )
Anova(VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV_interaction , type="II")

VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV_interaction_leastsquares <- lsmeans(VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV_interaction, "VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED$FAMILY", adjust="tukey")
cld(VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV_interaction_leastsquares, alpha=0.05, Letters=letters)

VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV_interaction_leastsquares_gate <- lsmeans(VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV_interaction, "VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED$GATE", adjust="tukey")
cld(VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED_AOV_interaction_leastsquares_gate, alpha=0.05, Letters=letters)

```

## Summary Statistics Day 50 

```{r summary_stats_2, echo=TRUE}

# Summary Statistics for Percentages 
total_viabaility_statistics_day50 <- summarySE(data=VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED, "PERCENT_OF_THIS_PLOT", groupvars=c("GROUP", "GATE","FAMILY"))

viability_statistics_live_day50 <- summarySE(data=VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED, "PERCENT_LIVE", groupvars=c("GROUP", "GATE","FAMILY"), conf.interval= 0.95)

# Summary Statistics for size #need to get this document from Hannah
mean_size <- read.csv(file="../ANALYSIS_CSVs/VIABILITY_ASSAY/DAY7/VIABILITY_ASSAY_MEAN_VALUES_CORRECTED_EDITED.csv", header=TRUE)
class(mean_size$MEAN)
mean_size_BAD_REMOVED <- mean_size[!mean_size$SAMPLE_ID %in% Viability_Samples_Remove$SAMPLE_ID, , drop=FALSE]
mean_size_statistics <- summarySE(data=mean_size_BAD_REMOVED, "MEAN", groupvars=c("GROUP","GATE","PLOT","FAMILY"), conf.interval = 0.95)

```


### Compiled Graphing ###

```{r viability_assay_compiled_graphing}
#Plotting all granular agranular 
subset_day50_agranular_granular <- VI_DAY50_PLOT4_E1_E3_GATE_BAD_REMOVED[,c(1,2,5,7,10,11,12)]
subset_day50_agranular_granular$DAY <- "50"
subset_day7_agranular_granular <- VI_PLOT4_restructured_BAD_REMOVED[,c(1,2,6,5,11,10,12)]
subset_day7_agranular_granular$DAY <- "7"

colnames(subset_day7_agranular_granular) <- c("SAMPLE_ID","FAMILY","GROUP","PLOT","GATE","PERCENT_OF_THIS_PLOT","Arcsine","DAY")
compiled_day7_day_50_all_agranular_granular <- rbind(subset_day7_agranular_granular, subset_day50_agranular_granular )

ggplot(compiled_day7_day_50_all_agranular_granular, aes(x=GROUP,y=PERCENT_OF_THIS_PLOT, fill=GATE)) + geom_boxplot() + ggtitle("Percent of Granular and Agranular Hemocytes \n on Day 7 and Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + facet_grid(DAY~FAMILY, scales="free") + scale_fill_manual(name="Hemocyte Type", labels=c("Granular Hemocytes", "Agranular Hemocytes"), values=c("E1"="#99a765","E3"="#96578a")) 

# Plotting all live agranular and granular
subset_day7_live_agranular_granular <- VI_PLOT9_PLOT10_BAD_REMOVED_combined[,c(1,2,5,6,9,10)]
subset_day7_live_agranular_granular$DAY <- "7"
subset_day50_live_agranular_granular <- VI_DAY50_PLOT9_E1_MINUS_V1R_PLOT10_combined_BAD_REMOVED[,c(1,2,7,5,10,11)]
subset_day50_live_agranular_granular$DAY <- "50"

compiled_day7_day50_live_agranular_granular <- rbind(subset_day7_live_agranular_granular, subset_day50_live_agranular_granular)

ggplot(compiled_day7_day50_live_agranular_granular, aes(x=GROUP, y=PERCENT_LIVE, fill=PLOT)) + 
  geom_boxplot() + ggtitle("Percent of Live Granular and Agranular Hemocytes \n on Day 7 and Day 50 (low quality removed)") + ylab("Percent of Hemocyte Events in each quad plot") + 
  facet_grid(DAY~FAMILY, scales="free")  + scale_fill_manual(name="Hemocyte Type", labels=c("Granular Hemocytes", "Agranular Hemocytes"), values=c("PLOT9_FL3-A"="#99a765","PLOT10_FL3-A"="#96578a"))

```

### Two Way ANOVA of GATE and DAY
```{r day_Gate, echo=TRUE}
compiled_agranular_granular_lm <- lm(compiled_day7_day_50_all_agranular_granular$Arcsine ~ compiled_day7_day_50_all_agranular_granular$GATE + compiled_day7_day_50_all_agranular_granular$DAY + compiled_day7_day_50_all_agranular_granular$GATE:compiled_day7_day_50_all_agranular_granular$DAY, data=compiled_day7_day_50_all_agranular_granular)
Anova(compiled_agranular_granular_lm, type="II")

compiled_day7_day50_live_agranular_granular_lm <- lm(compiled_day7_day50_live_agranular_granular$Arcsine ~ compiled_day7_day50_live_agranular_granular$PLOT + compiled_day7_day50_live_agranular_granular$DAY + compiled_day7_day50_live_agranular_granular$PLOT:compiled_day7_day50_live_agranular_granular$DAY, data=compiled_day7_day50_live_agranular_granular)
Anova(compiled_day7_day50_live_agranular_granular_lm, type="II")
```
